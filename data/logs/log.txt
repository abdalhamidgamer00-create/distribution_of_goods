2025-11-17 09:04:03,158 | INFO     | test | Data logs folder test
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:04:56,875 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:04:56,875 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:04:56,876 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:04:56,876 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:58,221 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:04:58,222 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:58,222 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:04:58,222 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:04:58,222 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_090459/output
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_090459
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_090459.zip...
2025-11-17 09:04:59,567 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_090459.zip
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_090459
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_090459.zip
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:04:59,570 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:04:59,570 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:04:59,576 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:04:59,576 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,576 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:04:59,576 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:04:59,577 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:04:59,577 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,075 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,075 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:05:00,075 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:05:00,075 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,075 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,121 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:05:00,122 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:05:00,122 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:05:00,131 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:05:00
File: selled_stock_drug_only_20251117_090459.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:05:00,131 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:05:00,131 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,131 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,132 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,132 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_090500.csv
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:05:00,178 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:05:00,178 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_090500.csv
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_090500.csv by branches...
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_090500_asherin.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_090500_wardani.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_090500_akba.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_090500_shahid.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_090500_nujum.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_090500_admin.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:05:02,935 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:05:02,935 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_090500_from_asherin_to_wardani.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_090500_from_asherin_to_akba.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_090500_from_asherin_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_090500_from_asherin_to_nujum.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_090500_from_wardani_to_asherin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_090500_from_wardani_to_akba.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_090500_from_wardani_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_090500_from_wardani_to_nujum.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_090500_from_wardani_to_admin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_090500_from_akba_to_asherin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_090500_from_akba_to_wardani.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_090500_from_akba_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_090500_from_akba_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_090500_from_akba_to_admin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_090500_from_shahid_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_090500_from_shahid_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_090500_from_shahid_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_090500_from_shahid_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_090500_from_nujum_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_090500_from_nujum_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_090500_from_nujum_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_090500_from_nujum_to_shahid.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_090500_from_nujum_to_admin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_090500_from_admin_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_090500_from_admin_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_090500_from_admin_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_090500_from_admin_to_shahid.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_090500_from_admin_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:05:07,220 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:05:07,220 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:05:07,374 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:05:07,374 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:07,374 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:05:07,374 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:05:07,375 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:14:01,921 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:14:01,921 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:14:01,922 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:01,922 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:14:01,924 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:14:01,924 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:03,403 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:14:04,825 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:14:04,825 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:14:06,031 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:14:06,032 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_091406/output
2025-11-17 09:14:06,801 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_091406
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_091406.zip...
2025-11-17 09:14:07,068 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_091406.zip
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_091406
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_091406.zip
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:14:07,070 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:14:07,071 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:14:07,076 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:14:07,076 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,076 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:14:07,076 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,077 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:14:07,077 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,548 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,548 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:14:07,548 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:14:07,548 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,592 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:14:07,592 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:14:07,592 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,592 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,592 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,593 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:14:07,601 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:14:07
File: selled_stock_drug_only_20251117_091407.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:14:07,601 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:14:07,601 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:14:07,645 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:14:07,646 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_091407.csv
2025-11-17 09:14:07,646 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:14:07,646 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:14:07,646 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_091407.csv
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_091407.csv by branches...
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_091407_asherin.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_091407_wardani.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_091407_akba.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_091407_shahid.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_091407_nujum.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_091407_admin.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:14:10,362 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:14:10,362 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_091407_from_asherin_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_091407_from_asherin_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_091407_from_asherin_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_091407_from_asherin_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_091407_from_wardani_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_091407_from_wardani_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_091407_from_wardani_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_091407_from_wardani_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_091407_from_wardani_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_091407_from_akba_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_091407_from_akba_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_091407_from_akba_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_091407_from_akba_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_091407_from_akba_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_091407_from_shahid_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_091407_from_shahid_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_091407_from_shahid_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_091407_from_shahid_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_091407_from_nujum_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_091407_from_nujum_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_091407_from_nujum_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_091407_from_nujum_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_091407_from_nujum_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_091407_from_admin_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_091407_from_admin_to_wardani.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_091407_from_admin_to_akba.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_091407_from_admin_to_shahid.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_091407_from_admin_to_nujum.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:14:10,780 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:14:10,780 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:14:10,922 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:14:10,922 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:14:11,685 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:15:20,090 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:15:20,091 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:15:20,091 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:20,092 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:15:20,095 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:15:20,095 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:21,070 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:15:22,699 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:15:22,703 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:15:22,703 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:15:23,836 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:15:23,836 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:15:24,333 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:15:24,333 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:15:24,334 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_091524/output
2025-11-17 09:15:24,338 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_091524
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_091524.zip...
2025-11-17 09:15:24,584 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_091524.zip
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_091524
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_091524.zip
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:15:24,586 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:15:24,587 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:15:24,592 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:15:24,592 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,592 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:15:24,592 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:24,592 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:15:24,592 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,051 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,051 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:15:25,051 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:15:25,051 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,096 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:15:25,096 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:15:25,096 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:15:25,105 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:15:25
File: selled_stock_drug_only_20251117_091524.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:15:25,105 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:15:25,106 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_091525.csv
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:15:25,149 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:15:25,149 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_091525.csv
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_091525.csv by branches...
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_091525_asherin.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_091525_wardani.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_091525_akba.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_091525_shahid.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_091525_nujum.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_091525_admin.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:15:27,824 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:15:27,824 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_091525_from_asherin_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_091525_from_asherin_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_091525_from_asherin_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_091525_from_asherin_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_091525_from_wardani_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_091525_from_wardani_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_091525_from_wardani_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_091525_from_wardani_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_091525_from_wardani_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_091525_from_akba_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_091525_from_akba_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_091525_from_akba_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_091525_from_akba_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_091525_from_akba_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_091525_from_shahid_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_091525_from_shahid_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_091525_from_shahid_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_091525_from_shahid_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_091525_from_nujum_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_091525_from_nujum_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_091525_from_nujum_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_091525_from_nujum_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_091525_from_nujum_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_091525_from_admin_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_091525_from_admin_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_091525_from_admin_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_091525_from_admin_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_091525_from_admin_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:15:28,240 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:15:28,240 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:15:28,385 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:15:28,385 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:15:29,117 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:15:29,117 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:22:05,436 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:22:05,436 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:22:05,436 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:06,091 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:11,050 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:22:11,050 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:11,051 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:22:11,051 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:22:11,051 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_092212/output
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_092212
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_092212.zip...
2025-11-17 09:22:12,439 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_092212.zip
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_092212
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_092212.zip
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:22:12,441 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:22:12,442 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:22:12,448 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:22:12,448 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,448 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:22:12,448 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,448 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:22:12,448 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,933 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,933 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:22:12,934 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:22:12,934 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,988 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:22:12,988 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:22:12,988 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:22:13,000 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:22:13
File: selled_stock_drug_only_20251117_092212.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:22:13,001 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:22:13,001 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_092213.csv
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:22:13,051 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:22:13,052 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_092213.csv
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_092213.csv by branches...
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_092213_asherin.csv
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_092213_wardani.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_092213_akba.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_092213_shahid.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_092213_nujum.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_092213_admin.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.10 surplus=0.73 writes=0.38 total=1.90
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 09:22:14,949 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:22:14,949 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_092213_from_asherin_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_092213_from_asherin_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_092213_from_asherin_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_092213_from_asherin_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_092213_from_wardani_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_092213_from_wardani_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_092213_from_wardani_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_092213_from_wardani_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_092213_from_wardani_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_092213_from_akba_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_092213_from_akba_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_092213_from_akba_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_092213_from_akba_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_092213_from_akba_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_092213_from_shahid_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_092213_from_shahid_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_092213_from_shahid_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_092213_from_shahid_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_092213_from_nujum_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_092213_from_nujum_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_092213_from_nujum_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_092213_from_nujum_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_092213_from_nujum_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_092213_from_admin_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_092213_from_admin_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_092213_from_admin_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_092213_from_admin_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_092213_from_admin_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:22:15,345 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:22:15,345 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:22:15,495 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:22:15,495 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | 
==================================================
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 10:42:59,111 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   0. Exit
2025-11-17 10:42:59,111 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 10:43:01,905 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 10:43:01,906 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 10:43:05,063 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 10:43:05,064 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 10:43:05,064 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_104305/output
2025-11-17 10:43:05,072 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_104305
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_104305.zip...
2025-11-17 10:43:05,338 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_104305.zip
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_104305
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_104305.zip
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 10:43:05,340 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 10:43:05,341 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 10:43:05,347 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 10:43:05,347 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,347 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 10:43:05,347 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,347 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 10:43:05,348 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,824 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,824 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 10:43:05,824 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 10:43:05,824 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,867 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 10:43:05,867 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 10:43:05,867 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,867 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,868 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,868 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 10:43:05,880 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 10:43:05
File: selled_stock_drug_only_20251117_104305.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 10:43:05,880 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 10:43:05,880 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,880 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,881 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,881 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_104305.csv
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 10:43:05,939 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 10:43:05,939 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_104305.csv
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_104305.csv by branches...
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 10:43:05,985 | INFO     | src.splitters.processors.data_preparer | Prepared branch data | rows=4603 cols=25 branches=6 read_time_ms=7.2
2025-11-17 10:43:07,794 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 10:43:07,794 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_104305_asherin.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_104305_wardani.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_104305_akba.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_104305_shahid.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_104305_nujum.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_104305_admin.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.10 surplus=0.72 writes=0.38 total=1.86
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Surplus metrics: products_with_need=4995 withdrawals=4742 checks=4742 max_withdrawals_per_product=5
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Branch files written: 6 files totaling 4.06 MB
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Analytics files written: 6 files totaling 3.19 MB
2025-11-17 10:43:07,795 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 10:43:07,795 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 10:43:08,187 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_104305_from_asherin_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_104305_from_asherin_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_104305_from_asherin_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_104305_from_asherin_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_104305_from_wardani_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_104305_from_wardani_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_104305_from_wardani_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_104305_from_wardani_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_104305_from_wardani_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_104305_from_akba_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_104305_from_akba_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_104305_from_akba_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_104305_from_akba_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_104305_from_akba_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_104305_from_shahid_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_104305_from_shahid_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_104305_from_shahid_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_104305_from_shahid_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_104305_from_nujum_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_104305_from_nujum_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_104305_from_nujum_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_104305_from_nujum_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_104305_from_nujum_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_104305_from_admin_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_104305_from_admin_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_104305_from_admin_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_104305_from_admin_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_104305_from_admin_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 10:43:08,188 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 10:43:08,188 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 10:43:08,348 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 10:43:08,348 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:08,348 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 10:43:08,348 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 10:43:08,349 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 11:19:06,449 | INFO     | src.cli.menu | 
==================================================
2025-11-17 11:19:06,449 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:19:06,450 | INFO     | src.cli.menu | ==================================================
2025-11-17 11:19:06,450 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:19:06,452 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |   0. Exit
2025-11-17 11:19:06,452 | INFO     | src.cli.menu | ==================================================
2025-11-17 11:19:07,971 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 11:19:09,798 | INFO     | src.app.cli.menu | 
==================================================
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   0. Exit
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:11,543 | INFO     | src.app.cli.menu | Executing all steps...
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu | Select file option for all steps:
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | Using latest file for all steps...
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | [1] Archive Previous Output
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251117_111912/output
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251117_111912
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_111912.zip...
2025-11-17 11:19:12,718 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_111912.zip
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251117_111912
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251117_111912.zip
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-17 11:19:12,720 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-17 11:19:12,721 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 11:19:12,727 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 11:19:12,727 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,727 | INFO     | src.app.cli.menu | [2] Convert Excel to CSV
2025-11-17 11:19:12,727 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,183 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,183 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-17 11:19:13,184 | INFO     | src.app.cli.menu | [3] Validate Data
2025-11-17 11:19:13,184 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,228 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-17 11:19:13,228 | INFO     | src.app.cli.menu | [4] Sales Analysis
2025-11-17 11:19:13,228 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,228 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,229 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,229 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 11:19:13
File: selled_stock_drug_only_20251117_111912.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 11:19:13,238 | INFO     | src.app.cli.menu | [5] Rename Columns
2025-11-17 11:19:13,238 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-17 11:19:13,281 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-17 11:19:13,281 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_111913.csv
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-17 11:19:13,282 | INFO     | src.app.cli.menu | [6] Split by Branches
2025-11-17 11:19:13,282 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_111913.csv
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_111913.csv by branches...
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251117_111913_asherin.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251117_111913_wardani.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251117_111913_akba.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251117_111913_shahid.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251117_111913_nujum.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251117_111913_admin.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.09 surplus=0.73 writes=0.38 total=1.89
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 11:19:15,168 | INFO     | src.app.cli.menu | [7] Generate Transfer Files
2025-11-17 11:19:15,168 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_111913_from_asherin_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_111913_from_asherin_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_111913_from_asherin_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_111913_from_asherin_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_111913_from_wardani_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_111913_from_wardani_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_111913_from_wardani_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_111913_from_wardani_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_111913_from_wardani_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_111913_from_akba_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_111913_from_akba_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_111913_from_akba_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_111913_from_akba_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_111913_from_akba_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_111913_from_shahid_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_111913_from_shahid_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_111913_from_shahid_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_111913_from_shahid_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_111913_from_nujum_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_111913_from_nujum_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_111913_from_nujum_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_111913_from_nujum_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_111913_from_nujum_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_111913_from_admin_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_111913_from_admin_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_111913_from_admin_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_111913_from_admin_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_111913_from_admin_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 11:19:15,568 | INFO     | src.app.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 11:19:15,568 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 11:19:15,711 | INFO     | src.app.cli.menu | [9] Convert Split Files to Excel
2025-11-17 11:19:15,711 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 11:19:15,712 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-17 11:19:15,712 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 11:30:48,187 | INFO     | src.app.cli.menu | 
==================================================
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   0. Exit
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:30:49,859 | INFO     | src.app.cli.menu | Thank you for using the program!
2025-11-18 10:07:15,718 | INFO     | src.app.cli.menu | 
==================================================
2025-11-18 10:07:15,718 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   0. Exit
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | Executing all steps...
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | Select file option for all steps:
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu |   1. Select specific file (will ask for each step)
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu |   2. Use latest file (applies to all steps)
2025-11-18 10:07:21,088 | INFO     | src.app.cli.menu | Using latest file for all steps...
2025-11-18 10:07:21,089 | INFO     | src.app.cli.menu | [1/9] 1 - Archive Previous Output
2025-11-18 10:07:21,089 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-18 10:07:21,092 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,092 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-18 10:07:21,092 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-18 10:07:21,093 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251118_100721/output
2025-11-18 10:07:21,098 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251118_100721
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251118_100721.zip...
2025-11-18 10:07:21,376 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251118_100721.zip
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251118_100721
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251118_100721.zip
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-18 10:07:21,378 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-18 10:07:21,379 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-18 10:07:21,384 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-18 10:07:21,384 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | ✓ Step 1 completed successfully
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | [2/9] 2 - Convert Excel to CSV
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,385 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-18 10:07:21,385 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | ✓ Step 2 completed successfully
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | [3/9] 3 - Validate Data
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | ✓ Step 3 completed successfully
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | [4/9] 4 - Sales Analysis
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-18 10:07:21
File: selled_stock_drug_only_20251118_100721.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | ✓ Step 4 completed successfully
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | [5/9] 5 - Rename Columns
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251118_100721.csv
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | ✓ Step 5 completed successfully
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | [6/9] 6 - Split by Branches
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251118_100721.csv
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251118_100721.csv by branches...
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251118_100721_asherin.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251118_100721_wardani.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251118_100721_akba.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251118_100721_shahid.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251118_100721_nujum.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251118_100721_admin.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.09 surplus=0.69 writes=0.38 total=1.79
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | ✓ Step 6 completed successfully
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | [7/9] 7 - Generate Transfer Files
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-18 10:07:24,183 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251118_100721_from_asherin_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251118_100721_from_asherin_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251118_100721_from_asherin_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251118_100721_from_asherin_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251118_100721_from_wardani_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251118_100721_from_wardani_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251118_100721_from_wardani_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251118_100721_from_wardani_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251118_100721_from_wardani_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251118_100721_from_akba_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251118_100721_from_akba_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251118_100721_from_akba_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251118_100721_from_akba_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251118_100721_from_akba_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251118_100721_from_shahid_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251118_100721_from_shahid_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251118_100721_from_shahid_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251118_100721_from_shahid_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251118_100721_from_nujum_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251118_100721_from_nujum_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251118_100721_from_nujum_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251118_100721_from_nujum_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251118_100721_from_nujum_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251118_100721_from_admin_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251118_100721_from_admin_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251118_100721_from_admin_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251118_100721_from_admin_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251118_100721_from_admin_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | ✓ Step 7 completed successfully
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | [8/9] 8 - Split Transfer Files by Product Type
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | ✓ Step 8 completed successfully
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | [9/9] 9 - Convert Split Files to Excel
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ✓ Step 9 completed successfully
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | Execution Summary:
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Total steps: 9
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Successful: 9
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Failed: 0
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Success rate: 100.0%
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:16,580 | INFO     | src.app.cli.menu | 
==================================================
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   0. Exit
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:17,946 | INFO     | src.app.cli.menu | Thank you for using the program!
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-18 10:25:22,433 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-18 10:25:22,434 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-18 10:25:22,434 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-18 10:25:22,434 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-18 10:25:22,435 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-18 10:25:23,293 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251118_102523/output
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251118_102523
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251118_102523.zip...
2025-11-18 10:25:23,538 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251118_102523.zip
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251118_102523
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251118_102523.zip
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-18 10:25:23,540 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-18 10:25:23,541 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-18 10:25:23,547 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-18 10:25:23,547 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-18 10:25:23,547 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,547 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-18 10:25:24,047 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-18 10:25:24
File: selled_stock_drug_only_20251118_102523.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,047 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:24,048 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,048 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251118_102524.csv
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-18 10:25:24,090 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-18 10:25:24,091 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-18 10:25:24,091 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251118_102524.csv
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251118_102524.csv by branches...
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251118_102524_asherin.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251118_102524_wardani.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251118_102524_akba.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251118_102524_shahid.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251118_102524_nujum.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251118_102524_admin.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.38 total=1.79
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-18 10:25:25,886 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-18 10:25:25,886 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251118_102524_from_asherin_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251118_102524_from_asherin_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251118_102524_from_asherin_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251118_102524_from_asherin_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251118_102524_from_wardani_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251118_102524_from_wardani_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251118_102524_from_wardani_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251118_102524_from_wardani_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251118_102524_from_wardani_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251118_102524_from_akba_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251118_102524_from_akba_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251118_102524_from_akba_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251118_102524_from_akba_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251118_102524_from_akba_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251118_102524_from_shahid_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251118_102524_from_shahid_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251118_102524_from_shahid_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251118_102524_from_shahid_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251118_102524_from_nujum_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251118_102524_from_nujum_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251118_102524_from_nujum_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251118_102524_from_nujum_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251118_102524_from_nujum_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251118_102524_from_admin_to_asherin.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251118_102524_from_admin_to_wardani.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251118_102524_from_admin_to_akba.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251118_102524_from_admin_to_shahid.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251118_102524_from_admin_to_nujum.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:17:11,369 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 07:17:11,370 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:12,562 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 07:17:12,562 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 07:17:12,563 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 07:17:12,563 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_071712/output
2025-11-22 07:17:12,567 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_071712
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_071712.zip...
2025-11-22 07:17:12,810 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_071712.zip
2025-11-22 07:17:12,812 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 07:17:12,812 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 07:17:12,812 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 07:17:12,813 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 07:17:12,818 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 07:17:12,818 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 07:17:12,818 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:12,818 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 07:17:12,819 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 07:17:13,380 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 07:17:13
File: selled_stock_drug_only_20251122_071712.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 07:17:13,380 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 07:17:13,380 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 07:17:13,381 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_071713.csv
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251122_071713.csv
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_071713.csv by branches...
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_071713_asherin.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_071713_wardani.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_071713_akba.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_071713_shahid.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_071713_nujum.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_071713_admin.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.06 allocation=0.09 surplus=0.70 writes=0.37 total=1.79
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_071713_from_asherin_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_071713_from_asherin_to_akba.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_071713_from_asherin_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_071713_from_asherin_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_071713_from_wardani_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_071713_from_wardani_to_akba.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_071713_from_wardani_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_071713_from_wardani_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_071713_from_wardani_to_admin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_071713_from_akba_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_071713_from_akba_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_071713_from_akba_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_071713_from_akba_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_071713_from_akba_to_admin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_071713_from_shahid_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_071713_from_shahid_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_071713_from_shahid_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_071713_from_shahid_to_nujum.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_071713_from_nujum_to_asherin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_071713_from_nujum_to_wardani.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_071713_from_nujum_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_071713_from_nujum_to_shahid.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_071713_from_nujum_to_admin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_071713_from_admin_to_asherin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_071713_from_admin_to_wardani.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_071713_from_admin_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_071713_from_admin_to_shahid.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_071713_from_admin_to_nujum.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:30:52,318 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:52,950 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:55,893 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-22 07:30:58,068 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:59,534 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 07:30:59,534 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 07:31:01,118 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 07:31:01,118 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 07:31:01,119 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,119 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 07:31:01,120 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 07:31:01,120 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 07:31:01,121 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_073101/output
2025-11-22 07:31:01,125 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_073101
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_073101.zip...
2025-11-22 07:31:01,374 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_073101.zip
2025-11-22 07:31:01,376 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 07:31:01,376 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 07:31:01,376 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 07:31:01,377 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 07:31:01,382 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 07:31:01,382 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 07:31:01,382 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,382 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 07:31:01,383 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,874 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 07:31:01
File: selled_stock_drug_only_20251122_073101.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_073101.csv
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251122_073101.csv
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_073101.csv by branches...
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_073101_asherin.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_073101_wardani.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_073101_akba.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_073101_shahid.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_073101_nujum.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_073101_admin.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.37 total=1.75
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_073101_from_asherin_to_wardani.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_073101_from_asherin_to_akba.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_073101_from_asherin_to_shahid.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_073101_from_asherin_to_nujum.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_073101_from_wardani_to_asherin.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_073101_from_wardani_to_akba.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_073101_from_wardani_to_shahid.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_073101_from_wardani_to_nujum.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_073101_from_wardani_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_073101_from_akba_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_073101_from_akba_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_073101_from_akba_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_073101_from_akba_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_073101_from_akba_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_073101_from_shahid_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_073101_from_shahid_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_073101_from_shahid_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_073101_from_shahid_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_073101_from_nujum_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_073101_from_nujum_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_073101_from_nujum_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_073101_from_nujum_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_073101_from_nujum_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_073101_from_admin_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_073101_from_admin_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_073101_from_admin_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_073101_from_admin_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_073101_from_admin_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:27,464 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 10:35:27,464 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 10:35:27,469 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:27,870 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:32,670 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 10:35:32,670 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:32,670 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 10:35:32,670 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 10:35:32,671 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 10:35:33,653 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 10:35:33,653 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 10:35:33,654 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:33,654 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_103533/output
2025-11-22 10:35:33,660 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_103533
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_103533.zip...
2025-11-22 10:35:33,915 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_103533.zip
2025-11-22 10:35:33,919 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 10:35:33,919 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 10:35:33,919 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 10:35:33,920 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 10:35:33,928 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 10:35:33,929 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,431 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 10:35:34,431 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 10:35:34,432 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 10:35:34,432 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 10:35:34,440 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 10:35:34
File: selled_stock_drug_only_20251122_103533.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_103534.csv
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 10:35:34,483 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 10:35:34,483 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 10:35:34,484 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251122_103534.csv
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_103534.csv by branches...
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 10:35:34,528 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-22 10:35:36,255 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_103534_asherin.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_103534_wardani.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_103534_akba.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_103534_shahid.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_103534_nujum.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_103534_admin.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.37 total=1.77
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_103534_from_asherin_to_wardani.csv
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_103534_from_asherin_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_103534_from_asherin_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_103534_from_asherin_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_103534_from_wardani_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_103534_from_wardani_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_103534_from_wardani_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_103534_from_wardani_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_103534_from_wardani_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_103534_from_akba_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_103534_from_akba_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_103534_from_akba_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_103534_from_akba_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_103534_from_akba_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_103534_from_shahid_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_103534_from_shahid_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_103534_from_shahid_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_103534_from_shahid_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_103534_from_nujum_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_103534_from_nujum_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_103534_from_nujum_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_103534_from_nujum_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_103534_from_nujum_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_103534_from_admin_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_103534_from_admin_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_103534_from_admin_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_103534_from_admin_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_103534_from_admin_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 10:35:37,530 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 10:35:37,530 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:16:37,547 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:16:37,551 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:37,551 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:16:37,551 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:16:37,552 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:16:38,395 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:16:38,395 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:16:38,396 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:38,397 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:16:38,397 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:16:38,397 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:16:38,398 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_101638/output
2025-11-24 10:16:38,403 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_101638
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_101638.zip...
2025-11-24 10:16:38,679 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_101638.zip
2025-11-24 10:16:38,681 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:16:38,681 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:16:38,681 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:16:38,682 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:16:38,687 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:16:38,687 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,193 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:16:39
File: selled_stock_drug_only_20251124_101638.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_101639.csv
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:16:39,303 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:16:39,304 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:16:39,304 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_101639.csv
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_101639.csv by branches...
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:16:39,349 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_101639_asherin.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_101639_wardani.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_101639_akba.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_101639_shahid.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_101639_nujum.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_101639_admin.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.10 surplus=0.67 writes=0.39 total=1.81
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:12,749 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:16,648 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:28:18,424 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:19,991 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:28:19,992 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:28:20,511 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:28:20,512 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:28:20,512 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:20,513 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:28:20,513 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:28:20,514 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:28:20,514 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_102820/output
2025-11-24 10:28:20,519 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_102820
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_102820.zip...
2025-11-24 10:28:20,764 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_102820.zip
2025-11-24 10:28:20,765 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:28:20,765 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:28:20,765 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:28:20,766 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:28:20,772 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:28:20,772 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,242 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,287 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:28:21
File: selled_stock_drug_only_20251124_102820.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_102821.csv
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_102821.csv
2025-11-24 10:28:21,341 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_102821.csv by branches...
2025-11-24 10:28:21,341 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:28:21,385 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_102821_asherin.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_102821_wardani.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_102821_akba.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_102821_shahid.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_102821_nujum.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_102821_admin.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.70 writes=0.37 total=1.77
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:28:23,652 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:28:23,652 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:44,237 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:53:44,237 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:45,412 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:49,234 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:53:49,235 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:49,686 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105349/output
2025-11-24 10:53:49,692 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105349
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105349.zip...
2025-11-24 10:53:49,946 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105349.zip
2025-11-24 10:53:49,948 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:53:49,948 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:53:49,948 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:53:49,949 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:53:49,954 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:53:49,954 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:53:49,954 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:49,955 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:53:49,955 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,462 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:53:50
File: selled_stock_drug_only_20251124_105349.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105350.csv
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105350.csv
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105350.csv by branches...
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:53:50,559 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105350_asherin.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105350_wardani.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105350_akba.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105350_shahid.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105350_nujum.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105350_admin.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.72 writes=0.38 total=1.85
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:53:52,770 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:53:52,770 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:53:52,771 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:56:06,417 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:56:06,417 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:07,425 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105607/output
2025-11-24 10:56:07,426 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105607
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105607.zip...
2025-11-24 10:56:07,663 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105607.zip
2025-11-24 10:56:07,665 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:56:07,665 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:56:07,665 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:56:07,666 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:56:07,672 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:56:07,672 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,142 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:56:08
File: selled_stock_drug_only_20251124_105607.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,152 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105608.csv
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105608.csv
2025-11-24 10:56:08,194 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105608.csv by branches...
2025-11-24 10:56:08,194 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:56:08,238 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105608_asherin.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105608_wardani.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105608_akba.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105608_shahid.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105608_nujum.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105608_admin.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.10 surplus=0.76 writes=0.40 total=1.94
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:56:10,533 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:56:10,533 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:17,713 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:57:19,509 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:22,449 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:57:22,449 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:57:22,872 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:57:22,872 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:57:22,873 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:22,873 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105722/output
2025-11-24 10:57:22,879 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:57:22,906 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:57:22,906 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105722
2025-11-24 10:57:22,907 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:57:22,907 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105722.zip...
2025-11-24 10:57:23,108 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105722.zip
2025-11-24 10:57:23,110 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:57:23,110 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:57:23,110 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:57:23,111 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:57:23,117 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:57:23,117 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:57:23,642 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:57:23
File: selled_stock_drug_only_20251124_105723.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105723.csv
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105723.csv
2025-11-24 10:57:23,687 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105723.csv by branches...
2025-11-24 10:57:23,687 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:57:23,732 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105723_asherin.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105723_wardani.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105723_akba.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105723_shahid.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105723_nujum.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105723_admin.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.74 writes=0.38 total=1.87
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:57:26,878 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:44,522 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:45,042 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 11:34:46,445 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:47,724 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 11:34:47,725 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 11:34:48,249 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 11:34:48,250 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 11:34:48,250 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,251 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_113448/output
2025-11-24 11:34:48,260 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 11:34:48,302 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_113448
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_113448.zip...
2025-11-24 11:34:48,501 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_113448.zip
2025-11-24 11:34:48,502 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 11:34:48,503 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 11:34:48,503 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 11:34:48,503 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 11:34:48,509 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 11:34:48,509 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 11:34:48,509 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,509 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 11:34:48,510 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 11:34:49
File: selled_stock_drug_only_20251124_113448.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_113449.csv
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_113449.csv
2025-11-24 11:34:49,059 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_113449.csv by branches...
2025-11-24 11:34:49,059 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 11:34:49,094 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_113449_asherin.csv
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_113449_wardani.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_113449_akba.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_113449_shahid.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_113449_nujum.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_113449_admin.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=0.71 writes=0.34 total=1.78
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_admin_to_akba.csv (9.5 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_admin_to_asherin.csv (8.7 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_admin_to_nujum.csv (6.1 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_admin_to_shahid.csv (11.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_admin_to_wardani.csv (5.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_113449_from_akba_to_admin.csv (87.0 B)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_akba_to_nujum.csv (3.4 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_akba_to_shahid.csv (3.4 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_akba_to_wardani.csv (2.2 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_113449_from_asherin_to_admin.csv (83.0 B)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_asherin_to_nujum.csv (4.3 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_asherin_to_shahid.csv (3.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_asherin_to_wardani.csv (2.5 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_nujum_to_akba.csv (15.7 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_nujum_to_asherin.csv (13.3 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_nujum_to_shahid.csv (13.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_nujum_to_wardani.csv (7.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_shahid_to_akba.csv (4.5 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_shahid_to_asherin.csv (3.6 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_shahid_to_nujum.csv (3.5 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_shahid_to_wardani.csv (2.9 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_wardani_to_akba.csv (5.7 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_wardani_to_asherin.csv (6.6 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_wardani_to_nujum.csv (6.4 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_wardani_to_shahid.csv (7.2 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler | Generated 151 split files:
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 24 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | Found 151 split CSV files to convert
2025-11-24 11:34:52,033 | INFO     | src.app.pipeline.step_9_handler | Generated 151 Excel files:
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 24 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:39:01,698 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 08:39:01,699 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 08:39:02,690 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 08:39:02,691 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 08:39:02,691 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:02,692 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_083902/output
2025-11-26 08:39:02,698 | INFO     | src.shared.utils.archiver |   Found 343 files in 84 directories
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_083902
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver |   - Archived 343 files in 84 directories
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_083902.zip...
2025-11-26 08:39:02,925 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_083902.zip
2025-11-26 08:39:02,927 | INFO     | src.app.pipeline.step_1_handler | Archive created: 343 files, 84 dirs | Size: 9.33 MB
2025-11-26 08:39:02,927 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.64 MB (71.7% compression)
2025-11-26 08:39:02,927 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 08:39:02,928 | INFO     | src.shared.utils.archiver |   Found 343 files in 84 directories to delete
2025-11-26 08:39:02,933 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 08:39:02,933 | INFO     | src.shared.utils.archiver |   ✓ Deleted 343 files and 84 directories
2025-11-26 08:39:02,933 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:02,934 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 08:39:02,934 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,448 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,495 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,495 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,496 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,496 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 08:39:03
File: selled_stock_drug_only_20251126_083902.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_083903.csv
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_083903.csv
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_083903.csv by branches...
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 08:39:03,593 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_083903_asherin.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_083903_wardani.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_083903_akba.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_083903_shahid.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_083903_nujum.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_083903_admin.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=1.44 writes=0.34 total=2.57
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_admin_to_akba.csv (8.8 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_admin_to_asherin.csv (7.6 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_admin_to_nujum.csv (6.1 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_admin_to_shahid.csv (10.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_admin_to_wardani.csv (4.7 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_083903_from_akba_to_admin.csv (87.0 B)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_akba_to_asherin.csv (3.4 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_akba_to_nujum.csv (3.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_akba_to_shahid.csv (3.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_akba_to_wardani.csv (2.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_083903_from_asherin_to_admin.csv (83.0 B)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_asherin_to_akba.csv (3.8 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_asherin_to_nujum.csv (4.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_asherin_to_shahid.csv (3.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_asherin_to_wardani.csv (1.8 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_nujum_to_akba.csv (15.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_nujum_to_asherin.csv (11.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_nujum_to_shahid.csv (12.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_nujum_to_wardani.csv (6.9 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_shahid_to_akba.csv (4.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_shahid_to_asherin.csv (3.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_shahid_to_nujum.csv (3.5 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_shahid_to_wardani.csv (2.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_wardani_to_akba.csv (5.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_wardani_to_asherin.csv (5.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_wardani_to_nujum.csv (6.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_wardani_to_shahid.csv (6.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:14,985 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:15,831 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:18,568 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 08:52:18,568 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:18,568 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 08:52:18,569 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 08:52:18,569 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,153 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_085219/output
2025-11-26 08:52:19,158 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_085219
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver |   - Archived 339 files in 84 directories
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_085219.zip...
2025-11-26 08:52:19,397 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_085219.zip
2025-11-26 08:52:19,399 | INFO     | src.app.pipeline.step_1_handler | Archive created: 339 files, 84 dirs | Size: 9.27 MB
2025-11-26 08:52:19,399 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.60 MB (71.9% compression)
2025-11-26 08:52:19,399 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 08:52:19,400 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories to delete
2025-11-26 08:52:19,405 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 08:52:19,405 | INFO     | src.shared.utils.archiver |   ✓ Deleted 339 files and 84 directories
2025-11-26 08:52:19,405 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 08:52:19,405 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 08:52:19,405 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 08:52:19,406 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,406 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 08:52:19,406 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 08:52:19,914 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 08:52:19
File: selled_stock_drug_only_20251126_085219.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_085219.csv
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_085219.csv
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_085219.csv by branches...
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 08:52:19,994 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_085219_asherin.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_085219_wardani.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_085219_akba.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_085219_shahid.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_085219_nujum.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_085219_admin.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=1.39 writes=0.34 total=2.49
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 08:52:22,452 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 08:52:22,453 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 08:52:22,453 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 08:52:22,835 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_admin_to_akba.csv (8.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_admin_to_asherin.csv (7.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_admin_to_nujum.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_admin_to_shahid.csv (10.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_admin_to_wardani.csv (4.7 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_085219_from_akba_to_admin.csv (87.0 B)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_akba_to_asherin.csv (3.4 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_akba_to_nujum.csv (3.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_akba_to_shahid.csv (3.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_akba_to_wardani.csv (2.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_085219_from_asherin_to_admin.csv (83.0 B)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_asherin_to_akba.csv (3.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_asherin_to_nujum.csv (4.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_asherin_to_shahid.csv (3.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_asherin_to_wardani.csv (1.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_nujum_to_akba.csv (15.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_nujum_to_asherin.csv (11.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_nujum_to_shahid.csv (12.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_nujum_to_wardani.csv (6.9 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_shahid_to_akba.csv (4.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_shahid_to_asherin.csv (3.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_shahid_to_nujum.csv (3.5 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_shahid_to_wardani.csv (2.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_wardani_to_akba.csv (5.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_wardani_to_asherin.csv (5.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_wardani_to_nujum.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_wardani_to_shahid.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 08:52:22,837 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 08:52:22,837 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:30,232 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:30,233 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:32,840 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:00:50,551 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 09:00:50,554 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 09:00:51,063 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 09:00:51,064 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 09:00:51,064 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,064 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_090051/output
2025-11-26 09:00:51,070 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_090051
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver |   - Archived 339 files in 84 directories
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_090051.zip...
2025-11-26 09:00:51,304 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_090051.zip
2025-11-26 09:00:51,308 | INFO     | src.app.pipeline.step_1_handler | Archive created: 339 files, 84 dirs | Size: 9.27 MB
2025-11-26 09:00:51,308 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.60 MB (71.9% compression)
2025-11-26 09:00:51,308 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 09:00:51,309 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories to delete
2025-11-26 09:00:51,318 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 09:00:51,318 | INFO     | src.shared.utils.archiver |   ✓ Deleted 339 files and 84 directories
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,825 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 09:00:51
File: selled_stock_drug_only_20251126_090051.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_090051.csv
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_090051.csv
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_090051.csv by branches...
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 09:00:51,915 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_090051_asherin.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_090051_wardani.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_090051_akba.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_090051_shahid.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_090051_nujum.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_090051_admin.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.13 surplus=1.42 writes=0.34 total=2.53
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_admin_to_akba.csv (9.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_admin_to_nujum.csv (6.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_admin_to_shahid.csv (10.8 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_admin_to_wardani.csv (5.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_090051_from_akba_to_admin.csv (87.0 B)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_akba_to_asherin.csv (3.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_akba_to_nujum.csv (3.3 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_akba_to_shahid.csv (3.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_akba_to_wardani.csv (2.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_090051_from_asherin_to_admin.csv (83.0 B)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_asherin_to_akba.csv (4.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_asherin_to_wardani.csv (2.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_nujum_to_akba.csv (16.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_nujum_to_asherin.csv (12.1 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_nujum_to_shahid.csv (13.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_shahid_to_akba.csv (4.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_shahid_to_asherin.csv (3.5 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_shahid_to_wardani.csv (2.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_wardani_to_akba.csv (6.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_wardani_to_nujum.csv (6.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_wardani_to_shahid.csv (7.0 KB)
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler | Generated 150 split files:
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 24 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | Found 150 split CSV files to convert
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler | Generated 150 Excel files:
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 24 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:08,483 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:28:08,485 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:10,571 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:39,919 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 09:28:39,919 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 09:28:40,615 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 09:28:40,618 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 09:28:40,618 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:40,619 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_092840/output
2025-11-26 09:28:40,623 | INFO     | src.shared.utils.archiver |   Found 341 files in 84 directories
2025-11-26 09:28:40,647 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_092840
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver |   - Archived 341 files in 84 directories
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_092840.zip...
2025-11-26 09:28:40,840 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_092840.zip
2025-11-26 09:28:40,842 | INFO     | src.app.pipeline.step_1_handler | Archive created: 341 files, 84 dirs | Size: 9.32 MB
2025-11-26 09:28:40,842 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.63 MB (71.8% compression)
2025-11-26 09:28:40,842 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 09:28:40,843 | INFO     | src.shared.utils.archiver |   Found 341 files in 84 directories to delete
2025-11-26 09:28:40,849 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 09:28:40,849 | INFO     | src.shared.utils.archiver |   ✓ Deleted 341 files and 84 directories
2025-11-26 09:28:40,849 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:40,850 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 09:28:40,850 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,346 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 09:28:41
File: selled_stock_drug_only_20251126_092840.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_092841.csv
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_092841.csv
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_092841.csv by branches...
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 09:28:41,436 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 09:28:44,198 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_092841_asherin.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_092841_wardani.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_092841_akba.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_092841_shahid.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_092841_nujum.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_092841_admin.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.13 surplus=1.68 writes=0.34 total=2.80
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_admin_to_akba.csv (9.0 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_admin_to_asherin.csv (8.2 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_admin_to_nujum.csv (6.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_admin_to_shahid.csv (10.7 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_admin_to_wardani.csv (5.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_092841_from_akba_to_admin.csv (114.0 B)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_akba_to_asherin.csv (3.7 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_akba_to_shahid.csv (3.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_akba_to_wardani.csv (2.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_asherin_to_nujum.csv (4.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_asherin_to_shahid.csv (4.2 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_nujum_to_akba.csv (16.0 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_nujum_to_asherin.csv (12.6 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_nujum_to_shahid.csv (13.1 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_nujum_to_wardani.csv (7.4 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_wardani_to_akba.csv (6.9 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_wardani_to_asherin.csv (5.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_wardani_to_nujum.csv (6.5 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_wardani_to_shahid.csv (7.0 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler | Generated 151 split files:
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | Found 151 split CSV files to convert
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler | Generated 151 Excel files:
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:28,293 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 10:16:30,211 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:32,909 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 10:16:32,909 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:33,405 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_101633/output
2025-11-26 10:16:33,406 | INFO     | src.shared.utils.archiver |   Found 342 files in 82 directories
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_101633
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver |   - Archived 342 files in 82 directories
2025-11-26 10:16:33,422 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_101633.zip...
2025-11-26 10:16:33,621 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_101633.zip
2025-11-26 10:16:33,623 | INFO     | src.app.pipeline.step_1_handler | Archive created: 342 files, 82 dirs | Size: 9.32 MB
2025-11-26 10:16:33,623 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.63 MB (71.7% compression)
2025-11-26 10:16:33,623 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 10:16:33,623 | INFO     | src.shared.utils.archiver |   Found 342 files in 82 directories to delete
2025-11-26 10:16:33,629 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 10:16:33,629 | INFO     | src.shared.utils.archiver |   ✓ Deleted 342 files and 82 directories
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 10:16:34
File: selled_stock_drug_only_20251126_101633.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,170 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_101634.csv
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_101634.csv
2025-11-26 10:16:34,214 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_101634.csv by branches...
2025-11-26 10:16:34,214 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 10:16:34,249 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_101634_asherin.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_101634_wardani.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_101634_akba.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_101634_shahid.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_101634_nujum.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_101634_admin.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.76 writes=0.42 total=3.04
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_admin_to_akba.csv (9.1 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_admin_to_asherin.csv (8.4 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_admin_to_nujum.csv (6.4 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_admin_to_shahid.csv (10.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_101634_from_akba_to_admin.csv (114.0 B)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_akba_to_asherin.csv (3.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_akba_to_nujum.csv (3.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_asherin_to_shahid.csv (4.1 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_asherin_to_wardani.csv (2.5 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_nujum_to_akba.csv (15.8 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_nujum_to_asherin.csv (12.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_nujum_to_shahid.csv (13.0 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_shahid_to_asherin.csv (3.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_wardani_to_akba.csv (6.8 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_wardani_to_asherin.csv (5.8 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_wardani_to_nujum.csv (6.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 10:16:38,566 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 10:16:38,566 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:34,118 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:05:35,965 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:37,689 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:05:37,689 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,215 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_110538/output
2025-11-26 11:05:38,216 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_110538
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_110538.zip...
2025-11-26 11:05:38,431 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_110538.zip
2025-11-26 11:05:38,433 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 9.31 MB
2025-11-26 11:05:38,433 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.62 MB (71.8% compression)
2025-11-26 11:05:38,433 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:05:38,434 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:05:38,439 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:05:38,439 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:05:38,439 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,440 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:05:38,440 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:05:38
File: selled_stock_drug_only_20251126_110538.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_110538.csv
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_110538.csv
2025-11-26 11:05:39,020 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_110538.csv by branches...
2025-11-26 11:05:39,020 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:05:39,057 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_110539_asherin.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_110539_wardani.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_110539_akba.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_110539_shahid.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_110539_nujum.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_110539_admin.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.79 writes=0.34 total=2.98
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:05:42,005 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:05:42,005 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_110539_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:29,746 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:33,396 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:13:33,396 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:13:33,835 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:13:33,835 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 11:13:33,836 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:33,836 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_111333/output
2025-11-26 11:13:33,841 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_111333
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_111333.zip...
2025-11-26 11:13:34,064 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_111333.zip
2025-11-26 11:13:34,066 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:13:34,066 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:13:34,066 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:13:34,066 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:13:34,072 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:13:34,072 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,536 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,536 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,581 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,581 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,582 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,582 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:13:34
File: selled_stock_drug_only_20251126_111334.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_111334.csv
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_111334.csv
2025-11-26 11:13:34,635 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_111334.csv by branches...
2025-11-26 11:13:34,635 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:13:34,670 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:13:37,587 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_111334_asherin.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_111334_wardani.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_111334_akba.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_111334_shahid.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_111334_nujum.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_111334_admin.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.81 writes=0.31 total=2.95
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_111334_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:13:37,937 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:13:37,937 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 11:13:37,938 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:13:38,077 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:38,451 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:39,239 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:24:41,081 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:48,784 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:24:48,785 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:24:49,976 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:24:49,976 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:24:49,977 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:49,977 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_112449/output
2025-11-26 11:24:49,983 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_112449
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_112449.zip...
2025-11-26 11:24:50,217 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_112449.zip
2025-11-26 11:24:50,219 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:24:50,219 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:24:50,219 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:24:50,220 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:24:50,228 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:24:50,228 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:24:50,228 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,229 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:24:50,229 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,760 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:24:50
File: selled_stock_drug_only_20251126_112450.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_112450.csv
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_112450.csv
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_112450.csv by branches...
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:24:50,849 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:24:53,728 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_112450_asherin.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_112450_wardani.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_112450_akba.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_112450_shahid.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_112450_nujum.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_112450_admin.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.77 writes=0.31 total=2.91
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_112450_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:24:54,239 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:24:54,239 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:24:54,240 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:24:54,958 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,965 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: asherin
2025-11-26 11:24:54,971 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: wardani
2025-11-26 11:24:54,977 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: akba
2025-11-26 11:24:54,983 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: shahid
2025-11-26 11:24:54,989 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: nujum
2025-11-26 11:24:54,995 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: admin
2025-11-26 11:24:54,995 | WARNING  | src.app.pipeline.step_11_handler | No remaining surplus files were created
2025-11-26 11:24:54,995 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 11 failed
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Failed: 1
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 90.0%
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:29,165 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:32:30,758 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:32,085 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:32,507 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:41,118 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:32:41,122 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:32:42,182 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:32:42,182 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:32:42,183 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,184 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_113242/output
2025-11-26 11:32:42,190 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_113242
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_113242.zip...
2025-11-26 11:32:42,434 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_113242.zip
2025-11-26 11:32:42,436 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:32:42,436 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:32:42,436 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:32:42,437 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:32:42,442 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:32:42,442 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:32:42,442 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,442 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:32:42,443 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,905 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,950 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:32:42
File: selled_stock_drug_only_20251126_113242.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_113242.csv
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_113242.csv
2025-11-26 11:32:43,004 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_113242.csv by branches...
2025-11-26 11:32:43,004 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:32:43,040 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:32:45,920 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:32:45,920 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_113243_asherin.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_113243_wardani.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_113243_akba.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_113243_shahid.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_113243_nujum.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_113243_admin.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.76 writes=0.33 total=2.92
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_113243_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:47,785 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for asherin: 1342 products
2025-11-26 11:32:48,490 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for wardani: 1759 products
2025-11-26 11:32:49,213 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for akba: 1508 products
2025-11-26 11:32:49,883 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for shahid: 1591 products
2025-11-26 11:32:50,547 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for nujum: 2557 products
2025-11-26 11:32:51,229 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for admin: 1596 products
2025-11-26 11:32:51,229 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:32:51,269 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_asherin_remaining_surplus.xlsx
2025-11-26 11:32:51,318 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_wardani_remaining_surplus.xlsx
2025-11-26 11:32:51,374 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_akba_remaining_surplus.xlsx
2025-11-26 11:32:51,420 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_shahid_remaining_surplus.xlsx
2025-11-26 11:32:51,494 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_nujum_remaining_surplus.xlsx
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_admin_remaining_surplus.xlsx
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus CSV files
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus Excel files
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:16,848 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:45:16,851 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:17,748 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_114517/output
2025-11-26 11:45:17,754 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_114517
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver |   - Archived 350 files in 84 directories
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_114517.zip...
2025-11-26 11:45:18,039 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_114517.zip
2025-11-26 11:45:18,041 | INFO     | src.app.pipeline.step_1_handler | Archive created: 350 files, 84 dirs | Size: 9.23 MB
2025-11-26 11:45:18,041 | INFO     | src.app.pipeline.step_1_handler | ZIP: 3.04 MB (67.0% compression)
2025-11-26 11:45:18,041 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:45:18,042 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories to delete
2025-11-26 11:45:18,047 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:45:18,047 | INFO     | src.shared.utils.archiver |   ✓ Deleted 350 files and 84 directories
2025-11-26 11:45:18,047 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,048 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:45:18,048 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:45:18
File: selled_stock_drug_only_20251126_114518.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_114518.csv
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_114518.csv
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_114518.csv by branches...
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:45:18,581 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:45:21,490 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:45:21,490 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_114518_asherin.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_114518_wardani.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_114518_akba.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_114518_shahid.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_114518_nujum.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_114518_admin.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.18 surplus=1.80 writes=0.31 total=2.94
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_114518_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:45:22,677 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:23,366 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for asherin: 1342 products
2025-11-26 11:45:24,041 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for wardani: 1759 products
2025-11-26 11:45:24,709 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for akba: 1508 products
2025-11-26 11:45:25,388 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for shahid: 1591 products
2025-11-26 11:45:26,061 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for nujum: 2557 products
2025-11-26 11:45:26,728 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for admin: 1596 products
2025-11-26 11:45:26,728 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:45:26,768 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_asherin_remaining_surplus.xlsx
2025-11-26 11:45:26,832 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_wardani_remaining_surplus.xlsx
2025-11-26 11:45:26,876 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_akba_remaining_surplus.xlsx
2025-11-26 11:45:26,922 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_shahid_remaining_surplus.xlsx
2025-11-26 11:45:26,994 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_nujum_remaining_surplus.xlsx
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_admin_remaining_surplus.xlsx
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus CSV files
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus Excel files
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:36,977 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:37,618 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:42,876 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:45:42,876 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:45:43,608 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:45:43,609 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:45:43,609 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:43,610 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:45:43,610 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:45:43,611 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:45:43,611 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_114543/output
2025-11-26 11:45:43,616 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_114543
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver |   - Archived 350 files in 84 directories
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_114543.zip...
2025-11-26 11:45:43,881 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_114543.zip
2025-11-26 11:45:43,883 | INFO     | src.app.pipeline.step_1_handler | Archive created: 350 files, 84 dirs | Size: 9.23 MB
2025-11-26 11:45:43,883 | INFO     | src.app.pipeline.step_1_handler | ZIP: 3.04 MB (67.0% compression)
2025-11-26 11:45:43,883 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:45:43,884 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories to delete
2025-11-26 11:45:43,889 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:45:43,889 | INFO     | src.shared.utils.archiver |   ✓ Deleted 350 files and 84 directories
2025-11-26 11:45:43,889 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:43,890 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:45:43,890 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:45:44,449 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:45:44
File: selled_stock_drug_only_20251126_114543.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_114544.csv
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_114544.csv
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_114544.csv by branches...
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:45:44,530 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:45:47,358 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_114544_asherin.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_114544_wardani.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_114544_akba.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_114544_shahid.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_114544_nujum.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_114544_admin.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.19 surplus=1.75 writes=0.30 total=2.86
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_114544_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:45:47,713 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:45:47,713 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:45:47,714 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:49,333 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 11:45:50,027 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 11:45:50,708 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 11:45:51,389 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 11:45:52,077 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 11:45:52,765 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 11:45:52,765 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Generated 36 remaining surplus CSV files
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Generated 36 remaining surplus Excel files
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:39:15,296 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:16,829 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-26 13:39:18,817 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:18,817 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:21,121 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:24,063 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-26 13:39:24,063 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-26 13:39:24,774 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:25,460 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:26,152 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:39:26,830 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:39:27,518 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:39:28,207 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:39:28,207 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:39:28,668 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:31,363 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 13:39:32,714 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:34,047 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-26 13:39:34,048 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-26 13:39:34,779 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:35,469 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:36,171 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:39:36,855 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:39:37,575 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:39:38,265 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:39:38,265 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:39:38,716 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:39:44,193 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:44,196 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:44,200 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:51,696 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 13:39:51,697 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:52,328 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_133952/output
2025-11-26 13:39:52,336 | INFO     | src.shared.utils.archiver |   Found 554 files in 96 directories
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_133952
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver |   - Archived 554 files in 96 directories
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_133952.zip...
2025-11-26 13:39:52,640 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_133952.zip
2025-11-26 13:39:52,643 | INFO     | src.app.pipeline.step_1_handler | Archive created: 554 files, 96 dirs | Size: 10.89 MB
2025-11-26 13:39:52,643 | INFO     | src.app.pipeline.step_1_handler | ZIP: 4.38 MB (59.8% compression)
2025-11-26 13:39:52,643 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 13:39:52,644 | INFO     | src.shared.utils.archiver |   Found 554 files in 96 directories to delete
2025-11-26 13:39:52,651 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 13:39:52,651 | INFO     | src.shared.utils.archiver |   ✓ Deleted 554 files and 96 directories
2025-11-26 13:39:52,651 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:52,651 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 13:39:52,652 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 13:39:53,137 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 13:39:53
File: selled_stock_drug_only_20251126_133952.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,137 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,138 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,138 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 13:39:53,182 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_133953.csv
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_133953.csv
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_133953.csv by branches...
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 13:39:53,218 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_133953_asherin.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_133953_wardani.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_133953_akba.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_133953_shahid.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_133953_nujum.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_133953_admin.csv
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.19 surplus=1.78 writes=0.31 total=2.92
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_admin_to_akba.csv (8.7 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_133953_from_akba_to_admin.csv (114.0 B)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:57,967 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:58,676 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:59,419 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:40:00,154 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:40:00,882 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:40:01,635 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:40:01,635 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:09,291 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-27 10:07:09,292 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-27 10:07:09,930 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:07:10,519 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:07:11,103 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:07:11,703 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:07:12,296 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:07:12,885 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:07:12,885 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:07:13,341 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:07:16,492 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:17,706 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:07:20,278 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:23,946 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:07:23,949 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:07:24,658 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:07:24,659 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:07:24,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:24,660 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_100724/output
2025-11-27 10:07:24,668 | INFO     | src.shared.utils.archiver |   Found 482 files in 96 directories
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_100724
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver |   - Archived 482 files in 96 directories
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_100724.zip...
2025-11-27 10:07:24,989 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_100724.zip
2025-11-27 10:07:24,991 | INFO     | src.app.pipeline.step_1.handler | Archive created: 482 files, 96 dirs | Size: 10.13 MB
2025-11-27 10:07:24,991 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.79 MB (62.6% compression)
2025-11-27 10:07:24,991 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:07:24,992 | INFO     | src.shared.utils.archiver |   Found 482 files in 96 directories to delete
2025-11-27 10:07:24,999 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:07:24,999 | INFO     | src.shared.utils.archiver |   ✓ Deleted 482 files and 96 directories
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:07:25
File: selled_stock_drug_only_20251127_100724.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_100725.csv
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_100725.csv
2025-11-27 10:07:25,587 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_100725.csv by branches...
2025-11-27 10:07:25,587 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:07:25,623 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:07:28,374 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_100725_asherin.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_100725_wardani.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_100725_akba.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_100725_shahid.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_100725_nujum.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_100725_admin.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.70 writes=0.29 total=2.79
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:07:28,712 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_100725_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:30,142 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:07:30,768 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:07:31,354 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:07:31,942 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:07:32,534 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:07:33,114 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:07:33,114 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:20:15,902 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:20:15,902 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:16,454 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:19,831 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:20:19,831 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:19,831 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:20:19,832 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:20:19,832 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:20,991 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102020/output
2025-11-27 10:20:20,995 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102020
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102020.zip...
2025-11-27 10:20:21,262 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102020.zip
2025-11-27 10:20:21,265 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:20:21,265 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:20:21,265 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:20:21,266 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:20:21,272 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:20:21,272 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,730 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:20:21,730 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:20:21,731 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:20:21,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,776 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:20:21
File: selled_stock_drug_only_20251127_102021.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102021.csv
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102021.csv
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102021.csv by branches...
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:20:21,864 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102021_asherin.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102021_wardani.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102021_akba.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102021_shahid.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102021_nujum.csv
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102021_admin.csv
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.68 writes=0.30 total=2.74
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102021_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:20:25,043 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:26,329 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:20:26,934 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:20:27,521 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:20:28,106 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:20:28,718 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:20:29,332 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:20:29,332 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:25:46,590 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:25:46,590 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:51,512 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:55,163 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:25:55,164 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:25:56,235 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:25:56,235 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:25:56,236 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,236 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102556/output
2025-11-27 10:25:56,241 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102556
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102556.zip...
2025-11-27 10:25:56,513 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102556.zip
2025-11-27 10:25:56,515 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:25:56,515 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:25:56,515 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:25:56,516 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:25:56,521 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:25:56,521 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:25:56,521 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,522 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:25:56,522 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:56,968 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,968 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:25:57
File: selled_stock_drug_only_20251127_102556.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102557.csv
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102557.csv
2025-11-27 10:25:57,071 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102557.csv by branches...
2025-11-27 10:25:57,071 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:25:57,106 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:25:59,836 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102557_asherin.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102557_wardani.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102557_akba.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102557_shahid.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102557_nujum.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102557_admin.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.68 writes=0.30 total=2.77
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102557_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:01,635 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:26:02,239 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:26:02,824 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:26:03,406 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:26:04,007 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:26:04,584 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:26:04,584 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:26:04,981 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:27:48,077 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:50,581 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:27:51,989 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:53,314 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:27:53,314 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:27:54,357 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:27:54,358 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:27:54,358 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:54,359 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:27:54,359 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:27:54,359 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:27:54,360 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102754/output
2025-11-27 10:27:54,365 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:27:54,415 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:27:54,415 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102754
2025-11-27 10:27:54,416 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:27:54,416 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102754.zip...
2025-11-27 10:27:54,624 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102754.zip
2025-11-27 10:27:54,627 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:27:54,627 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:27:54,627 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:27:54,627 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:27:54,634 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:27:54,634 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,097 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:27:55,151 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:27:55
File: selled_stock_drug_only_20251127_102754.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:27:55,151 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:27:55,151 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:27:55,152 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102755.csv
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102755.csv
2025-11-27 10:27:55,195 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102755.csv by branches...
2025-11-27 10:27:55,195 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:27:55,229 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102755_asherin.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102755_wardani.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102755_akba.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102755_shahid.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102755_nujum.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102755_admin.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.03 allocation=0.18 surplus=1.69 writes=0.30 total=2.76
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:27:58,301 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102755_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:27:59,166 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:59,808 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:28:00,421 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:28:01,021 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:28:01,601 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:28:02,198 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:28:02,777 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:28:02,777 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:28:03,170 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:31:24,512 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:25,064 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:27,842 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:31:27,842 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:27,842 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:31:27,842 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:31:27,843 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:31:28,658 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:31:28,659 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:31:28,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:28,659 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_103128/output
2025-11-27 10:31:28,666 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_103128
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_103128.zip...
2025-11-27 10:31:28,907 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_103128.zip
2025-11-27 10:31:28,909 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.38 MB
2025-11-27 10:31:28,909 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:31:28,909 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:31:28,910 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:31:28,916 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:31:28,916 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:31:29
File: selled_stock_drug_only_20251127_103128.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:31:29,474 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_103129.csv
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_103129.csv
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_103129.csv by branches...
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:31:29,511 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_103129_asherin.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_103129_wardani.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_103129_akba.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_103129_shahid.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_103129_nujum.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_103129_admin.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.30 total=2.83
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_103129_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:34,130 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:31:34,781 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:31:35,405 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:31:36,014 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:31:36,653 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:31:37,270 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:31:37,271 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:40:49,387 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:55,304 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:40:56,776 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:41:00,106 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:41:00,110 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:41:01,113 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:41:01,114 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:41:01,114 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,115 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:41:01,115 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:41:01,116 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:41:01,116 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104101/output
2025-11-27 10:41:01,121 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104101
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104101.zip...
2025-11-27 10:41:01,389 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104101.zip
2025-11-27 10:41:01,391 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.38 MB
2025-11-27 10:41:01,391 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:41:01,391 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:41:01,392 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:41:01,398 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:41:01,398 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:41:01
File: selled_stock_drug_only_20251127_104101.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104101.csv
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104101.csv
2025-11-27 10:41:01,971 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104101.csv by branches...
2025-11-27 10:41:01,971 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:41:02,006 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:41:04,754 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104101_asherin.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104101_wardani.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104101_akba.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104101_shahid.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104101_nujum.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104101_admin.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.70 writes=0.30 total=2.78
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104101_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:06,611 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:41:07,224 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:41:07,814 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:41:08,416 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:41:09,002 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:41:09,598 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:41:09,599 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:10,009 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:41:10,009 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:41:10,634 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:41:10,643 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:22,863 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:44:23,923 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:44:23,923 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:27,526 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:44:27,529 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:27,529 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:44:27,530 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:44:27,530 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:44:28,478 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:44:28,478 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:44:28,479 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:28,479 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104428/output
2025-11-27 10:44:28,486 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104428
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104428.zip...
2025-11-27 10:44:28,756 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104428.zip
2025-11-27 10:44:28,758 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.53 MB
2025-11-27 10:44:28,758 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.32 MB (65.2% compression)
2025-11-27 10:44:28,758 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:44:28,759 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:44:28,765 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:44:28,765 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,277 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,277 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,278 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,278 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:44:29,286 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:44:29
File: selled_stock_drug_only_20251127_104428.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104429.csv
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104429.csv
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104429.csv by branches...
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:44:29,369 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104429_asherin.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104429_wardani.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104429_akba.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104429_shahid.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104429_nujum.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104429_admin.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.30 total=2.83
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:44:32,521 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104429_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:44:32,689 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:44:32,690 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:44:32,690 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:34,071 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:44:34,731 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:44:35,341 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:44:35,957 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:44:36,590 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:44:37,196 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:44:37,197 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:44:37,616 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:44:37,616 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:44:38,384 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:44:38,396 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:16,547 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:18,466 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:48:18,466 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:18,466 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:48:18,467 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:48:18,467 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,170 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:48:19,170 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:48:19,171 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:48:19,171 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104819/output
2025-11-27 10:48:19,176 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104819
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104819.zip...
2025-11-27 10:48:19,444 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104819.zip
2025-11-27 10:48:19,447 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.59 MB
2025-11-27 10:48:19,447 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.36 MB (65.0% compression)
2025-11-27 10:48:19,447 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:48:19,448 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:48:19,454 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:48:19,454 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,858 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:48:19,858 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:48:19,859 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:48:19,859 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,904 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:48:19
File: selled_stock_drug_only_20251127_104819.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104819.csv
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104819.csv
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104819.csv by branches...
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:48:20,014 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104819_asherin.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104819_wardani.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104819_akba.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104819_shahid.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104819_nujum.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104819_admin.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.32 total=2.92
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104819_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:24,708 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:48:25,343 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:48:25,970 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:48:26,596 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:48:27,227 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:48:27,846 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:48:27,846 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:28,290 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:48:28,290 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:48:28,979 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:48:28,990 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:31,352 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:31,352 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:32,138 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:34,682 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:48:34,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:34,682 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:48:34,683 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:48:34,683 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:48:35,304 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:48:35,305 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:48:35,305 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:35,306 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:48:35,306 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:48:35,307 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:48:35,307 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104835/output
2025-11-27 10:48:35,313 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104835
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104835.zip...
2025-11-27 10:48:35,580 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104835.zip
2025-11-27 10:48:35,582 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.59 MB
2025-11-27 10:48:35,582 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.36 MB (65.0% compression)
2025-11-27 10:48:35,582 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:48:35,583 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:48:35,589 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:48:35,589 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:48:35,589 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:35,590 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:48:35,590 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,106 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:48:36
File: selled_stock_drug_only_20251127_104835.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104836.csv
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104836.csv
2025-11-27 10:48:36,160 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104836.csv by branches...
2025-11-27 10:48:36,160 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:48:36,204 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104836_asherin.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104836_wardani.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104836_akba.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104836_shahid.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104836_nujum.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104836_admin.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.83 writes=0.31 total=3.00
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104836_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:41,027 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:48:41,693 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:48:42,290 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:48:42,900 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:48:43,512 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:48:44,132 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:48:44,133 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:48:45,178 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:48:45,187 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:18,879 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:18,884 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:19,293 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:51:20,720 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:22,529 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Shortage Files
2025-11-27 10:51:22,529 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-27 10:51:22,529 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:51:22,529 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:51:23,250 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:51:23,260 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:51:23,467 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:51:28,022 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:31,454 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:51:31,455 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:32,574 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_105132/output
2025-11-27 10:51:32,581 | INFO     | src.shared.utils.archiver |   Found 438 files in 98 directories
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_105132
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver |   - Archived 438 files in 98 directories
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_105132.zip...
2025-11-27 10:51:32,863 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_105132.zip
2025-11-27 10:51:32,865 | INFO     | src.app.pipeline.step_1.handler | Archive created: 438 files, 98 dirs | Size: 9.82 MB
2025-11-27 10:51:32,865 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.53 MB (64.1% compression)
2025-11-27 10:51:32,865 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:51:32,866 | INFO     | src.shared.utils.archiver |   Found 438 files in 98 directories to delete
2025-11-27 10:51:32,872 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:51:32,872 | INFO     | src.shared.utils.archiver |   ✓ Deleted 438 files and 98 directories
2025-11-27 10:51:32,872 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:32,873 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:51:32,873 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,322 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:51:33
File: selled_stock_drug_only_20251127_105132.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_105133.csv
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_105133.csv
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_105133.csv by branches...
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:51:33,420 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:51:36,414 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_105133_asherin.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_105133_wardani.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_105133_akba.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_105133_shahid.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_105133_nujum.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_105133_admin.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.86 writes=0.31 total=3.04
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_105133_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:51:36,793 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:51:36,794 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:51:36,794 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:51:36,958 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:38,326 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:51:38,971 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:51:39,588 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:51:40,201 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:51:40,816 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:51:41,426 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:51:41,427 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:51:41,843 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:51:42,574 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:51:42,584 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:16,260 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:17,179 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 11:14:18,292 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:21,435 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 11:14:21,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:21,436 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 11:14:21,436 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 11:14:21,437 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 11:14:22,459 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 11:14:22,459 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 11:14:22,460 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:22,460 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_111422/output
2025-11-27 11:14:22,467 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_111422
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_111422.zip...
2025-11-27 11:14:22,721 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_111422.zip
2025-11-27 11:14:22,723 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.60 MB
2025-11-27 11:14:22,723 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-11-27 11:14:22,723 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 11:14:22,724 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 11:14:22,731 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 11:14:22,731 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,181 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-11-27 11:14:23,181 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 11:14:23,182 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 11:14:23,182 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 11:14:23
File: selled_stock_drug_only_20251127_111422.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_111423.csv
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_111423.csv
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_111423.csv by branches...
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 11:14:23,320 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_111423_asherin.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_111423_wardani.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_111423_akba.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_111423_shahid.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_111423_nujum.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_111423_admin.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.71 writes=0.32 total=2.83
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_admin_to_akba.csv (8.7 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_111423_from_akba_to_admin.csv (114.0 B)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers/excel
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:27,934 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 11:14:28,577 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 11:14:29,152 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 11:14:29,729 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 11:14:30,308 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 11:14:30,889 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 11:14:30,889 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 11:14:31,978 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 11:14:31,987 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage/csv
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage/excel
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 16:43:00,437 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:07:02,770 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:12:02,391 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-02 22:12:02,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:12:02,391 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-02 22:12:02,391 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-02 22:12:02,392 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-02 22:12:03,831 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-02 22:12:03,832 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-02 22:12:03,832 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:03,832 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251202_221203/output
2025-12-02 22:12:03,834 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251202_221203
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 103 directories
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251202_221203.zip...
2025-12-02 22:12:04,078 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251202_221203.zip
2025-12-02 22:12:04,080 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 103 dirs | Size: 9.60 MB
2025-12-02 22:12:04,080 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-12-02 22:12:04,080 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-02 22:12:04,081 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories to delete
2025-12-02 22:12:04,086 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-02 22:12:04,086 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 103 directories
2025-12-02 22:12:04,086 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,087 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-12-02 22:12:04,087 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,602 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-02 22:12:04
File: selled_stock_drug_only_20251202_221204.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251202_221204.csv
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251202_221204.csv
2025-12-02 22:12:04,659 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251202_221204.csv by branches...
2025-12-02 22:12:04,659 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-02 22:12:04,709 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251202_221204_asherin.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251202_221204_wardani.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251202_221204_akba.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251202_221204_shahid.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251202_221204_nujum.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251202_221204_admin.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.19 surplus=1.68 writes=0.29 total=2.77
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-02 22:12:07,755 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_admin_to_akba.csv (8.7 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_admin_to_asherin.csv (8.1 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_admin_to_nujum.csv (5.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_admin_to_shahid.csv (10.2 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_admin_to_wardani.csv (5.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251202_221204_from_akba_to_admin.csv (114.0 B)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_akba_to_asherin.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_akba_to_nujum.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_akba_to_shahid.csv (3.2 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_akba_to_wardani.csv (2.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_asherin_to_akba.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_asherin_to_nujum.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_asherin_to_shahid.csv (4.0 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_asherin_to_wardani.csv (2.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_nujum_to_akba.csv (15.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_nujum_to_asherin.csv (12.4 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_nujum_to_shahid.csv (12.9 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_nujum_to_wardani.csv (7.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_shahid_to_akba.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_shahid_to_asherin.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_shahid_to_nujum.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_shahid_to_wardani.csv (2.9 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_wardani_to_akba.csv (6.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_wardani_to_asherin.csv (5.7 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_wardani_to_nujum.csv (6.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_wardani_to_shahid.csv (7.1 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-02 22:12:07,757 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-02 22:12:07,757 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Found 149 split CSV files to convert
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler | Generated 149 Excel files:
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:09,284 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-12-02 22:12:09,915 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-12-02 22:12:10,517 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-12-02 22:12:11,114 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-12-02 22:12:11,709 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-12-02 22:12:12,321 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-12-02 22:12:12,322 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-02 22:12:12,716 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-02 22:12:12,716 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-02 22:12:13,434 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-02 22:12:13,443 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:40:28,986 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:40:28,986 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:40:28,991 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:40:29,822 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-03 07:26:44,813 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:26:51,625 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Shortage Files
2025-12-03 07:26:51,625 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-12-03 07:26:51,626 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-03 07:26:51,626 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-03 07:26:52,341 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-03 07:26:52,351 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-03 07:26:52,584 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:08,530 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:12,579 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | Running steps 1 through 10 (Total: 10 steps)
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | [1/10] Executing: Archive Previous Output
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:12,580 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251203_073912/output
2025-12-03 07:39:12,581 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251203_073912
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 103 directories
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251203_073912.zip...
2025-12-03 07:39:12,816 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251203_073912.zip
2025-12-03 07:39:12,818 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 103 dirs | Size: 9.60 MB
2025-12-03 07:39:12,818 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-12-03 07:39:12,818 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-03 07:39:12,819 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories to delete
2025-12-03 07:39:12,825 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-03 07:39:12,825 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 103 directories
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | [2/10] Executing: Convert Excel to CSV
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector | Available Excel files:
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_all.xlsx
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector |   2. selled_stock_drug_only_20251115_073133.xlsx
2025-12-03 07:39:29,662 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | [3/10] Executing: Validate Data
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:37,634 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:37,635 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-03 07:39:37,637 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-12-03 07:39:37,638 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-12-03 07:39:37,638 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:37,690 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | [4/10] Executing: Sales Analysis
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:37,690 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:37,691 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:41,615 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:41,615 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-03 07:39:41
File: selled_stock_drug_only_20251203_073929.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | [5/10] Executing: Rename Columns
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:42,948 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:42,948 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251203_073942.csv
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | [6/10] Executing: Split by Branches
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_renamed_20251203_073942.csv
2025-12-03 07:39:43,849 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251203_073942.csv by branches...
2025-12-03 07:39:43,850 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-03 07:39:43,902 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-12-03 07:39:46,584 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251203_073943_asherin.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251203_073943_wardani.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251203_073943_akba.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251203_073943_shahid.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251203_073943_nujum.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251203_073943_admin.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.18 surplus=1.66 writes=0.28 total=2.73
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | [7/10] Executing: Generate Transfer Files
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_admin_to_akba.csv (8.7 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_admin_to_asherin.csv (8.1 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_admin_to_nujum.csv (5.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_admin_to_shahid.csv (10.2 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_admin_to_wardani.csv (5.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251203_073943_from_akba_to_admin.csv (114.0 B)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_akba_to_asherin.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_akba_to_nujum.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_akba_to_shahid.csv (3.2 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_akba_to_wardani.csv (2.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_asherin_to_akba.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_asherin_to_nujum.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_asherin_to_shahid.csv (4.0 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_asherin_to_wardani.csv (2.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_nujum_to_akba.csv (15.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_nujum_to_asherin.csv (12.4 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_nujum_to_shahid.csv (12.9 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_nujum_to_wardani.csv (7.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_shahid_to_akba.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_shahid_to_asherin.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_shahid_to_nujum.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_shahid_to_wardani.csv (2.9 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_wardani_to_akba.csv (6.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_wardani_to_asherin.csv (5.7 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_wardani_to_nujum.csv (6.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_wardani_to_shahid.csv (7.1 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | [8/10] Executing: Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-03 07:39:47,065 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-03 07:39:47,065 | INFO     | src.app.pipeline.step_8.handler | Found 149 split CSV files to convert
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler | Generated 149 Excel files:
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-03 07:39:47,742 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-03 07:39:47,742 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | [9/10] Executing: Generate Remaining Surplus Files
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:48,358 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-12-03 07:39:48,957 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-12-03 07:39:49,551 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-12-03 07:39:50,152 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-12-03 07:39:50,763 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-12-03 07:39:51,368 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-12-03 07:39:51,368 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | [10/10] Executing: Generate Shortage Files
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:51,758 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-03 07:39:51,758 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-03 07:39:52,457 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-03 07:39:52,466 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ SUCCESS: All 10 steps completed successfully!
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 09:04:10,215 | INFO     | src.app.cli.core.controller | Thank you for using the program!
