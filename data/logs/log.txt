2025-11-17 09:04:03,158 | INFO     | test | Data logs folder test
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:56,875 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:04:56,875 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:04:56,875 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:04:56,876 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:04:56,876 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:04:56,876 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:58,221 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:04:58,222 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:04:58,222 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:04:58,222 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:04:58,222 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:04:59,322 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:04:59,322 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_090459/output
2025-11-17 09:04:59,323 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_090459
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:04:59,358 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_090459.zip...
2025-11-17 09:04:59,567 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_090459.zip
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_090459
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:04:59,568 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_090459.zip
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:04:59,570 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:04:59,570 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:04:59,570 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:04:59,576 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:04:59,576 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:04:59,576 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:04:59,576 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:04:59,576 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:04:59,577 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:04:59,577 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,075 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,075 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:05:00,075 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:05:00,075 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,075 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:05:00,076 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,121 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:05:00,122 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:05:00,122 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,122 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:05:00,131 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:05:00
File: selled_stock_drug_only_20251117_090459.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:05:00,131 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:05:00,131 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,131 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_090459.csv
2025-11-17 09:05:00,132 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_090459.csv...
2025-11-17 09:05:00,132 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_090500.csv
2025-11-17 09:05:00,178 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:05:00,178 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:05:00,178 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_090500.csv
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_090500.csv by branches...
2025-11-17 09:05:00,178 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_090500_asherin.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_090500_wardani.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_090500_akba.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_090500_shahid.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_090500_nujum.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_090500_admin.csv
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:05:02,935 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:05:02,935 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:05:02,935 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:05:02,935 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_090500_from_asherin_to_wardani.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_090500_from_asherin_to_akba.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_090500_from_asherin_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_090500_from_asherin_to_nujum.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_090500_from_wardani_to_asherin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_090500_from_wardani_to_akba.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_090500_from_wardani_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_090500_from_wardani_to_nujum.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_090500_from_wardani_to_admin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_090500_from_akba_to_asherin.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_090500_from_akba_to_wardani.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_090500_from_akba_to_shahid.csv
2025-11-17 09:05:07,219 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_090500_from_akba_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_090500_from_akba_to_admin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_090500_from_shahid_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_090500_from_shahid_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_090500_from_shahid_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_090500_from_shahid_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_090500_from_nujum_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_090500_from_nujum_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_090500_from_nujum_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_090500_from_nujum_to_shahid.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_090500_from_nujum_to_admin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_090500_from_admin_to_asherin.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_090500_from_admin_to_wardani.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_090500_from_admin_to_akba.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_090500_from_admin_to_shahid.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_090500_from_admin_to_nujum.csv
2025-11-17 09:05:07,220 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:05:07,220 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:05:07,220 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:05:07,220 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:05:07,374 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:05:07,374 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:05:07,374 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:05:07,374 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:05:07,374 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:05:07,375 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:05:08,153 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:14:01,921 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:14:01,921 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:14:01,922 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:01,922 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:14:01,922 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:14:01,923 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:14:01,924 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:14:01,924 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:14:01,924 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:03,403 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:04,824 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:14:04,824 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:14:04,825 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:14:04,825 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:14:04,825 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:14:06,031 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:14:06,031 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:14:06,032 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:14:06,792 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:06,793 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:14:06,794 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:14:06,795 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_091406/output
2025-11-17 09:14:06,801 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_091406
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:14:06,848 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_091406.zip...
2025-11-17 09:14:07,068 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_091406.zip
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_091406
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:14:07,068 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_091406.zip
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:14:07,070 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:14:07,070 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:14:07,071 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:14:07,076 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:14:07,076 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:14:07,076 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:14:07,076 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:14:07,076 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,077 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:14:07,077 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,548 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,548 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:14:07,548 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:14:07,548 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:14:07,548 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:14:07,549 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,592 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:14:07,592 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:14:07,592 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,592 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,592 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,593 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:14:07,601 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:14:07
File: selled_stock_drug_only_20251117_091407.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:14:07,601 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:14:07,601 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_091407.csv
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_091407.csv...
2025-11-17 09:14:07,602 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:14:07,645 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:14:07,646 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_091407.csv
2025-11-17 09:14:07,646 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:14:07,646 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:14:07,646 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_091407.csv
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_091407.csv by branches...
2025-11-17 09:14:07,646 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_091407_asherin.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_091407_wardani.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_091407_akba.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_091407_shahid.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_091407_nujum.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_091407_admin.csv
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:14:10,362 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:14:10,362 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:14:10,362 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:14:10,363 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_091407_from_asherin_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_091407_from_asherin_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_091407_from_asherin_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_091407_from_asherin_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_091407_from_wardani_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_091407_from_wardani_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_091407_from_wardani_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_091407_from_wardani_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_091407_from_wardani_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_091407_from_akba_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_091407_from_akba_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_091407_from_akba_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_091407_from_akba_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_091407_from_akba_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_091407_from_shahid_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_091407_from_shahid_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_091407_from_shahid_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_091407_from_shahid_to_nujum.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_091407_from_nujum_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_091407_from_nujum_to_wardani.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_091407_from_nujum_to_akba.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_091407_from_nujum_to_shahid.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_091407_from_nujum_to_admin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_091407_from_admin_to_asherin.csv
2025-11-17 09:14:10,779 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_091407_from_admin_to_wardani.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_091407_from_admin_to_akba.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_091407_from_admin_to_shahid.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_091407_from_admin_to_nujum.csv
2025-11-17 09:14:10,780 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:14:10,780 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:14:10,780 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:14:10,780 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:14:10,922 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:14:10,922 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:14:10,922 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:14:10,923 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:14:11,685 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:14:11,686 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:15:20,090 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:15:20,091 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:15:20,091 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:20,092 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:15:20,092 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:15:20,093 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:15:20,094 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:15:20,095 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:15:20,095 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:15:20,095 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:21,070 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:15:22,699 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:22,702 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:15:22,702 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:15:22,703 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:15:22,703 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:15:22,703 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:15:23,836 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:15:23,836 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:15:23,836 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:15:24,333 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:15:24,333 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:15:24,334 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,334 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:15:24,335 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:15:24,336 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_091524/output
2025-11-17 09:15:24,338 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_091524
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:15:24,384 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_091524.zip...
2025-11-17 09:15:24,584 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_091524.zip
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_091524
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:15:24,584 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_091524.zip
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:15:24,586 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:15:24,586 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:15:24,587 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:15:24,592 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:15:24,592 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:15:24,592 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:15:24,592 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:15:24,592 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:24,592 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:15:24,592 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,051 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,051 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:15:25,051 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:15:25,051 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,051 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:15:25,052 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,096 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:15:25,096 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:15:25,096 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,096 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:15:25,105 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:15:25
File: selled_stock_drug_only_20251117_091524.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:15:25,105 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:15:25,106 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_091524.csv
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_091524.csv...
2025-11-17 09:15:25,106 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_091525.csv
2025-11-17 09:15:25,149 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:15:25,149 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:15:25,149 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_091525.csv
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_091525.csv by branches...
2025-11-17 09:15:25,150 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_091525_asherin.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_091525_wardani.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_091525_akba.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_091525_shahid.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_091525_nujum.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_091525_admin.csv
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:15:27,824 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:15:27,824 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:15:27,824 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:15:27,824 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_091525_from_asherin_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_091525_from_asherin_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_091525_from_asherin_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_091525_from_asherin_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_091525_from_wardani_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_091525_from_wardani_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_091525_from_wardani_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_091525_from_wardani_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_091525_from_wardani_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_091525_from_akba_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_091525_from_akba_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_091525_from_akba_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_091525_from_akba_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_091525_from_akba_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_091525_from_shahid_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_091525_from_shahid_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_091525_from_shahid_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_091525_from_shahid_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_091525_from_nujum_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_091525_from_nujum_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_091525_from_nujum_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_091525_from_nujum_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_091525_from_nujum_to_admin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_091525_from_admin_to_asherin.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_091525_from_admin_to_wardani.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_091525_from_admin_to_akba.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_091525_from_admin_to_shahid.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_091525_from_admin_to_nujum.csv
2025-11-17 09:15:28,240 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:15:28,240 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:15:28,240 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:15:28,241 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:15:28,384 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:15:28,385 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:15:28,385 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:15:28,385 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:15:28,385 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:15:29,117 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:15:29,117 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:15:29,118 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:05,435 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:22:05,435 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:22:05,436 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:22:05,436 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:22:05,436 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:06,091 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
==================================================
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 09:22:07,817 | INFO     | src.cli.menu |   0. Exit
2025-11-17 09:22:07,817 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:11,050 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 09:22:11,050 | INFO     | src.cli.menu | ==================================================
2025-11-17 09:22:11,051 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 09:22:11,051 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 09:22:11,051 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 09:22:12,218 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 09:22:12,218 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 09:22:12,219 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_092212/output
2025-11-17 09:22:12,219 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_092212
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 09:22:12,235 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_092212.zip...
2025-11-17 09:22:12,439 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_092212.zip
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_092212
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 09:22:12,439 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_092212.zip
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 09:22:12,441 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 09:22:12,441 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 09:22:12,442 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 09:22:12,448 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 09:22:12,448 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 09:22:12,448 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 09:22:12,448 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 09:22:12,448 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,448 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 09:22:12,448 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,933 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,933 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 09:22:12,934 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 09:22:12,934 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 09:22:12,934 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,988 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 09:22:12,988 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 09:22:12,988 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:12,989 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 09:22:13,000 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 09:22:13
File: selled_stock_drug_only_20251117_092212.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 09:22:13,001 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 09:22:13,001 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_092212.csv
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_092212.csv...
2025-11-17 09:22:13,001 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_092213.csv
2025-11-17 09:22:13,051 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 09:22:13,051 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 09:22:13,052 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_092213.csv
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_092213.csv by branches...
2025-11-17 09:22:13,052 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_092213_asherin.csv
2025-11-17 09:22:14,948 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_092213_wardani.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_092213_akba.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_092213_shahid.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_092213_nujum.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_092213_admin.csv
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.10 surplus=0.73 writes=0.38 total=1.90
2025-11-17 09:22:14,949 | INFO     | src.config.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 09:22:14,949 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 09:22:14,949 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 09:22:14,949 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_092213_from_asherin_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_092213_from_asherin_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_092213_from_asherin_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_092213_from_asherin_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_092213_from_wardani_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_092213_from_wardani_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_092213_from_wardani_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_092213_from_wardani_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_092213_from_wardani_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_092213_from_akba_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_092213_from_akba_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_092213_from_akba_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_092213_from_akba_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_092213_from_akba_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_092213_from_shahid_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_092213_from_shahid_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_092213_from_shahid_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_092213_from_shahid_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_092213_from_nujum_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_092213_from_nujum_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_092213_from_nujum_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_092213_from_nujum_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_092213_from_nujum_to_admin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_092213_from_admin_to_asherin.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_092213_from_admin_to_wardani.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_092213_from_admin_to_akba.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_092213_from_admin_to_shahid.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_092213_from_admin_to_nujum.csv
2025-11-17 09:22:15,345 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 09:22:15,345 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 09:22:15,345 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 09:22:15,346 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 09:22:15,495 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 09:22:15,495 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 09:22:15,495 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 09:22:15,496 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 09:22:16,263 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | 
==================================================
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:42:59,110 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 10:42:59,110 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 10:42:59,111 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 10:42:59,111 | INFO     | src.cli.menu |   0. Exit
2025-11-17 10:42:59,111 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | Executing all steps...
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | ==================================================
2025-11-17 10:43:01,905 | INFO     | src.cli.menu | Select file option for all steps:
2025-11-17 10:43:01,905 | INFO     | src.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 10:43:01,906 | INFO     | src.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 10:43:05,063 | INFO     | src.cli.menu | Using latest file for all steps...
2025-11-17 10:43:05,064 | INFO     | src.cli.menu | [1] Archive Previous Output
2025-11-17 10:43:05,064 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | Archiving ALL previous output files...
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All analytics files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All branch files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All converted files
2025-11-17 10:43:05,065 | INFO     | src.config.step_1_handler |   - All renamed files
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - All transfer files (CSV)
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - All transfer Excel files
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler |   - Complete directory structure
2025-11-17 10:43:05,066 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver | Archiving complete contents of data/output...
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver |   Source: data/output
2025-11-17 10:43:05,067 | INFO     | src.utils.archiver |   Destination: data/archive/archive_20251117_104305/output
2025-11-17 10:43:05,072 | INFO     | src.utils.archiver |   Found 348 files in 86 directories
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver | Archive created successfully!
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver |   - Archive location: data/archive/archive_20251117_104305
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 10:43:05,129 | INFO     | src.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_104305.zip...
2025-11-17 10:43:05,338 | INFO     | src.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_104305.zip
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | Archive Summary:
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Archive directory: data/archive/archive_20251117_104305
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Total files archived: 348
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - Total directories archived: 86
2025-11-17 10:43:05,338 | INFO     | src.config.step_1_handler |   - ZIP file: data/archive/archive_20251117_104305.zip
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | Archive Statistics:
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | Clearing output directory to start fresh...
2025-11-17 10:43:05,340 | INFO     | src.config.step_1_handler | --------------------------------------------------
2025-11-17 10:43:05,340 | INFO     | src.utils.archiver | Clearing output directory: data/output...
2025-11-17 10:43:05,341 | INFO     | src.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 10:43:05,347 | INFO     | src.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 10:43:05,347 | INFO     | src.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 10:43:05,347 | INFO     | src.config.step_1_handler | ==================================================
2025-11-17 10:43:05,347 | INFO     | src.cli.menu | [2] Convert Excel to CSV
2025-11-17 10:43:05,347 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,347 | INFO     | src.config.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 10:43:05,348 | INFO     | src.config.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,824 | INFO     | src.config.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,824 | INFO     | src.config.step_2_handler | Saved to: data/output/converted
2025-11-17 10:43:05,824 | INFO     | src.cli.menu | [3] Validate Data
2025-11-17 10:43:05,824 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | Validating selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | --------------------------------------------------
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 10:43:05,824 | INFO     | src.config.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler |     ✓ All column headers match expected order
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | ==================================================
2025-11-17 10:43:05,825 | INFO     | src.config.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,867 | INFO     | src.config.step_3_handler | ✓ First row removed successfully
2025-11-17 10:43:05,867 | INFO     | src.cli.menu | [4] Sales Analysis
2025-11-17 10:43:05,867 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,867 | INFO     | src.config.step_4_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,868 | INFO     | src.config.step_4_handler | Analyzing selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,868 | INFO     | src.config.step_4_handler | --------------------------------------------------
2025-11-17 10:43:05,880 | INFO     | src.config.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 10:43:05
File: selled_stock_drug_only_20251117_104305.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 10:43:05,880 | INFO     | src.cli.menu | [5] Rename Columns
2025-11-17 10:43:05,880 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,880 | INFO     | src.config.step_5_handler | Using latest file: selled_stock_drug_only_20251117_104305.csv
2025-11-17 10:43:05,881 | INFO     | src.config.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_104305.csv...
2025-11-17 10:43:05,881 | INFO     | src.config.step_5_handler | --------------------------------------------------
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Columns renamed successfully!
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_104305.csv
2025-11-17 10:43:05,939 | INFO     | src.config.step_5_handler | Saved to: data/output/renamed
2025-11-17 10:43:05,939 | INFO     | src.cli.menu | [6] Split by Branches
2025-11-17 10:43:05,939 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_104305.csv
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_104305.csv by branches...
2025-11-17 10:43:05,939 | INFO     | src.config.step_6_handler | --------------------------------------------------
2025-11-17 10:43:05,985 | INFO     | src.splitters.processors.data_preparer | Prepared branch data | rows=4603 cols=25 branches=6 read_time_ms=7.2
2025-11-17 10:43:07,794 | INFO     | src.config.step_6_handler | File split successfully into 6 branch files:
2025-11-17 10:43:07,794 | INFO     | src.config.step_6_handler |   - asherin: selled_stock_drug_only_20251117_104305_asherin.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - wardani: selled_stock_drug_only_20251117_104305_wardani.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - akba: selled_stock_drug_only_20251117_104305_akba.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - shahid: selled_stock_drug_only_20251117_104305_shahid.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - nujum: selled_stock_drug_only_20251117_104305_nujum.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler |   - admin: selled_stock_drug_only_20251117_104305_admin.csv
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.10 surplus=0.72 writes=0.38 total=1.86
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Surplus metrics: products_with_need=4995 withdrawals=4742 checks=4742 max_withdrawals_per_product=5
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Branch files written: 6 files totaling 4.06 MB
2025-11-17 10:43:07,795 | INFO     | src.config.step_6_handler | Analytics files written: 6 files totaling 3.19 MB
2025-11-17 10:43:07,795 | INFO     | src.cli.menu | [7] Generate Transfer Files
2025-11-17 10:43:07,795 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | Generating transfer files...
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | --------------------------------------------------
2025-11-17 10:43:07,795 | INFO     | src.config.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 10:43:08,187 | INFO     | src.config.step_7_handler | Generated 28 transfer files:
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_104305_from_asherin_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_104305_from_asherin_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_104305_from_asherin_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_104305_from_asherin_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_104305_from_wardani_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_104305_from_wardani_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_104305_from_wardani_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_104305_from_wardani_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_104305_from_wardani_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_104305_from_akba_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_104305_from_akba_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_104305_from_akba_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_104305_from_akba_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_104305_from_akba_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_104305_from_shahid_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_104305_from_shahid_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_104305_from_shahid_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_104305_from_shahid_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_104305_from_nujum_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_104305_from_nujum_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_104305_from_nujum_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_104305_from_nujum_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_104305_from_nujum_to_admin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_104305_from_admin_to_asherin.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_104305_from_admin_to_wardani.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_104305_from_admin_to_akba.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_104305_from_admin_to_shahid.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_104305_from_admin_to_nujum.csv
2025-11-17 10:43:08,188 | INFO     | src.config.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 10:43:08,188 | INFO     | src.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 10:43:08,188 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | Splitting transfer files by product type...
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | --------------------------------------------------
2025-11-17 10:43:08,188 | INFO     | src.config.step_8_handler | Found 28 transfer files to split
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler | Generated 153 split files:
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - injections: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - syrups: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - creams: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - sachets: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler |   - other: 25 files
2025-11-17 10:43:08,348 | INFO     | src.config.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 10:43:08,348 | INFO     | src.cli.menu | [9] Convert Split Files to Excel
2025-11-17 10:43:08,348 | INFO     | src.cli.menu | --------------------------------------------------
2025-11-17 10:43:08,348 | INFO     | src.config.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 10:43:08,348 | INFO     | src.config.step_9_handler | --------------------------------------------------
2025-11-17 10:43:08,349 | INFO     | src.config.step_9_handler | Found 153 split CSV files to convert
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler | Generated 153 Excel files:
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - injections: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - syrups: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - creams: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - sachets: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler |   - other: 25 files
2025-11-17 10:43:09,095 | INFO     | src.config.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 11:19:06,449 | INFO     | src.cli.menu | 
==================================================
2025-11-17 11:19:06,449 | INFO     | src.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:19:06,450 | INFO     | src.cli.menu | ==================================================
2025-11-17 11:19:06,450 | INFO     | src.cli.menu | 
Available steps:
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   1. Archive Previous Output
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   3. Validate Data
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:19:06,450 | INFO     | src.cli.menu |   4. Sales Analysis
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   5. Rename Columns
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   6. Split by Branches
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   7. Generate Transfer Files
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:19:06,451 | INFO     | src.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:19:06,452 | INFO     | src.cli.menu | 
  10. Execute all steps
2025-11-17 11:19:06,452 | INFO     | src.cli.menu |   0. Exit
2025-11-17 11:19:06,452 | INFO     | src.cli.menu | ==================================================
2025-11-17 11:19:07,971 | INFO     | src.cli.menu | Thank you for using the program!
2025-11-17 11:19:09,798 | INFO     | src.app.cli.menu | 
==================================================
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu |   0. Exit
2025-11-17 11:19:09,799 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:11,543 | INFO     | src.app.cli.menu | Executing all steps...
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu | Select file option for all steps:
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu |   1. Select specific file (will ask for each step)
2025-11-17 11:19:11,544 | INFO     | src.app.cli.menu |   2. Use latest file (applies to all steps)
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | Using latest file for all steps...
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | [1] Archive Previous Output
2025-11-17 11:19:12,483 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-17 11:19:12,483 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251117_111912/output
2025-11-17 11:19:12,484 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251117_111912
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-17 11:19:12,517 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251117_111912.zip...
2025-11-17 11:19:12,718 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251117_111912.zip
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251117_111912
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-17 11:19:12,718 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251117_111912.zip
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-17 11:19:12,720 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-17 11:19:12,720 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-17 11:19:12,721 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-17 11:19:12,727 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-17 11:19:12,727 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-17 11:19:12,727 | INFO     | src.app.cli.menu | [2] Convert Excel to CSV
2025-11-17 11:19:12,727 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-17 11:19:12,727 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,183 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,183 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-17 11:19:13,184 | INFO     | src.app.cli.menu | [3] Validate Data
2025-11-17 11:19:13,184 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-17 11:19:13,184 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,228 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-17 11:19:13,228 | INFO     | src.app.cli.menu | [4] Sales Analysis
2025-11-17 11:19:13,228 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,228 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,229 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,229 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-17 11:19:13
File: selled_stock_drug_only_20251117_111912.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-17 11:19:13,238 | INFO     | src.app.cli.menu | [5] Rename Columns
2025-11-17 11:19:13,238 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251117_111912.csv
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251117_111912.csv...
2025-11-17 11:19:13,238 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-17 11:19:13,281 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-17 11:19:13,281 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251117_111913.csv
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-17 11:19:13,282 | INFO     | src.app.cli.menu | [6] Split by Branches
2025-11-17 11:19:13,282 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251117_111913.csv
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251117_111913.csv by branches...
2025-11-17 11:19:13,282 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251117_111913_asherin.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251117_111913_wardani.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251117_111913_akba.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251117_111913_shahid.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251117_111913_nujum.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251117_111913_admin.csv
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.09 surplus=0.73 writes=0.38 total=1.89
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-17 11:19:15,168 | INFO     | src.app.cli.menu | [7] Generate Transfer Files
2025-11-17 11:19:15,168 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-17 11:19:15,168 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251117_111913_from_asherin_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251117_111913_from_asherin_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251117_111913_from_asherin_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251117_111913_from_asherin_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251117_111913_from_wardani_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251117_111913_from_wardani_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251117_111913_from_wardani_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251117_111913_from_wardani_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251117_111913_from_wardani_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251117_111913_from_akba_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251117_111913_from_akba_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251117_111913_from_akba_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251117_111913_from_akba_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251117_111913_from_akba_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251117_111913_from_shahid_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251117_111913_from_shahid_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251117_111913_from_shahid_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251117_111913_from_shahid_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251117_111913_from_nujum_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251117_111913_from_nujum_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251117_111913_from_nujum_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251117_111913_from_nujum_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251117_111913_from_nujum_to_admin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251117_111913_from_admin_to_asherin.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251117_111913_from_admin_to_wardani.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251117_111913_from_admin_to_akba.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251117_111913_from_admin_to_shahid.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251117_111913_from_admin_to_nujum.csv
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-17 11:19:15,568 | INFO     | src.app.cli.menu | [8] Split Transfer Files by Product Type
2025-11-17 11:19:15,568 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-17 11:19:15,568 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-17 11:19:15,711 | INFO     | src.app.cli.menu | [9] Convert Split Files to Excel
2025-11-17 11:19:15,711 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-17 11:19:15,711 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-17 11:19:15,712 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-17 11:19:15,712 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-17 11:19:16,493 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-17 11:30:48,187 | INFO     | src.app.cli.menu | 
==================================================
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-17 11:30:48,188 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-17 11:30:48,189 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu |   0. Exit
2025-11-17 11:30:48,190 | INFO     | src.app.cli.menu | ==================================================
2025-11-17 11:30:49,859 | INFO     | src.app.cli.menu | Thank you for using the program!
2025-11-18 10:07:15,718 | INFO     | src.app.cli.menu | 
==================================================
2025-11-18 10:07:15,718 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu |   0. Exit
2025-11-18 10:07:15,719 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | Executing all steps...
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu | Select file option for all steps:
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu |   1. Select specific file (will ask for each step)
2025-11-18 10:07:19,796 | INFO     | src.app.cli.menu |   2. Use latest file (applies to all steps)
2025-11-18 10:07:21,088 | INFO     | src.app.cli.menu | Using latest file for all steps...
2025-11-18 10:07:21,089 | INFO     | src.app.cli.menu | [1/9] 1 - Archive Previous Output
2025-11-18 10:07:21,089 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,090 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-18 10:07:21,091 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-18 10:07:21,092 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,092 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-18 10:07:21,092 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-18 10:07:21,093 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251118_100721/output
2025-11-18 10:07:21,098 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251118_100721
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-18 10:07:21,171 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251118_100721.zip...
2025-11-18 10:07:21,376 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251118_100721.zip
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251118_100721
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-18 10:07:21,376 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251118_100721.zip
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-18 10:07:21,378 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-18 10:07:21,378 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-18 10:07:21,379 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-18 10:07:21,384 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-18 10:07:21,384 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-18 10:07:21,384 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | ✓ Step 1 completed successfully
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | [2/9] 2 - Convert Excel to CSV
2025-11-18 10:07:21,384 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,385 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-18 10:07:21,385 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | ✓ Step 2 completed successfully
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | [3/9] 3 - Validate Data
2025-11-18 10:07:21,881 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,881 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:07:21,882 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | ✓ Step 3 completed successfully
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | [4/9] 4 - Sales Analysis
2025-11-18 10:07:21,929 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,929 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-18 10:07:21
File: selled_stock_drug_only_20251118_100721.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | ✓ Step 4 completed successfully
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | [5/9] 5 - Rename Columns
2025-11-18 10:07:21,939 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251118_100721.csv
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251118_100721.csv...
2025-11-18 10:07:21,939 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251118_100721.csv
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | ✓ Step 5 completed successfully
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | [6/9] 6 - Split by Branches
2025-11-18 10:07:21,984 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251118_100721.csv
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251118_100721.csv by branches...
2025-11-18 10:07:21,984 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251118_100721_asherin.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251118_100721_wardani.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251118_100721_akba.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251118_100721_shahid.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251118_100721_nujum.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251118_100721_admin.csv
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.09 surplus=0.69 writes=0.38 total=1.79
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | ✓ Step 6 completed successfully
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | [7/9] 7 - Generate Transfer Files
2025-11-18 10:07:23,779 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-18 10:07:23,779 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-18 10:07:24,183 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251118_100721_from_asherin_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251118_100721_from_asherin_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251118_100721_from_asherin_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251118_100721_from_asherin_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251118_100721_from_wardani_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251118_100721_from_wardani_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251118_100721_from_wardani_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251118_100721_from_wardani_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251118_100721_from_wardani_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251118_100721_from_akba_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251118_100721_from_akba_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251118_100721_from_akba_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251118_100721_from_akba_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251118_100721_from_akba_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251118_100721_from_shahid_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251118_100721_from_shahid_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251118_100721_from_shahid_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251118_100721_from_shahid_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251118_100721_from_nujum_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251118_100721_from_nujum_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251118_100721_from_nujum_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251118_100721_from_nujum_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251118_100721_from_nujum_to_admin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251118_100721_from_admin_to_asherin.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251118_100721_from_admin_to_wardani.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251118_100721_from_admin_to_akba.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251118_100721_from_admin_to_shahid.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251118_100721_from_admin_to_nujum.csv
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | ✓ Step 7 completed successfully
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | [8/9] 8 - Split Transfer Files by Product Type
2025-11-18 10:07:24,184 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-18 10:07:24,184 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-18 10:07:24,331 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | ✓ Step 8 completed successfully
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | [9/9] 9 - Convert Split Files to Excel
2025-11-18 10:07:24,331 | INFO     | src.app.cli.menu | --------------------------------------------------
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-18 10:07:24,332 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-18 10:07:25,089 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-18 10:07:25,090 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ✓ Step 9 completed successfully
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | Execution Summary:
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Total steps: 9
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Successful: 9
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Failed: 0
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu |   Success rate: 100.0%
2025-11-18 10:07:25,090 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:16,580 | INFO     | src.app.cli.menu | 
==================================================
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | Project Menu - Distribution of Goods
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | 
Available steps:
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   1. Archive Previous Output
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   2. Convert Excel to CSV
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Convert selected Excel file from input folder to CSV
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   3. Validate Data
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   4. Sales Analysis
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   5. Rename Columns
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Rename CSV columns from Arabic to English
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   6. Split by Branches
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   7. Generate Transfer Files
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   8. Split Transfer Files by Product Type
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   9. Convert Split Files to Excel
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | 
  10. Execute all steps
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu |   0. Exit
2025-11-18 10:25:16,581 | INFO     | src.app.cli.menu | ==================================================
2025-11-18 10:25:17,946 | INFO     | src.app.cli.menu | Thank you for using the program!
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-18 10:25:19,356 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-18 10:25:19,357 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-18 10:25:22,433 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-18 10:25:22,434 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-18 10:25:22,434 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-18 10:25:22,434 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-18 10:25:22,435 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-18 10:25:23,292 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | Archiving ALL previous output files...
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler | This will archive the complete contents of the output directory:
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All analytics files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All branch files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All converted files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All renamed files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All transfer files (CSV)
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - All transfer Excel files
2025-11-18 10:25:23,292 | INFO     | src.app.pipeline.step_1_handler |   - Complete directory structure
2025-11-18 10:25:23,293 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251118_102523/output
2025-11-18 10:25:23,293 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251118_102523
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-18 10:25:23,326 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251118_102523.zip...
2025-11-18 10:25:23,538 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251118_102523.zip
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | Archive Summary:
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Archive directory: data/archive/archive_20251118_102523
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Total files archived: 348
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - Total directories archived: 86
2025-11-18 10:25:23,538 | INFO     | src.app.pipeline.step_1_handler |   - ZIP file: data/archive/archive_20251118_102523.zip
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | Archive Statistics:
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - Archive size: 9.76 MB
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - ZIP size: 2.77 MB
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler |   - Compression ratio: 71.6%
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ✓ All previous output files have been archived successfully!
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | Clearing output directory to start fresh...
2025-11-18 10:25:23,540 | INFO     | src.app.pipeline.step_1_handler | --------------------------------------------------
2025-11-18 10:25:23,540 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-18 10:25:23,541 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-18 10:25:23,547 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-18 10:25:23,547 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-18 10:25:23,547 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,547 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully!
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_1_handler | ✓ Ready to start new process with clean output directory.
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_1_handler | ==================================================
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-18 10:25:23,548 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-18 10:25:23,548 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-18 10:25:23,995 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-18 10:25:23,995 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-18 10:25:23,996 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-18 10:25:24,038 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,038 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-18 10:25:24,047 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-18 10:25:24
File: selled_stock_drug_only_20251118_102523.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-18 10:25:24,047 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,047 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251118_102523.csv
2025-11-18 10:25:24,048 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251118_102523.csv...
2025-11-18 10:25:24,048 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251118_102524.csv
2025-11-18 10:25:24,090 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-18 10:25:24,090 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-18 10:25:24,091 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-18 10:25:24,091 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251118_102524.csv
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251118_102524.csv by branches...
2025-11-18 10:25:24,091 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251118_102524_asherin.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251118_102524_wardani.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251118_102524_akba.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251118_102524_shahid.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251118_102524_nujum.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251118_102524_admin.csv
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.38 total=1.79
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-18 10:25:25,885 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:25,885 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-18 10:25:25,886 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-18 10:25:25,886 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251118_102524_from_asherin_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251118_102524_from_asherin_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251118_102524_from_asherin_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251118_102524_from_asherin_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251118_102524_from_wardani_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251118_102524_from_wardani_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251118_102524_from_wardani_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251118_102524_from_wardani_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251118_102524_from_wardani_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251118_102524_from_akba_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251118_102524_from_akba_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251118_102524_from_akba_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251118_102524_from_akba_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251118_102524_from_akba_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251118_102524_from_shahid_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251118_102524_from_shahid_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251118_102524_from_shahid_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251118_102524_from_shahid_to_nujum.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251118_102524_from_nujum_to_asherin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251118_102524_from_nujum_to_wardani.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251118_102524_from_nujum_to_akba.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251118_102524_from_nujum_to_shahid.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251118_102524_from_nujum_to_admin.csv
2025-11-18 10:25:26,281 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251118_102524_from_admin_to_asherin.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251118_102524_from_admin_to_wardani.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251118_102524_from_admin_to_akba.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251118_102524_from_admin_to_shahid.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251118_102524_from_admin_to_nujum.csv
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-18 10:25:26,282 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-18 10:25:26,282 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-18 10:25:26,426 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-18 10:25:26,426 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-18 10:25:26,427 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-18 10:25:27,178 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-18 10:25:27,178 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:17:05,917 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:17:11,369 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 07:17:11,370 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 07:17:11,370 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 07:17:12,561 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:12,562 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 07:17:12,562 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 07:17:12,563 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 07:17:12,563 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_071712/output
2025-11-22 07:17:12,567 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_071712
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 07:17:12,604 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_071712.zip...
2025-11-22 07:17:12,810 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_071712.zip
2025-11-22 07:17:12,812 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 07:17:12,812 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 07:17:12,812 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 07:17:12,813 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 07:17:12,818 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 07:17:12,818 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 07:17:12,818 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 07:17:12,818 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:12,818 | INFO     | src.app.pipeline.step_2_handler | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 07:17:12,819 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted/selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_2_handler | Saved to: data/output/converted
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 07:17:13,324 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 07:17:13,324 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:17:13,325 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 07:17:13,371 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,371 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 07:17:13,380 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 07:17:13
File: selled_stock_drug_only_20251122_071712.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 07:17:13,380 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 07:17:13,380 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 07:17:13,381 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | Using latest file: selled_stock_drug_only_20251122_071712.csv
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_071712.csv...
2025-11-22 07:17:13,381 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_071713.csv
2025-11-22 07:17:13,424 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 07:17:13,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | Using latest file: selled_stock_drug_only_renamed_20251122_071713.csv
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_071713.csv by branches...
2025-11-22 07:17:13,425 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_071713_asherin.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_071713_wardani.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_071713_akba.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_071713_shahid.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_071713_nujum.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_071713_admin.csv
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.06 allocation=0.09 surplus=0.70 writes=0.37 total=1.79
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 07:17:15,217 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 07:17:15,217 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_071713_from_asherin_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_071713_from_asherin_to_akba.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_071713_from_asherin_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_071713_from_asherin_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_071713_from_wardani_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_071713_from_wardani_to_akba.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_071713_from_wardani_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_071713_from_wardani_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_071713_from_wardani_to_admin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_071713_from_akba_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_071713_from_akba_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_071713_from_akba_to_shahid.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_071713_from_akba_to_nujum.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_071713_from_akba_to_admin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_071713_from_shahid_to_asherin.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_071713_from_shahid_to_wardani.csv
2025-11-22 07:17:15,604 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_071713_from_shahid_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_071713_from_shahid_to_nujum.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_071713_from_nujum_to_asherin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_071713_from_nujum_to_wardani.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_071713_from_nujum_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_071713_from_nujum_to_shahid.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_071713_from_nujum_to_admin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_071713_from_admin_to_asherin.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_071713_from_admin_to_wardani.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_071713_from_admin_to_akba.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_071713_from_admin_to_shahid.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_071713_from_admin_to_nujum.csv
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 07:17:15,605 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 07:17:15,605 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 07:17:15,761 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 07:17:15,761 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 07:17:15,762 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 07:17:16,477 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 07:17:16,477 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:30:52,318 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:52,319 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:52,320 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:52,321 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:52,950 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:54,861 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:54,862 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:54,863 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:54,864 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:55,893 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-22 07:30:58,068 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 07:30:58,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 07:30:59,534 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 07:30:59,534 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 07:30:59,534 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 07:31:01,118 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 07:31:01,118 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 07:31:01,119 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,119 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 07:31:01,120 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 07:31:01,120 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 07:31:01,121 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_073101/output
2025-11-22 07:31:01,125 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_073101
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 07:31:01,178 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_073101.zip...
2025-11-22 07:31:01,374 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_073101.zip
2025-11-22 07:31:01,376 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 07:31:01,376 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 07:31:01,376 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 07:31:01,377 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 07:31:01,382 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 07:31:01,382 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 07:31:01,382 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 07:31:01,382 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,382 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 07:31:01,383 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 07:31:01,830 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 07:31:01,830 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 07:31:01,831 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,874 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 07:31:01,875 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,875 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 07:31:01
File: selled_stock_drug_only_20251122_073101.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 07:31:01,884 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_073101.csv
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_073101.csv...
2025-11-22 07:31:01,884 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_073101.csv
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 07:31:01,927 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251122_073101.csv
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_073101.csv by branches...
2025-11-22 07:31:01,927 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_073101_asherin.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_073101_wardani.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_073101_akba.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_073101_shahid.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_073101_nujum.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_073101_admin.csv
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 07:31:03,674 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.37 total=1.75
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 07:31:03,675 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 07:31:03,675 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_073101_from_asherin_to_wardani.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_073101_from_asherin_to_akba.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_073101_from_asherin_to_shahid.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_073101_from_asherin_to_nujum.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_073101_from_wardani_to_asherin.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_073101_from_wardani_to_akba.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_073101_from_wardani_to_shahid.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_073101_from_wardani_to_nujum.csv
2025-11-22 07:31:04,061 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_073101_from_wardani_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_073101_from_akba_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_073101_from_akba_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_073101_from_akba_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_073101_from_akba_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_073101_from_akba_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_073101_from_shahid_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_073101_from_shahid_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_073101_from_shahid_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_073101_from_shahid_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_073101_from_nujum_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_073101_from_nujum_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_073101_from_nujum_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_073101_from_nujum_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_073101_from_nujum_to_admin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_073101_from_admin_to_asherin.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_073101_from_admin_to_wardani.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_073101_from_admin_to_akba.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_073101_from_admin_to_shahid.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_073101_from_admin_to_nujum.csv
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 07:31:04,062 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 07:31:04,062 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:31:04,204 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 07:31:04,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 07:31:04,205 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 07:31:04,915 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 07:31:04,915 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:27,464 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 10:35:27,464 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 10:35:27,465 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 10:35:27,466 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 10:35:27,467 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 10:35:27,468 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 10:35:27,469 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:27,870 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-22 10:35:30,634 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-22 10:35:30,635 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-22 10:35:32,670 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-22 10:35:32,670 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:32,670 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-22 10:35:32,670 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-22 10:35:32,671 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-22 10:35:33,653 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-22 10:35:33,653 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-22 10:35:33,654 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:33,654 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-22 10:35:33,655 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251122_103533/output
2025-11-22 10:35:33,660 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251122_103533
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-22 10:35:33,711 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251122_103533.zip...
2025-11-22 10:35:33,915 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251122_103533.zip
2025-11-22 10:35:33,919 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-22 10:35:33,919 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-22 10:35:33,919 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-22 10:35:33,920 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-22 10:35:33,928 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-22 10:35:33,929 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-22 10:35:33,929 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-22 10:35:33,929 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-22 10:35:34,388 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-22 10:35:34,388 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-22 10:35:34,389 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,431 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-22 10:35:34,431 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-22 10:35:34,432 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-22 10:35:34,432 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,432 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-22 10:35:34,440 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-22 10:35:34
File: selled_stock_drug_only_20251122_103533.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-22 10:35:34,441 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251122_103533.csv
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251122_103533.csv...
2025-11-22 10:35:34,441 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251122_103534.csv
2025-11-22 10:35:34,483 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-22 10:35:34,483 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-22 10:35:34,483 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-22 10:35:34,484 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251122_103534.csv
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251122_103534.csv by branches...
2025-11-22 10:35:34,484 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-22 10:35:34,528 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-22 10:35:36,255 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251122_103534_asherin.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251122_103534_wardani.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251122_103534_akba.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251122_103534_shahid.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251122_103534_nujum.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251122_103534_admin.csv
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.68 writes=0.37 total=1.77
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-22 10:35:36,256 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-22 10:35:36,256 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> wardani: selled_stock_drug_only_20251122_103534_from_asherin_to_wardani.csv
2025-11-22 10:35:36,651 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> akba: selled_stock_drug_only_20251122_103534_from_asherin_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> shahid: selled_stock_drug_only_20251122_103534_from_asherin_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - asherin -> nujum: selled_stock_drug_only_20251122_103534_from_asherin_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> asherin: selled_stock_drug_only_20251122_103534_from_wardani_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> akba: selled_stock_drug_only_20251122_103534_from_wardani_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> shahid: selled_stock_drug_only_20251122_103534_from_wardani_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> nujum: selled_stock_drug_only_20251122_103534_from_wardani_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - wardani -> admin: selled_stock_drug_only_20251122_103534_from_wardani_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> asherin: selled_stock_drug_only_20251122_103534_from_akba_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> wardani: selled_stock_drug_only_20251122_103534_from_akba_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> shahid: selled_stock_drug_only_20251122_103534_from_akba_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> nujum: selled_stock_drug_only_20251122_103534_from_akba_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - akba -> admin: selled_stock_drug_only_20251122_103534_from_akba_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> asherin: selled_stock_drug_only_20251122_103534_from_shahid_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> wardani: selled_stock_drug_only_20251122_103534_from_shahid_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> akba: selled_stock_drug_only_20251122_103534_from_shahid_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - shahid -> nujum: selled_stock_drug_only_20251122_103534_from_shahid_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> asherin: selled_stock_drug_only_20251122_103534_from_nujum_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> wardani: selled_stock_drug_only_20251122_103534_from_nujum_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> akba: selled_stock_drug_only_20251122_103534_from_nujum_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> shahid: selled_stock_drug_only_20251122_103534_from_nujum_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - nujum -> admin: selled_stock_drug_only_20251122_103534_from_nujum_to_admin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> asherin: selled_stock_drug_only_20251122_103534_from_admin_to_asherin.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> wardani: selled_stock_drug_only_20251122_103534_from_admin_to_wardani.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> akba: selled_stock_drug_only_20251122_103534_from_admin_to_akba.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> shahid: selled_stock_drug_only_20251122_103534_from_admin_to_shahid.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler |   - admin -> nujum: selled_stock_drug_only_20251122_103534_from_admin_to_nujum.csv
2025-11-22 10:35:36,652 | INFO     | src.app.pipeline.step_7_handler | Transfer files saved to: data/output/transfers
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-22 10:35:36,652 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-22 10:35:36,653 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-22 10:35:36,815 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-22 10:35:36,815 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-22 10:35:36,816 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-22 10:35:37,529 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-22 10:35:37,530 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-22 10:35:37,530 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-22 10:35:37,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:16:34,490 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:16:34,491 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:16:37,547 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:16:37,551 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:37,551 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:16:37,551 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:16:37,552 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:16:38,395 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:16:38,395 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:16:38,396 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:38,397 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:16:38,397 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:16:38,397 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:16:38,398 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_101638/output
2025-11-24 10:16:38,403 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_101638
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:16:38,480 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_101638.zip...
2025-11-24 10:16:38,679 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_101638.zip
2025-11-24 10:16:38,681 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:16:38,681 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:16:38,681 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:16:38,682 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:16:38,687 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:16:38,687 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:16:38,687 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:16:38,687 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,193 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:16:39,193 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:16:39,194 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:16:39,245 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,245 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:16:39
File: selled_stock_drug_only_20251124_101638.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:16:39,257 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_101638.csv
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_101638.csv...
2025-11-24 10:16:39,257 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_101639.csv
2025-11-24 10:16:39,303 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:16:39,303 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:16:39,304 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:16:39,304 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_101639.csv
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_101639.csv by branches...
2025-11-24 10:16:39,304 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:16:39,349 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_101639_asherin.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_101639_wardani.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_101639_akba.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_101639_shahid.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_101639_nujum.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_101639_admin.csv
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.05 allocation=0.10 surplus=0.67 writes=0.39 total=1.81
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:16:41,112 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:16:41,112 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:16:41,527 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_101639_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_101639_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_101639_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_101639_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_101639_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_101639_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:16:41,528 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:16:41,528 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:16:41,667 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:16:41,668 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:16:41,668 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:16:42,391 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:16:42,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:12,050 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:12,051 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:12,749 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:13,927 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:13,928 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:13,929 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:13,930 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:16,648 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:28:18,424 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:28:18,425 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:28:19,991 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:28:19,992 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:28:19,992 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:28:20,511 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:28:20,512 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:28:20,512 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:20,513 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:28:20,513 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:28:20,514 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:28:20,514 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_102820/output
2025-11-24 10:28:20,519 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_102820
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:28:20,549 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_102820.zip...
2025-11-24 10:28:20,764 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_102820.zip
2025-11-24 10:28:20,765 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:28:20,765 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:28:20,765 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:28:20,766 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:28:20,772 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:28:20,772 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:28:20,772 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:28:20,772 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,242 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:28:21,243 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:28:21,243 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,287 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:28:21,288 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,288 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:28:21
File: selled_stock_drug_only_20251124_102820.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:28:21,297 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_102820.csv
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_102820.csv...
2025-11-24 10:28:21,297 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_102821.csv
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:28:21,340 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:21,340 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_102821.csv
2025-11-24 10:28:21,341 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_102821.csv by branches...
2025-11-24 10:28:21,341 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:28:21,385 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_102821_asherin.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_102821_wardani.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_102821_akba.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_102821_shahid.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_102821_nujum.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_102821_admin.csv
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.70 writes=0.37 total=1.77
2025-11-24 10:28:23,111 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:28:23,112 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:28:23,112 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_102821_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_102821_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_102821_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:28:23,509 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_102821_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_102821_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_102821_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:28:23,510 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:28:23,510 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:28:23,652 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:28:23,652 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:28:23,653 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:28:23,653 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:28:24,364 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:28:24,364 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:44,237 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:53:44,237 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:53:44,238 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:53:44,239 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:53:44,240 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:53:44,241 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:45,412 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:53:48,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:53:49,234 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:53:49,235 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:53:49,235 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:53:49,685 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:49,686 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:53:49,687 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105349/output
2025-11-24 10:53:49,692 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105349
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:53:49,742 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105349.zip...
2025-11-24 10:53:49,946 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105349.zip
2025-11-24 10:53:49,948 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:53:49,948 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:53:49,948 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:53:49,949 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:53:49,954 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:53:49,954 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:53:49,954 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:53:49,954 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:49,955 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:53:49,955 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:53:50,416 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:53:50,416 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:53:50,417 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:53:50,461 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,461 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,462 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:53:50
File: selled_stock_drug_only_20251124_105349.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:53:50,471 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105349.csv
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105349.csv...
2025-11-24 10:53:50,471 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105350.csv
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:53:50,515 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105350.csv
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105350.csv by branches...
2025-11-24 10:53:50,515 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:53:50,559 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105350_asherin.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105350_wardani.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105350_akba.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105350_shahid.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105350_nujum.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105350_admin.csv
2025-11-24 10:53:52,363 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.72 writes=0.38 total=1.85
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:53:52,364 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:53:52,364 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105350_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105350_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105350_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105350_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105350_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105350_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:53:52,770 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:53:52,770 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:53:52,770 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:53:52,771 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:53:52,771 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:53:52,925 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:53:52,925 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:53:52,926 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:53:53,698 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:53:53,698 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:56:04,761 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:56:04,762 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:56:06,417 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:56:06,417 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:56:06,417 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:56:07,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:07,425 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:56:07,425 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105607/output
2025-11-24 10:56:07,426 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105607
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:56:07,458 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105607.zip...
2025-11-24 10:56:07,663 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105607.zip
2025-11-24 10:56:07,665 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:56:07,665 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:56:07,665 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:56:07,666 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:56:07,672 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:56:07,672 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:56:07,672 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:56:07,672 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:56:08,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:56:08,101 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:56:08,102 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,142 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:56:08,142 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,143 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:56:08
File: selled_stock_drug_only_20251124_105607.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:56:08,151 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105607.csv
2025-11-24 10:56:08,151 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105607.csv...
2025-11-24 10:56:08,152 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105608.csv
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:56:08,193 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:08,193 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105608.csv
2025-11-24 10:56:08,194 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105608.csv by branches...
2025-11-24 10:56:08,194 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:56:08,238 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105608_asherin.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105608_wardani.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105608_akba.csv
2025-11-24 10:56:10,129 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105608_shahid.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105608_nujum.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105608_admin.csv
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.10 surplus=0.76 writes=0.40 total=1.94
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:56:10,130 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:56:10,130 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:56:10,533 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:56:10,533 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105608_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105608_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105608_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105608_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105608_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105608_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:56:10,534 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:56:10,534 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:56:10,685 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:56:10,685 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:56:10,686 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:56:11,436 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:56:11,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:57:16,071 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:57:16,072 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:57:16,073 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:57:16,074 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:17,713 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 10:57:19,509 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 10:57:19,510 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 10:57:22,449 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 10:57:22,449 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 10:57:22,450 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 10:57:22,872 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 10:57:22,872 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 10:57:22,873 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:22,873 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 10:57:22,874 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_105722/output
2025-11-24 10:57:22,879 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 10:57:22,906 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 10:57:22,906 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_105722
2025-11-24 10:57:22,907 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 10:57:22,907 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_105722.zip...
2025-11-24 10:57:23,108 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_105722.zip
2025-11-24 10:57:23,110 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 10:57:23,110 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 10:57:23,110 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 10:57:23,111 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 10:57:23,117 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 10:57:23,117 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 10:57:23,117 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 10:57:23,117 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 10:57:23,582 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,582 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 10:57:23,583 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 10:57:23,633 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,633 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 10:57:23,642 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 10:57:23
File: selled_stock_drug_only_20251124_105723.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 10:57:23,642 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_105723.csv
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_105723.csv...
2025-11-24 10:57:23,643 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_105723.csv
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 10:57:23,686 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:23,686 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_105723.csv
2025-11-24 10:57:23,687 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_105723.csv by branches...
2025-11-24 10:57:23,687 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 10:57:23,732 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_105723_asherin.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_105723_wardani.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_105723_akba.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_105723_shahid.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_105723_nujum.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_105723_admin.csv
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.09 surplus=0.74 writes=0.38 total=1.87
2025-11-24 10:57:25,555 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 10:57:25,555 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 10:57:25,556 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | Generated 28 transfer files:
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_admin_to_akba.csv (9.7 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_admin_to_asherin.csv (8.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_admin_to_nujum.csv (6.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_admin_to_shahid.csv (11.2 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_admin_to_wardani.csv (6.0 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_akba_to_admin.csv (90.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_akba_to_nujum.csv (5.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_akba_to_shahid.csv (4.4 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_akba_to_wardani.csv (2.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_asherin_to_nujum.csv (6.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_asherin_to_shahid.csv (5.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_asherin_to_wardani.csv (2.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_nujum_to_admin.csv (89.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_nujum_to_akba.csv (18.6 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_nujum_to_asherin.csv (14.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_nujum_to_shahid.csv (16.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_nujum_to_wardani.csv (8.9 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_shahid_to_akba.csv (6.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_shahid_to_asherin.csv (3.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_shahid_to_nujum.csv (6.2 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_105723_from_shahid_to_wardani.csv (3.5 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (5 files):
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_105723_from_wardani_to_admin.csv (85.0 B)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_105723_from_wardani_to_akba.csv (7.3 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_105723_from_wardani_to_asherin.csv (6.4 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_105723_from_wardani_to_nujum.csv (9.1 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_105723_from_wardani_to_shahid.csv (8.8 KB)
2025-11-24 10:57:25,993 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 10:57:25,994 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 10:57:25,994 | INFO     | src.app.pipeline.step_8_handler | Found 28 transfer files to split
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler | Generated 153 split files:
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 10:57:26,137 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 10:57:26,137 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 10:57:26,138 | INFO     | src.app.pipeline.step_9_handler | Found 153 split CSV files to convert
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler | Generated 153 Excel files:
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 28 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-24 10:57:26,877 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 10:57:26,878 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 10:57:26,878 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:44,522 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 11:34:44,523 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 11:34:44,524 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 11:34:44,525 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:45,042 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-24 11:34:46,445 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-24 11:34:46,446 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-24 11:34:47,724 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-24 11:34:47,725 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-24 11:34:47,725 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-24 11:34:48,249 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-24 11:34:48,250 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-24 11:34:48,250 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,251 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-24 11:34:48,252 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251124_113448/output
2025-11-24 11:34:48,260 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories
2025-11-24 11:34:48,302 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251124_113448
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver |   - Archived 348 files in 86 directories
2025-11-24 11:34:48,303 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251124_113448.zip...
2025-11-24 11:34:48,501 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251124_113448.zip
2025-11-24 11:34:48,502 | INFO     | src.app.pipeline.step_1_handler | Archive created: 348 files, 86 dirs | Size: 9.76 MB
2025-11-24 11:34:48,503 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.77 MB (71.6% compression)
2025-11-24 11:34:48,503 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-24 11:34:48,503 | INFO     | src.shared.utils.archiver |   Found 348 files in 86 directories to delete
2025-11-24 11:34:48,509 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-24 11:34:48,509 | INFO     | src.shared.utils.archiver |   ✓ Deleted 348 files and 86 directories
2025-11-24 11:34:48,509 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-24 11:34:48,509 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,509 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-24 11:34:48,510 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-24 11:34:48,962 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:48,962 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-24 11:34:48,963 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-24 11:34:49,006 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,006 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-24 11:34:49
File: selled_stock_drug_only_20251124_113448.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-24 11:34:49,015 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251124_113448.csv
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251124_113448.csv...
2025-11-24 11:34:49,015 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251124_113449.csv
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-24 11:34:49,058 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:49,058 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251124_113449.csv
2025-11-24 11:34:49,059 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251124_113449.csv by branches...
2025-11-24 11:34:49,059 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-24 11:34:49,094 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251124_113449_asherin.csv
2025-11-24 11:34:50,841 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251124_113449_wardani.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251124_113449_akba.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251124_113449_shahid.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251124_113449_nujum.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251124_113449_admin.csv
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=0.71 writes=0.34 total=1.78
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-24 11:34:50,842 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-24 11:34:50,842 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_admin_to_akba.csv (9.5 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_admin_to_asherin.csv (8.7 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_admin_to_nujum.csv (6.1 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_admin_to_shahid.csv (11.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_admin_to_wardani.csv (5.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_113449_from_akba_to_admin.csv (87.0 B)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_akba_to_asherin.csv (4.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_akba_to_nujum.csv (3.4 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_akba_to_shahid.csv (3.4 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_akba_to_wardani.csv (2.2 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251124_113449_from_asherin_to_admin.csv (83.0 B)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_asherin_to_akba.csv (4.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_asherin_to_nujum.csv (4.3 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_asherin_to_shahid.csv (3.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_asherin_to_wardani.csv (2.5 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_nujum_to_akba.csv (15.7 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_nujum_to_asherin.csv (13.3 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_nujum_to_shahid.csv (13.0 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_nujum_to_wardani.csv (7.8 KB)
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-24 11:34:51,221 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_shahid_to_akba.csv (4.5 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_shahid_to_asherin.csv (3.6 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_shahid_to_nujum.csv (3.5 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251124_113449_from_shahid_to_wardani.csv (2.9 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251124_113449_from_wardani_to_akba.csv (5.7 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251124_113449_from_wardani_to_asherin.csv (6.6 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251124_113449_from_wardani_to_nujum.csv (6.4 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251124_113449_from_wardani_to_shahid.csv (7.2 KB)
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-24 11:34:51,222 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-24 11:34:51,222 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler | Generated 151 split files:
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 24 files
2025-11-24 11:34:51,354 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-24 11:34:51,355 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-24 11:34:51,355 | INFO     | src.app.pipeline.step_9_handler | Found 151 split CSV files to convert
2025-11-24 11:34:52,033 | INFO     | src.app.pipeline.step_9_handler | Generated 151 Excel files:
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 24 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-24 11:34:52,034 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-24 11:34:52,034 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:38:59,338 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:39:01,698 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 08:39:01,699 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 08:39:01,700 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 08:39:02,690 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 08:39:02,691 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 08:39:02,691 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:02,692 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 08:39:02,693 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_083902/output
2025-11-26 08:39:02,698 | INFO     | src.shared.utils.archiver |   Found 343 files in 84 directories
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_083902
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver |   - Archived 343 files in 84 directories
2025-11-26 08:39:02,729 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_083902.zip...
2025-11-26 08:39:02,925 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_083902.zip
2025-11-26 08:39:02,927 | INFO     | src.app.pipeline.step_1_handler | Archive created: 343 files, 84 dirs | Size: 9.33 MB
2025-11-26 08:39:02,927 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.64 MB (71.7% compression)
2025-11-26 08:39:02,927 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 08:39:02,928 | INFO     | src.shared.utils.archiver |   Found 343 files in 84 directories to delete
2025-11-26 08:39:02,933 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 08:39:02,933 | INFO     | src.shared.utils.archiver |   ✓ Deleted 343 files and 84 directories
2025-11-26 08:39:02,933 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 08:39:02,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:02,934 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 08:39:02,934 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,448 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 08:39:03,449 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 08:39:03,449 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:39:03,450 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,495 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 08:39:03,495 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,495 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,496 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,496 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 08:39:03
File: selled_stock_drug_only_20251126_083902.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 08:39:03,505 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_083902.csv
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_083902.csv...
2025-11-26 08:39:03,505 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_083903.csv
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 08:39:03,550 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_083903.csv
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_083903.csv by branches...
2025-11-26 08:39:03,550 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 08:39:03,593 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_083903_asherin.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_083903_wardani.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_083903_akba.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_083903_shahid.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_083903_nujum.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_083903_admin.csv
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=1.44 writes=0.34 total=2.57
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 08:39:06,121 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 08:39:06,121 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_admin_to_akba.csv (8.8 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_admin_to_asherin.csv (7.6 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_admin_to_nujum.csv (6.1 KB)
2025-11-26 08:39:06,504 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_admin_to_shahid.csv (10.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_admin_to_wardani.csv (4.7 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_083903_from_akba_to_admin.csv (87.0 B)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_akba_to_asherin.csv (3.4 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_akba_to_nujum.csv (3.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_akba_to_shahid.csv (3.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_akba_to_wardani.csv (2.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_083903_from_asherin_to_admin.csv (83.0 B)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_asherin_to_akba.csv (3.8 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_asherin_to_nujum.csv (4.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_asherin_to_shahid.csv (3.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_asherin_to_wardani.csv (1.8 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_nujum_to_akba.csv (15.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_nujum_to_asherin.csv (11.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_nujum_to_shahid.csv (12.6 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_nujum_to_wardani.csv (6.9 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_shahid_to_akba.csv (4.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_shahid_to_asherin.csv (3.0 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_shahid_to_nujum.csv (3.5 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_083903_from_shahid_to_wardani.csv (2.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_083903_from_wardani_to_akba.csv (5.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_083903_from_wardani_to_asherin.csv (5.3 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_083903_from_wardani_to_nujum.csv (6.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_083903_from_wardani_to_shahid.csv (6.1 KB)
2025-11-26 08:39:06,505 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 08:39:06,505 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 08:39:06,506 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 08:39:06,652 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 08:39:06,652 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 08:39:06,653 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 08:39:07,346 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 08:39:07,346 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:14,985 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:14,986 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:14,987 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:14,988 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:14,989 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:14,990 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:15,831 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:17,465 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:17,466 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:18,568 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 08:52:18,568 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:18,568 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 08:52:18,569 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 08:52:18,569 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 08:52:19,152 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,153 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 08:52:19,154 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_085219/output
2025-11-26 08:52:19,158 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_085219
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver |   - Archived 339 files in 84 directories
2025-11-26 08:52:19,206 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_085219.zip...
2025-11-26 08:52:19,397 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_085219.zip
2025-11-26 08:52:19,399 | INFO     | src.app.pipeline.step_1_handler | Archive created: 339 files, 84 dirs | Size: 9.27 MB
2025-11-26 08:52:19,399 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.60 MB (71.9% compression)
2025-11-26 08:52:19,399 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 08:52:19,400 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories to delete
2025-11-26 08:52:19,405 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 08:52:19,405 | INFO     | src.shared.utils.archiver |   ✓ Deleted 339 files and 84 directories
2025-11-26 08:52:19,405 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 08:52:19,405 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 08:52:19,405 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 08:52:19,406 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,406 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 08:52:19,406 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 08:52:19,860 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,860 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 08:52:19,861 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 08:52:19,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,905 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 08:52:19,914 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 08:52:19
File: selled_stock_drug_only_20251126_085219.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 08:52:19,914 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_085219.csv
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_085219.csv...
2025-11-26 08:52:19,915 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_085219.csv
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 08:52:19,958 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_085219.csv
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_085219.csv by branches...
2025-11-26 08:52:19,958 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 08:52:19,994 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_085219_asherin.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_085219_wardani.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_085219_akba.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_085219_shahid.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_085219_nujum.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_085219_admin.csv
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.14 surplus=1.39 writes=0.34 total=2.49
2025-11-26 08:52:22,452 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 08:52:22,452 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 08:52:22,453 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 08:52:22,453 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 08:52:22,453 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 08:52:22,835 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_admin_to_akba.csv (8.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_admin_to_asherin.csv (7.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_admin_to_nujum.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_admin_to_shahid.csv (10.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_admin_to_wardani.csv (4.7 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_085219_from_akba_to_admin.csv (87.0 B)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_akba_to_asherin.csv (3.4 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_akba_to_nujum.csv (3.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_akba_to_shahid.csv (3.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_akba_to_wardani.csv (2.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_085219_from_asherin_to_admin.csv (83.0 B)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_asherin_to_akba.csv (3.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_asherin_to_nujum.csv (4.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_asherin_to_shahid.csv (3.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_asherin_to_wardani.csv (1.8 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_nujum_to_akba.csv (15.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_nujum_to_asherin.csv (11.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_nujum_to_shahid.csv (12.6 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_nujum_to_wardani.csv (6.9 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_shahid_to_akba.csv (4.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_shahid_to_asherin.csv (3.0 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_shahid_to_nujum.csv (3.5 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_085219_from_shahid_to_wardani.csv (2.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_085219_from_wardani_to_akba.csv (5.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_085219_from_wardani_to_asherin.csv (5.3 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_085219_from_wardani_to_nujum.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_085219_from_wardani_to_shahid.csv (6.1 KB)
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 08:52:22,836 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,836 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 08:52:22,837 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 08:52:22,837 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 08:52:22,970 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 08:52:22,970 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 08:52:23,682 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 08:52:23,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 08:52:30,232 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 08:52:30,233 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 08:52:30,234 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 08:52:30,235 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 08:52:30,236 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 08:52:30,237 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 08:52:32,840 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:00:47,788 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:00:47,789 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:00:50,551 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 09:00:50,554 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 09:00:50,555 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 09:00:51,063 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 09:00:51,064 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 09:00:51,064 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,064 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 09:00:51,065 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_090051/output
2025-11-26 09:00:51,070 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_090051
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver |   - Archived 339 files in 84 directories
2025-11-26 09:00:51,106 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_090051.zip...
2025-11-26 09:00:51,304 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_090051.zip
2025-11-26 09:00:51,308 | INFO     | src.app.pipeline.step_1_handler | Archive created: 339 files, 84 dirs | Size: 9.27 MB
2025-11-26 09:00:51,308 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.60 MB (71.9% compression)
2025-11-26 09:00:51,308 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 09:00:51,309 | INFO     | src.shared.utils.archiver |   Found 339 files in 84 directories to delete
2025-11-26 09:00:51,318 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 09:00:51,318 | INFO     | src.shared.utils.archiver |   ✓ Deleted 339 files and 84 directories
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 09:00:51,318 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 09:00:51,318 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 09:00:51,779 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,779 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:00:51,780 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,825 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 09:00:51,826 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,826 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 09:00:51
File: selled_stock_drug_only_20251126_090051.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 09:00:51,835 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_090051.csv
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_090051.csv...
2025-11-26 09:00:51,835 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_090051.csv
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 09:00:51,879 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_090051.csv
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_090051.csv by branches...
2025-11-26 09:00:51,879 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 09:00:51,915 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_090051_asherin.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_090051_wardani.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_090051_akba.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_090051_shahid.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_090051_nujum.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_090051_admin.csv
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 09:00:54,405 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.13 surplus=1.42 writes=0.34 total=2.53
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 09:00:54,406 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 09:00:54,406 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | Generated 27 transfer files:
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_admin_to_akba.csv (9.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_admin_to_nujum.csv (6.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_admin_to_shahid.csv (10.8 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_admin_to_wardani.csv (5.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_090051_from_akba_to_admin.csv (87.0 B)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_akba_to_asherin.csv (3.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_akba_to_nujum.csv (3.3 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_akba_to_shahid.csv (3.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_akba_to_wardani.csv (2.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (5 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_090051_from_asherin_to_admin.csv (83.0 B)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_asherin_to_akba.csv (4.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_asherin_to_wardani.csv (2.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_nujum_to_akba.csv (16.2 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_nujum_to_asherin.csv (12.1 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_nujum_to_shahid.csv (13.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_shahid_to_akba.csv (4.9 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_shahid_to_asherin.csv (3.5 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_090051_from_shahid_to_wardani.csv (2.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_090051_from_wardani_to_akba.csv (6.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_090051_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_090051_from_wardani_to_nujum.csv (6.4 KB)
2025-11-26 09:00:54,846 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_090051_from_wardani_to_shahid.csv (7.0 KB)
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 09:00:54,847 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 09:00:54,847 | INFO     | src.app.pipeline.step_8_handler | Found 27 transfer files to split
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler | Generated 150 split files:
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 27 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 24 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 24 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 09:00:54,984 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 09:00:54,984 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 09:00:54,985 | INFO     | src.app.pipeline.step_9_handler | Found 150 split CSV files to convert
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler | Generated 150 Excel files:
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 27 files
2025-11-26 09:00:55,711 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 24 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 24 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 09:00:55,712 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 09:00:55,712 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:08,483 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:28:08,484 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:28:08,485 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:10,571 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 09:28:37,056 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 09:28:37,057 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 09:28:39,919 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 09:28:39,919 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 09:28:39,919 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 09:28:40,615 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 09:28:40,618 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 09:28:40,618 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:40,619 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 09:28:40,619 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_092840/output
2025-11-26 09:28:40,623 | INFO     | src.shared.utils.archiver |   Found 341 files in 84 directories
2025-11-26 09:28:40,647 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_092840
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver |   - Archived 341 files in 84 directories
2025-11-26 09:28:40,648 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_092840.zip...
2025-11-26 09:28:40,840 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_092840.zip
2025-11-26 09:28:40,842 | INFO     | src.app.pipeline.step_1_handler | Archive created: 341 files, 84 dirs | Size: 9.32 MB
2025-11-26 09:28:40,842 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.63 MB (71.8% compression)
2025-11-26 09:28:40,842 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 09:28:40,843 | INFO     | src.shared.utils.archiver |   Found 341 files in 84 directories to delete
2025-11-26 09:28:40,849 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 09:28:40,849 | INFO     | src.shared.utils.archiver |   ✓ Deleted 341 files and 84 directories
2025-11-26 09:28:40,849 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 09:28:40,849 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:40,850 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 09:28:40,850 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 09:28:41,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 09:28:41,302 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 09:28:41,303 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,346 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 09:28:41,347 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,347 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 09:28:41
File: selled_stock_drug_only_20251126_092840.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 09:28:41,356 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_092840.csv
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_092840.csv...
2025-11-26 09:28:41,356 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_092841.csv
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 09:28:41,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_092841.csv
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_092841.csv by branches...
2025-11-26 09:28:41,400 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 09:28:41,436 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 09:28:44,198 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_092841_asherin.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_092841_wardani.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_092841_akba.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_092841_shahid.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_092841_nujum.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_092841_admin.csv
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.13 surplus=1.68 writes=0.34 total=2.80
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 09:28:44,199 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 09:28:44,199 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_admin_to_akba.csv (9.0 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_admin_to_asherin.csv (8.2 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_admin_to_nujum.csv (6.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_admin_to_shahid.csv (10.7 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_admin_to_wardani.csv (5.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_092841_from_akba_to_admin.csv (114.0 B)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_akba_to_asherin.csv (3.7 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_akba_to_shahid.csv (3.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_akba_to_wardani.csv (2.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_asherin_to_nujum.csv (4.4 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_asherin_to_shahid.csv (4.2 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_nujum_to_akba.csv (16.0 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_nujum_to_asherin.csv (12.6 KB)
2025-11-26 09:28:44,607 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_nujum_to_shahid.csv (13.1 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_nujum_to_wardani.csv (7.4 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_092841_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_092841_from_wardani_to_akba.csv (6.9 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_092841_from_wardani_to_asherin.csv (5.6 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_092841_from_wardani_to_nujum.csv (6.5 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_092841_from_wardani_to_shahid.csv (7.0 KB)
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 09:28:44,608 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 09:28:44,608 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler | Generated 151 split files:
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 09:28:44,743 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 09:28:44,743 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 09:28:44,744 | INFO     | src.app.pipeline.step_9_handler | Found 151 split CSV files to convert
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler | Generated 151 Excel files:
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 09:28:45,437 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 09:28:45,437 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 10:16:27,189 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 10:16:27,190 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:28,293 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 10:16:30,211 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 10:16:30,212 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 10:16:32,909 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 10:16:32,909 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 10:16:32,909 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 10:16:33,405 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:33,405 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 10:16:33,405 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_101633/output
2025-11-26 10:16:33,406 | INFO     | src.shared.utils.archiver |   Found 342 files in 82 directories
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_101633
2025-11-26 10:16:33,421 | INFO     | src.shared.utils.archiver |   - Archived 342 files in 82 directories
2025-11-26 10:16:33,422 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_101633.zip...
2025-11-26 10:16:33,621 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_101633.zip
2025-11-26 10:16:33,623 | INFO     | src.app.pipeline.step_1_handler | Archive created: 342 files, 82 dirs | Size: 9.32 MB
2025-11-26 10:16:33,623 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.63 MB (71.7% compression)
2025-11-26 10:16:33,623 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 10:16:33,623 | INFO     | src.shared.utils.archiver |   Found 342 files in 82 directories to delete
2025-11-26 10:16:33,629 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 10:16:33,629 | INFO     | src.shared.utils.archiver |   ✓ Deleted 342 files and 82 directories
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 10:16:33,629 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 10:16:33,629 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 10:16:34,115 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 10:16:34,115 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 10:16:34,116 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 10:16:34,160 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,160 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 10:16:34
File: selled_stock_drug_only_20251126_101633.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 10:16:34,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_101633.csv
2025-11-26 10:16:34,169 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_101633.csv...
2025-11-26 10:16:34,170 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_101634.csv
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 10:16:34,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:34,213 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_101634.csv
2025-11-26 10:16:34,214 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_101634.csv by branches...
2025-11-26 10:16:34,214 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 10:16:34,249 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_101634_asherin.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_101634_wardani.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_101634_akba.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_101634_shahid.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_101634_nujum.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_101634_admin.csv
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.76 writes=0.42 total=3.04
2025-11-26 10:16:37,253 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 10:16:37,253 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 10:16:37,254 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_admin_to_akba.csv (9.1 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_admin_to_asherin.csv (8.4 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_admin_to_nujum.csv (6.4 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_admin_to_shahid.csv (10.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_101634_from_akba_to_admin.csv (114.0 B)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_akba_to_asherin.csv (3.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_akba_to_nujum.csv (3.7 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_asherin_to_shahid.csv (4.1 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_asherin_to_wardani.csv (2.5 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_nujum_to_akba.csv (15.8 KB)
2025-11-26 10:16:37,738 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_nujum_to_asherin.csv (12.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_nujum_to_shahid.csv (13.0 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_shahid_to_asherin.csv (3.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_101634_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_101634_from_wardani_to_akba.csv (6.8 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_101634_from_wardani_to_asherin.csv (5.8 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_101634_from_wardani_to_nujum.csv (6.5 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_101634_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 10:16:37,739 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 10:16:37,739 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 10:16:37,876 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 10:16:37,876 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 10:16:37,877 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 10:16:38,566 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 10:16:38,566 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 10:16:38,566 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 10:16:38,567 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:32,911 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:32,912 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:34,118 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:05:35,965 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:35,966 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:35,967 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:37,689 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:05:37,689 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:05:37,690 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 11:05:38,214 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,215 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:05:38,215 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_110538/output
2025-11-26 11:05:38,216 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_110538
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:05:38,235 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_110538.zip...
2025-11-26 11:05:38,431 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_110538.zip
2025-11-26 11:05:38,433 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 9.31 MB
2025-11-26 11:05:38,433 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.62 MB (71.8% compression)
2025-11-26 11:05:38,433 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:05:38,434 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:05:38,439 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:05:38,439 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:05:38,439 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 11:05:38,439 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,440 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:05:38,440 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 11:05:38,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,921 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:05:38,922 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 11:05:38,966 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,966 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:05:38
File: selled_stock_drug_only_20251126_110538.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 11:05:38,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_110538.csv
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_110538.csv...
2025-11-26 11:05:38,975 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_110538.csv
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 11:05:39,019 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:39,019 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_110538.csv
2025-11-26 11:05:39,020 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_110538.csv by branches...
2025-11-26 11:05:39,020 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:05:39,057 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_110539_asherin.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_110539_wardani.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_110539_akba.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_110539_shahid.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_110539_nujum.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_110539_admin.csv
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.79 writes=0.34 total=2.98
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 11:05:42,004 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,004 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:05:42,005 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:05:42,005 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_110539_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:05:42,364 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_110539_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_110539_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_110539_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_110539_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_110539_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 11:05:42,365 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:05:42,365 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:05:42,509 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 11:05:42,509 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:05:42,510 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:05:43,294 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:05:43,294 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:05:43,294 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:05:43,295 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:29,746 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:13:31,571 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:13:33,396 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:13:33,396 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:13:33,397 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:13:33,835 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:13:33,835 | INFO     | src.app.cli.executors.batch_executor | [1/9] 1 - Archive Previous Output
2025-11-26 11:13:33,836 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:33,836 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:13:33,837 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_111333/output
2025-11-26 11:13:33,841 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_111333
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:13:33,869 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_111333.zip...
2025-11-26 11:13:34,064 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_111333.zip
2025-11-26 11:13:34,066 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:13:34,066 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:13:34,066 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:13:34,066 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:13:34,072 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:13:34,072 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.batch_executor | [2/9] 2 - Convert Excel to CSV
2025-11-26 11:13:34,072 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:13:34,072 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,536 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.batch_executor | [3/9] 3 - Validate Data
2025-11-26 11:13:34,536 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,536 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:13:34,537 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,581 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.batch_executor | [4/9] 4 - Sales Analysis
2025-11-26 11:13:34,581 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,581 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,582 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,582 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:13:34
File: selled_stock_drug_only_20251126_111334.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.batch_executor | [5/9] 5 - Rename Columns
2025-11-26 11:13:34,591 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_111334.csv
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_111334.csv...
2025-11-26 11:13:34,591 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_111334.csv
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.batch_executor | [6/9] 6 - Split by Branches
2025-11-26 11:13:34,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:34,634 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_111334.csv
2025-11-26 11:13:34,635 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_111334.csv by branches...
2025-11-26 11:13:34,635 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:13:34,670 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:13:37,587 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_111334_asherin.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_111334_wardani.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_111334_akba.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_111334_shahid.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_111334_nujum.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_111334_admin.csv
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.81 writes=0.31 total=2.95
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.batch_executor | [7/9] 7 - Generate Transfer Files
2025-11-26 11:13:37,588 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:13:37,588 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_111334_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_111334_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_111334_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_111334_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_111334_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_111334_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:13:37,937 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:13:37,937 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:13:37,937 | INFO     | src.app.cli.executors.batch_executor | [8/9] 8 - Split Transfer Files by Product Type
2025-11-26 11:13:37,938 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:13:37,938 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:13:38,077 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.batch_executor | [9/9] 9 - Convert Split Files to Excel
2025-11-26 11:13:38,078 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:13:38,078 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:13:38,780 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 9
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:13:38,780 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:38,451 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | 
  10. Execute all steps
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:24:38,452 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:39,239 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:24:41,081 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:24:41,084 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:24:48,784 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:24:48,785 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:24:48,786 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:24:49,976 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:24:49,976 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:24:49,977 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:49,977 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:24:49,978 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_112449/output
2025-11-26 11:24:49,983 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_112449
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:24:50,015 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_112449.zip...
2025-11-26 11:24:50,217 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_112449.zip
2025-11-26 11:24:50,219 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:24:50,219 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:24:50,219 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:24:50,220 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:24:50,228 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:24:50,228 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:24:50,228 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:24:50,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,229 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:24:50,229 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:24:50,716 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:24:50,716 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,760 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:24:50,761 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,761 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:24:50
File: selled_stock_drug_only_20251126_112450.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:24:50,770 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_112450.csv
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_112450.csv...
2025-11-26 11:24:50,770 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_112450.csv
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:24:50,814 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_112450.csv
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_112450.csv by branches...
2025-11-26 11:24:50,814 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:24:50,849 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:24:53,728 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_112450_asherin.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_112450_wardani.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_112450_akba.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_112450_shahid.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_112450_nujum.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_112450_admin.csv
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.77 writes=0.31 total=2.91
2025-11-26 11:24:53,729 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:24:53,729 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:24:53,730 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_112450_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:24:54,097 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_112450_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_112450_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_112450_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_112450_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_112450_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:24:54,098 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:24:54,098 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:24:54,239 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:24:54,239 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:24:54,239 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:24:54,240 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:24:54,240 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:24:54,958 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:24:54,959 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:24:54,959 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:24:54,965 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: asherin
2025-11-26 11:24:54,971 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: wardani
2025-11-26 11:24:54,977 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: akba
2025-11-26 11:24:54,983 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: shahid
2025-11-26 11:24:54,989 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: nujum
2025-11-26 11:24:54,995 | INFO     | src.app.pipeline.step_11_handler | No remaining surplus for branch: admin
2025-11-26 11:24:54,995 | WARNING  | src.app.pipeline.step_11_handler | No remaining surplus files were created
2025-11-26 11:24:54,995 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 11 failed
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Successful: 9
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Failed: 1
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 90.0%
2025-11-26 11:24:54,995 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:27,733 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:27,734 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:27,735 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:27,736 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:29,165 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:32:30,758 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:30,759 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:32,085 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:32:32,502 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:32:32,503 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:32:32,504 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:32:32,505 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:32:32,506 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:32:32,507 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:32:41,118 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:32:41,122 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:32:41,122 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:32:42,182 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:32:42,182 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:32:42,183 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,184 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:32:42,185 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_113242/output
2025-11-26 11:32:42,190 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_113242
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver |   - Archived 338 files in 82 directories
2025-11-26 11:32:42,241 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_113242.zip...
2025-11-26 11:32:42,434 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_113242.zip
2025-11-26 11:32:42,436 | INFO     | src.app.pipeline.step_1_handler | Archive created: 338 files, 82 dirs | Size: 8.62 MB
2025-11-26 11:32:42,436 | INFO     | src.app.pipeline.step_1_handler | ZIP: 2.61 MB (69.8% compression)
2025-11-26 11:32:42,436 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:32:42,437 | INFO     | src.shared.utils.archiver |   Found 338 files in 82 directories to delete
2025-11-26 11:32:42,442 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:32:42,442 | INFO     | src.shared.utils.archiver |   ✓ Deleted 338 files and 82 directories
2025-11-26 11:32:42,442 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:32:42,442 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,442 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:32:42,443 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,905 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:32:42,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:32:42,906 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,950 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:32:42,950 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,951 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:32:42
File: selled_stock_drug_only_20251126_113242.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:32:42,960 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_113242.csv
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_113242.csv...
2025-11-26 11:32:42,960 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_113242.csv
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:32:43,003 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:43,003 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_113242.csv
2025-11-26 11:32:43,004 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_113242.csv by branches...
2025-11-26 11:32:43,004 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:32:43,040 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:32:45,920 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:32:45,920 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_113243_asherin.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_113243_wardani.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_113243_akba.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_113243_shahid.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_113243_nujum.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_113243_admin.csv
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.76 writes=0.33 total=2.92
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:32:45,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:32:45,921 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_113243_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_113243_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_113243_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_113243_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_113243_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_113243_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:32:46,264 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:32:46,264 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:32:46,265 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:32:46,400 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:32:46,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:32:46,401 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:32:47,109 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:32:47,109 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:32:47,785 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for asherin: 1342 products
2025-11-26 11:32:48,490 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for wardani: 1759 products
2025-11-26 11:32:49,213 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for akba: 1508 products
2025-11-26 11:32:49,883 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for shahid: 1591 products
2025-11-26 11:32:50,547 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for nujum: 2557 products
2025-11-26 11:32:51,229 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for admin: 1596 products
2025-11-26 11:32:51,229 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:32:51,269 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_asherin_remaining_surplus.xlsx
2025-11-26 11:32:51,318 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_wardani_remaining_surplus.xlsx
2025-11-26 11:32:51,374 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_akba_remaining_surplus.xlsx
2025-11-26 11:32:51,420 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_shahid_remaining_surplus.xlsx
2025-11-26 11:32:51,494 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_nujum_remaining_surplus.xlsx
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_113243_admin_remaining_surplus.xlsx
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus CSV files
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus Excel files
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv
2025-11-26 11:32:51,540 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:32:51,541 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:12,514 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:12,515 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:12,516 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:12,517 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:16,848 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:45:16,851 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:45:16,852 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:45:17,747 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:17,748 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:45:17,749 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_114517/output
2025-11-26 11:45:17,754 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_114517
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver |   - Archived 350 files in 84 directories
2025-11-26 11:45:17,822 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_114517.zip...
2025-11-26 11:45:18,039 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_114517.zip
2025-11-26 11:45:18,041 | INFO     | src.app.pipeline.step_1_handler | Archive created: 350 files, 84 dirs | Size: 9.23 MB
2025-11-26 11:45:18,041 | INFO     | src.app.pipeline.step_1_handler | ZIP: 3.04 MB (67.0% compression)
2025-11-26 11:45:18,041 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:45:18,042 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories to delete
2025-11-26 11:45:18,047 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:45:18,047 | INFO     | src.shared.utils.archiver |   ✓ Deleted 350 files and 84 directories
2025-11-26 11:45:18,047 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:45:18,047 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,048 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:45:18,048 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:45:18,456 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:45:18,456 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:18,457 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:45:18,497 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,497 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:45:18
File: selled_stock_drug_only_20251126_114518.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:45:18,506 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114518.csv
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_114518.csv...
2025-11-26 11:45:18,506 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_114518.csv
2025-11-26 11:45:18,546 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:45:18,546 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_114518.csv
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_114518.csv by branches...
2025-11-26 11:45:18,547 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:45:18,581 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:45:21,490 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:45:21,490 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_114518_asherin.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_114518_wardani.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_114518_akba.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_114518_shahid.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_114518_nujum.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_114518_admin.csv
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.18 surplus=1.80 writes=0.31 total=2.94
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:45:21,491 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:45:21,491 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_114518_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:45:21,837 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114518_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114518_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114518_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114518_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114518_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:45:21,838 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:45:21,838 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:45:21,986 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:45:21,986 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:45:21,987 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:45:22,677 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:45:22,678 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:45:22,678 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:23,366 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for asherin: 1342 products
2025-11-26 11:45:24,041 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for wardani: 1759 products
2025-11-26 11:45:24,709 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for akba: 1508 products
2025-11-26 11:45:25,388 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for shahid: 1591 products
2025-11-26 11:45:26,061 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for nujum: 2557 products
2025-11-26 11:45:26,728 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus file for admin: 1596 products
2025-11-26 11:45:26,728 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:45:26,768 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_asherin_remaining_surplus.xlsx
2025-11-26 11:45:26,832 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_wardani_remaining_surplus.xlsx
2025-11-26 11:45:26,876 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_akba_remaining_surplus.xlsx
2025-11-26 11:45:26,922 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_shahid_remaining_surplus.xlsx
2025-11-26 11:45:26,994 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_nujum_remaining_surplus.xlsx
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Converted to Excel: selled_stock_drug_only_20251126_114518_admin_remaining_surplus.xlsx
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus CSV files
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Generated 6 remaining surplus Excel files
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv
2025-11-26 11:45:27,040 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:45:27,041 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:36,977 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:36,980 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:36,981 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:36,982 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:36,983 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:36,984 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:37,618 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 11:45:40,657 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 11:45:42,876 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 11:45:42,876 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 11:45:42,876 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 11:45:43,608 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 11:45:43,609 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 11:45:43,609 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:43,610 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 11:45:43,610 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 11:45:43,611 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 11:45:43,611 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_114543/output
2025-11-26 11:45:43,616 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_114543
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver |   - Archived 350 files in 84 directories
2025-11-26 11:45:43,662 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_114543.zip...
2025-11-26 11:45:43,881 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_114543.zip
2025-11-26 11:45:43,883 | INFO     | src.app.pipeline.step_1_handler | Archive created: 350 files, 84 dirs | Size: 9.23 MB
2025-11-26 11:45:43,883 | INFO     | src.app.pipeline.step_1_handler | ZIP: 3.04 MB (67.0% compression)
2025-11-26 11:45:43,883 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 11:45:43,884 | INFO     | src.shared.utils.archiver |   Found 350 files in 84 directories to delete
2025-11-26 11:45:43,889 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 11:45:43,889 | INFO     | src.shared.utils.archiver |   ✓ Deleted 350 files and 84 directories
2025-11-26 11:45:43,889 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 11:45:43,889 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:43,890 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 11:45:43,890 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 11:45:44,395 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,395 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 11:45:44,396 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 11:45:44,440 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,440 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 11:45:44,449 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 11:45:44
File: selled_stock_drug_only_20251126_114543.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 11:45:44,449 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_114543.csv
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_114543.csv...
2025-11-26 11:45:44,450 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_114544.csv
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 11:45:44,495 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_114544.csv
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_114544.csv by branches...
2025-11-26 11:45:44,495 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 11:45:44,530 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 11:45:47,358 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_114544_asherin.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_114544_wardani.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_114544_akba.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_114544_shahid.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_114544_nujum.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_114544_admin.csv
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.19 surplus=1.75 writes=0.30 total=2.86
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 11:45:47,359 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 11:45:47,359 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_admin_to_akba.csv (8.7 KB)
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 11:45:47,712 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_114544_from_akba_to_admin.csv (114.0 B)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_114544_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_114544_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_114544_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_114544_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_114544_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 11:45:47,713 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 11:45:47,713 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 11:45:47,713 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 11:45:47,714 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 11:45:47,714 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 11:45:47,854 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 11:45:47,854 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 11:45:47,855 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 11:45:48,607 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.batch_executor | [10/10] 11 - Generate Remaining Surplus Files
2025-11-26 11:45:48,607 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 11:45:49,333 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 11:45:50,027 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 11:45:50,708 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 11:45:51,389 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 11:45:52,077 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 11:45:52,765 | INFO     | src.app.pipeline.step_11_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 11:45:52,765 | INFO     | src.app.pipeline.step_11_handler | Converting remaining surplus files to Excel format...
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | ==================================================
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Generated 36 remaining surplus CSV files
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Generated 36 remaining surplus Excel files
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 11:45:53,179 | INFO     | src.app.pipeline.step_11_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 11:45:53,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:39:15,296 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:15,297 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:15,298 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:15,299 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:15,300 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:15,301 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:16,829 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-11-26 13:39:18,817 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:18,817 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:18,818 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:18,819 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:18,820 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |   11. Generate Remaining Surplus Files
2025-11-26 13:39:18,821 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:18,822 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:21,121 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:22,714 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:22,715 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:24,063 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-26 13:39:24,063 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-26 13:39:24,774 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:25,460 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:26,152 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:39:26,830 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:39:27,518 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:39:28,207 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:39:28,207 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:39:28,667 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:39:28,668 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:28,668 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:28,669 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:31,363 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-26 13:39:32,714 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:32,716 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:32,717 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:34,047 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-26 13:39:34,048 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-26 13:39:34,779 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:35,469 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:36,171 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:39:36,855 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:39:37,575 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:39:38,265 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:39:38,265 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:39:38,715 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:39:38,716 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:39:44,193 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-26 13:39:44,196 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-26 13:39:44,197 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-26 13:39:44,198 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-26 13:39:44,199 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-26 13:39:44,200 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-26 13:39:51,696 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-26 13:39:51,697 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-26 13:39:51,697 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-26 13:39:52,327 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:52,328 | INFO     | src.app.pipeline.step_1_handler | Archiving previous output files...
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-26 13:39:52,329 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251126_133952/output
2025-11-26 13:39:52,336 | INFO     | src.shared.utils.archiver |   Found 554 files in 96 directories
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251126_133952
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver |   - Archived 554 files in 96 directories
2025-11-26 13:39:52,396 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251126_133952.zip...
2025-11-26 13:39:52,640 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251126_133952.zip
2025-11-26 13:39:52,643 | INFO     | src.app.pipeline.step_1_handler | Archive created: 554 files, 96 dirs | Size: 10.89 MB
2025-11-26 13:39:52,643 | INFO     | src.app.pipeline.step_1_handler | ZIP: 4.38 MB (59.8% compression)
2025-11-26 13:39:52,643 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-26 13:39:52,644 | INFO     | src.shared.utils.archiver |   Found 554 files in 96 directories to delete
2025-11-26 13:39:52,651 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-26 13:39:52,651 | INFO     | src.shared.utils.archiver |   ✓ Deleted 554 files and 96 directories
2025-11-26 13:39:52,651 | INFO     | src.app.pipeline.step_1_handler | ✓ Output directory cleared successfully
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-26 13:39:52,651 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:52,651 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-26 13:39:52,652 | INFO     | src.app.pipeline.step_2_handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.step_2_handler | Conversion successful! File saved to: data/output/converted
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-26 13:39:53,081 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,081 | INFO     | src.app.pipeline.step_3_handler | Validating selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | --------------------------------------------------
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     ✓ Date range is >= 3 months
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler |     ✓ All column headers match expected order
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ✓ Overall validation: SUCCESSFUL
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | ==================================================
2025-11-26 13:39:53,082 | INFO     | src.app.pipeline.step_3_handler | Removing first row (header with date range) from selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_3_handler | ✓ First row removed successfully
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-26 13:39:53,127 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_4_handler | Analyzing selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,127 | INFO     | src.app.pipeline.step_4_handler | --------------------------------------------------
2025-11-26 13:39:53,137 | INFO     | src.app.pipeline.step_4_handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-26 13:39:53
File: selled_stock_drug_only_20251126_133952.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-26 13:39:53,137 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,137 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251126_133952.csv
2025-11-26 13:39:53,138 | INFO     | src.app.pipeline.step_5_handler | Renaming columns in selled_stock_drug_only_20251126_133952.csv...
2025-11-26 13:39:53,138 | INFO     | src.app.pipeline.step_5_handler | --------------------------------------------------
2025-11-26 13:39:53,182 | INFO     | src.app.pipeline.step_5_handler | Columns renamed successfully!
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_5_handler | Output file: selled_stock_drug_only_renamed_20251126_133953.csv
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_5_handler | Saved to: data/output/renamed
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-26 13:39:53,183 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251126_133953.csv
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_6_handler | Splitting selled_stock_drug_only_renamed_20251126_133953.csv by branches...
2025-11-26 13:39:53,183 | INFO     | src.app.pipeline.step_6_handler | --------------------------------------------------
2025-11-26 13:39:53,218 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler | File split successfully into 6 branch files:
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - asherin: selled_stock_drug_only_20251126_133953_asherin.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - wardani: selled_stock_drug_only_20251126_133953_wardani.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - akba: selled_stock_drug_only_20251126_133953_akba.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - shahid: selled_stock_drug_only_20251126_133953_shahid.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - nujum: selled_stock_drug_only_20251126_133953_nujum.csv
2025-11-26 13:39:56,101 | INFO     | src.app.pipeline.step_6_handler |   - admin: selled_stock_drug_only_20251126_133953_admin.csv
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Branch files saved to: data/output/branches
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Analytics files saved to: data/output/analytics
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Step 6 timing (seconds): prep=0.03 allocation=0.19 surplus=1.78 writes=0.31 total=2.92
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_6_handler | Step 6 workload: products=4603 branches=6
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-26 13:39:56,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | Generating transfer files...
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | --------------------------------------------------
2025-11-26 13:39:56,102 | INFO     | src.app.pipeline.step_7_handler | Using latest analytics files for each target branch...
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | Generated 26 transfer files:
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From admin (5 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_admin_to_akba.csv (8.7 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_admin_to_asherin.csv (8.1 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_admin_to_nujum.csv (5.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_admin_to_shahid.csv (10.2 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_admin_to_wardani.csv (5.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From akba (5 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → admin: selled_stock_drug_only_20251126_133953_from_akba_to_admin.csv (114.0 B)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_akba_to_asherin.csv (3.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_akba_to_nujum.csv (3.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_akba_to_shahid.csv (3.2 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_akba_to_wardani.csv (2.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From asherin (4 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_asherin_to_akba.csv (4.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_asherin_to_nujum.csv (4.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_asherin_to_shahid.csv (4.0 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_asherin_to_wardani.csv (2.3 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From nujum (4 files):
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_nujum_to_akba.csv (15.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_nujum_to_asherin.csv (12.4 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_nujum_to_shahid.csv (12.9 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_nujum_to_wardani.csv (7.6 KB)
2025-11-26 13:39:56,438 | INFO     | src.app.pipeline.step_7_handler | 
  From shahid (4 files):
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_shahid_to_akba.csv (4.3 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_shahid_to_asherin.csv (3.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_shahid_to_nujum.csv (3.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → wardani: selled_stock_drug_only_20251126_133953_from_shahid_to_wardani.csv (2.9 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler | 
  From wardani (4 files):
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → akba: selled_stock_drug_only_20251126_133953_from_wardani_to_akba.csv (6.6 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → asherin: selled_stock_drug_only_20251126_133953_from_wardani_to_asherin.csv (5.7 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → nujum: selled_stock_drug_only_20251126_133953_from_wardani_to_nujum.csv (6.3 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler |     → shahid: selled_stock_drug_only_20251126_133953_from_wardani_to_shahid.csv (7.1 KB)
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_7_handler | 
Transfer files saved to: data/output/transfers
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-26 13:39:56,439 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | Splitting transfer files by product type...
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | --------------------------------------------------
2025-11-26 13:39:56,439 | INFO     | src.app.pipeline.step_8_handler | Found 26 transfer files to split
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler | Generated 149 split files:
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - tablets_and_capsules: 26 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - injections: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - syrups: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - creams: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - sachets: 23 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler |   - other: 25 files
2025-11-26 13:39:56,586 | INFO     | src.app.pipeline.step_8_handler | Split files saved to: data/output/transfers
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-26 13:39:56,586 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | Converting split CSV files to Excel format...
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | --------------------------------------------------
2025-11-26 13:39:56,587 | INFO     | src.app.pipeline.step_9_handler | Found 149 split CSV files to convert
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler | Generated 149 Excel files:
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - tablets_and_capsules: 26 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - injections: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - syrups: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - creams: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - sachets: 23 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler |   - other: 25 files
2025-11-26 13:39:57,274 | INFO     | src.app.pipeline.step_9_handler | Excel files saved to: data/output/transfers_excel
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-26 13:39:57,274 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-26 13:39:57,967 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-26 13:39:58,676 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-26 13:39:59,419 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-26 13:40:00,154 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-26 13:40:00,882 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-26 13:40:01,635 | INFO     | src.app.pipeline.step_10_handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-26 13:40:01,635 | INFO     | src.app.pipeline.step_10_handler | Converting remaining surplus files to Excel format...
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | ==================================================
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus CSV files
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Generated 36 remaining surplus Excel files
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-26 13:40:02,075 | INFO     | src.app.pipeline.step_10_handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-26 13:40:02,076 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:06,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:09,291 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Remaining Surplus Files
2025-11-27 10:07:09,292 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-27 10:07:09,930 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:07:10,519 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:07:11,103 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:07:11,703 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:07:12,296 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:07:12,885 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:07:12,885 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:07:13,341 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:07:13,341 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:07:16,492 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:16,493 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:16,494 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:16,495 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:16,496 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:16,497 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:17,706 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:07:20,278 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:07:20,281 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:07:20,282 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:07:23,946 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:07:23,949 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:07:23,949 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:07:24,658 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:07:24,659 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:07:24,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:24,660 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:07:24,662 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_100724/output
2025-11-27 10:07:24,668 | INFO     | src.shared.utils.archiver |   Found 482 files in 96 directories
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_100724
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver |   - Archived 482 files in 96 directories
2025-11-27 10:07:24,761 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_100724.zip...
2025-11-27 10:07:24,989 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_100724.zip
2025-11-27 10:07:24,991 | INFO     | src.app.pipeline.step_1.handler | Archive created: 482 files, 96 dirs | Size: 10.13 MB
2025-11-27 10:07:24,991 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.79 MB (62.6% compression)
2025-11-27 10:07:24,991 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:07:24,992 | INFO     | src.shared.utils.archiver |   Found 482 files in 96 directories to delete
2025-11-27 10:07:24,999 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:07:24,999 | INFO     | src.shared.utils.archiver |   ✓ Deleted 482 files and 96 directories
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:07:24,999 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:07:24,999 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:07:25,466 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:07:25,466 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:07:25,467 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:07:25,529 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,529 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:07:25
File: selled_stock_drug_only_20251127_100724.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:07:25,541 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_100724.csv
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_100724.csv...
2025-11-27 10:07:25,541 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_100725.csv
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:07:25,586 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:25,586 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_100725.csv
2025-11-27 10:07:25,587 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_100725.csv by branches...
2025-11-27 10:07:25,587 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:07:25,623 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:07:28,374 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_100725_asherin.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_100725_wardani.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_100725_akba.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_100725_shahid.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_100725_nujum.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_100725_admin.csv
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.70 writes=0.29 total=2.79
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:07:28,375 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:07:28,375 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:07:28,712 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_100725_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_100725_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:07:28,713 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_100725_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_100725_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_100725_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_100725_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:07:28,714 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:07:28,714 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:07:28,848 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:07:28,848 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:07:28,849 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:07:29,531 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:07:29,531 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:07:30,142 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:07:30,768 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:07:31,354 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:07:31,942 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:07:32,534 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:07:33,114 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:07:33,114 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:07:33,509 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:07:33,509 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:20:15,897 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:20:15,898 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:20:15,899 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:20:15,900 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:20:15,901 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:20:15,902 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:20:15,902 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:16,454 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:20:18,109 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:20:18,110 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:20:19,831 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:20:19,831 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:19,831 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:20:19,832 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:20:19,832 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:20:20,990 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:20,991 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:20:20,991 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102020/output
2025-11-27 10:20:20,995 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102020
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:20:21,052 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102020.zip...
2025-11-27 10:20:21,262 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102020.zip
2025-11-27 10:20:21,265 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:20:21,265 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:20:21,265 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:20:21,266 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:20:21,272 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:20:21,272 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:20:21,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:20:21,272 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,730 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:20:21,730 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:20:21,731 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:20:21,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:20:21,731 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:20:21,732 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,776 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:20:21,777 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,777 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:20:21
File: selled_stock_drug_only_20251127_102021.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:20:21,786 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102021.csv
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102021.csv...
2025-11-27 10:20:21,786 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102021.csv
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:20:21,829 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102021.csv
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102021.csv by branches...
2025-11-27 10:20:21,829 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:20:21,864 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102021_asherin.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102021_wardani.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102021_akba.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102021_shahid.csv
2025-11-27 10:20:24,571 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102021_nujum.csv
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102021_admin.csv
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.68 writes=0.30 total=2.74
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:20:24,572 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:20:24,572 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102021_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:20:24,907 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102021_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102021_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102021_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102021_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102021_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:20:24,908 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:20:24,908 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:20:25,042 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:20:25,042 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:20:25,043 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:20:25,725 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:20:25,725 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:20:26,329 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:20:26,934 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:20:27,521 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:20:28,106 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:20:28,718 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:20:29,332 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:20:29,332 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:20:29,739 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:20:29,739 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:25:46,590 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:25:46,590 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:25:46,591 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:25:46,592 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:51,512 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:25:52,865 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:25:52,866 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:25:55,163 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:25:55,164 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:25:55,164 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:25:56,235 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:25:56,235 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:25:56,236 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,236 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:25:56,237 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102556/output
2025-11-27 10:25:56,241 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102556
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:25:56,300 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102556.zip...
2025-11-27 10:25:56,513 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102556.zip
2025-11-27 10:25:56,515 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:25:56,515 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:25:56,515 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:25:56,516 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:25:56,521 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:25:56,521 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:25:56,521 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:25:56,521 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,522 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:25:56,522 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:56,968 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:25:56,968 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:56,968 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:25:56,969 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:25:57,018 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,018 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:25:57
File: selled_stock_drug_only_20251127_102556.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:25:57,027 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102556.csv
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102556.csv...
2025-11-27 10:25:57,027 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102557.csv
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:25:57,070 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:57,070 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102557.csv
2025-11-27 10:25:57,071 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102557.csv by branches...
2025-11-27 10:25:57,071 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:25:57,106 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:25:59,836 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102557_asherin.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102557_wardani.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102557_akba.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102557_shahid.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102557_nujum.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102557_admin.csv
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.68 writes=0.30 total=2.77
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:25:59,837 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:25:59,837 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102557_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102557_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102557_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102557_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102557_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102557_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:26:00,179 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:26:00,180 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:26:00,180 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:26:00,320 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:26:00,320 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:26:00,321 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:26:01,001 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:26:01,001 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:26:01,635 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:26:02,239 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:26:02,824 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:26:03,406 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:26:04,007 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:26:04,584 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:26:04,584 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:26:04,981 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:26:04,981 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:26:04,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:27:48,077 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:27:48,078 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:50,581 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:27:51,989 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:27:51,990 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:27:51,991 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:27:53,314 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:27:53,314 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:27:53,315 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:27:54,357 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:27:54,358 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:27:54,358 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:54,359 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:27:54,359 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:27:54,359 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:27:54,360 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_102754/output
2025-11-27 10:27:54,365 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:27:54,415 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:27:54,415 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_102754
2025-11-27 10:27:54,416 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:27:54,416 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_102754.zip...
2025-11-27 10:27:54,624 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_102754.zip
2025-11-27 10:27:54,627 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.37 MB
2025-11-27 10:27:54,627 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:27:54,627 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:27:54,627 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:27:54,634 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:27:54,634 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:27:54,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:27:54,634 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,097 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:27:55,098 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:27:55,098 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:27:55,099 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:27:55,142 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,142 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:27:55,151 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:27:55
File: selled_stock_drug_only_20251127_102754.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:27:55,151 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:27:55,151 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:27:55,152 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_102754.csv
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_102754.csv...
2025-11-27 10:27:55,152 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_102755.csv
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:27:55,194 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:55,194 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_102755.csv
2025-11-27 10:27:55,195 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_102755.csv by branches...
2025-11-27 10:27:55,195 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:27:55,229 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_102755_asherin.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_102755_wardani.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_102755_akba.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_102755_shahid.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_102755_nujum.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_102755_admin.csv
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.03 allocation=0.18 surplus=1.69 writes=0.30 total=2.76
2025-11-27 10:27:57,955 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:27:57,955 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:27:57,956 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:27:58,301 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_102755_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_102755_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_102755_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_102755_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_102755_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_102755_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:27:58,302 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:27:58,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:27:58,303 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:27:58,458 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:27:58,458 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:27:58,459 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:27:59,165 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:27:59,166 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:27:59,166 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:27:59,808 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:28:00,421 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:28:01,021 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:28:01,601 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:28:02,198 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:28:02,777 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:28:02,777 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:28:03,170 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:28:03,171 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:28:03,171 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:31:24,507 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:31:24,508 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:31:24,509 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:31:24,510 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:31:24,511 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:31:24,512 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:25,064 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:31:26,641 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:31:26,642 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:31:27,842 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:31:27,842 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:27,842 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:31:27,842 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:31:27,843 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:31:28,658 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:31:28,659 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-11-27 10:31:28,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:28,659 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:31:28,660 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_103128/output
2025-11-27 10:31:28,666 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_103128
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:31:28,698 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_103128.zip...
2025-11-27 10:31:28,907 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_103128.zip
2025-11-27 10:31:28,909 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.38 MB
2025-11-27 10:31:28,909 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:31:28,909 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:31:28,910 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:31:28,916 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:31:28,916 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-11-27 10:31:28,916 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:31:28,916 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-11-27 10:31:29,369 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,369 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:31:29,370 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-11-27 10:31:29,419 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,419 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:31:29
File: selled_stock_drug_only_20251127_103128.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-11-27 10:31:29,428 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_103128.csv
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_103128.csv...
2025-11-27 10:31:29,428 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:31:29,474 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_103129.csv
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-11-27 10:31:29,475 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_103129.csv
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_103129.csv by branches...
2025-11-27 10:31:29,475 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:31:29,511 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_103129_asherin.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_103129_wardani.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_103129_akba.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_103129_shahid.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_103129_nujum.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_103129_admin.csv
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.30 total=2.83
2025-11-27 10:31:32,303 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-11-27 10:31:32,303 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:31:32,304 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_103129_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_103129_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_103129_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_103129_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_103129_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_103129_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:31:32,645 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type
2025-11-27 10:31:32,645 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:31:32,646 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:31:32,801 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Convert Split Files to Excel
2025-11-27 10:31:32,802 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:31:32,802 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:31:33,501 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Remaining Surplus Files
2025-11-27 10:31:33,501 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:31:34,130 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:31:34,781 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:31:35,405 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:31:36,014 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:31:36,653 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:31:37,270 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:31:37,271 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:31:37,662 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:31:37,663 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:40:49,387 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:40:49,388 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:40:49,389 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:40:49,390 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:40:49,391 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:55,304 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:40:56,776 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:40:56,777 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:41:00,106 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:41:00,110 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:41:00,110 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:41:01,113 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:41:01,114 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:41:01,114 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,115 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:41:01,115 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:41:01,116 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:41:01,116 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104101/output
2025-11-27 10:41:01,121 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104101
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver |   - Archived 410 files in 96 directories
2025-11-27 10:41:01,179 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104101.zip...
2025-11-27 10:41:01,389 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104101.zip
2025-11-27 10:41:01,391 | INFO     | src.app.pipeline.step_1.handler | Archive created: 410 files, 96 dirs | Size: 9.38 MB
2025-11-27 10:41:01,391 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.20 MB (65.9% compression)
2025-11-27 10:41:01,391 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:41:01,392 | INFO     | src.shared.utils.archiver |   Found 410 files in 96 directories to delete
2025-11-27 10:41:01,398 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:41:01,398 | INFO     | src.shared.utils.archiver |   ✓ Deleted 410 files and 96 directories
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:41:01,398 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:41:01,398 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:41:01,847 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,847 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:41:01,848 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:41:01,904 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,904 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:41:01
File: selled_stock_drug_only_20251127_104101.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:41:01,914 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104101.csv
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104101.csv...
2025-11-27 10:41:01,914 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104101.csv
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:41:01,970 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:01,970 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104101.csv
2025-11-27 10:41:01,971 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104101.csv by branches...
2025-11-27 10:41:01,971 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:41:02,006 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:41:04,754 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104101_asherin.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104101_wardani.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104101_akba.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104101_shahid.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104101_nujum.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104101_admin.csv
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.70 writes=0.30 total=2.78
2025-11-27 10:41:04,755 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:41:04,755 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:41:04,756 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104101_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:41:05,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104101_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104101_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104101_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104101_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104101_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:41:05,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:41:05,102 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:41:05,266 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:41:05,266 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:41:05,267 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:41:06,003 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:41:06,003 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:06,611 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:41:07,224 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:41:07,814 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:41:08,416 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:41:09,002 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:41:09,598 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:41:09,599 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:41:10,008 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:41:10,009 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:41:10,009 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:41:10,009 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:41:10,634 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:41:10,643 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:41:10,721 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:41:10,722 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:41:10,722 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:44:22,112 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:44:22,113 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:44:22,114 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:44:22,115 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:22,863 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:44:23,923 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:44:23,923 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:44:23,924 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:44:27,526 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:44:27,529 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:27,529 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:44:27,530 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:44:27,530 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:44:28,478 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:44:28,478 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:44:28,479 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:28,479 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:44:28,480 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104428/output
2025-11-27 10:44:28,486 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104428
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:44:28,544 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104428.zip...
2025-11-27 10:44:28,756 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104428.zip
2025-11-27 10:44:28,758 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.53 MB
2025-11-27 10:44:28,758 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.32 MB (65.2% compression)
2025-11-27 10:44:28,758 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:44:28,759 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:44:28,765 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:44:28,765 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:44:28,765 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:44:28,765 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:44:29,233 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:44:29,233 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:44:29,234 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,277 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:44:29,277 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,277 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,278 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,278 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:44:29,286 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:44:29
File: selled_stock_drug_only_20251127_104428.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:44:29,287 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104428.csv
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104428.csv...
2025-11-27 10:44:29,287 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104429.csv
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:44:29,331 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104429.csv
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104429.csv by branches...
2025-11-27 10:44:29,331 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:44:29,369 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104429_asherin.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104429_wardani.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104429_akba.csv
2025-11-27 10:44:32,163 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104429_shahid.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104429_nujum.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104429_admin.csv
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.30 total=2.83
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:44:32,164 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:44:32,164 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:44:32,521 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104429_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:44:32,522 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104429_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104429_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104429_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104429_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104429_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:44:32,523 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:44:32,523 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:44:32,689 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:44:32,689 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:44:32,690 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:44:32,690 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:44:32,690 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:44:33,446 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:44:33,446 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:34,071 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:44:34,731 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:44:35,341 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:44:35,957 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:44:36,590 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:44:37,196 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:44:37,197 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:44:37,616 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:44:37,616 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:44:37,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:44:37,617 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:44:38,384 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:44:38,396 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:44:38,590 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:44:38,591 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:44:38,591 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:16,547 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:16,548 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:16,549 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:16,550 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:16,551 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:18,466 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:48:18,466 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:18,466 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:48:18,467 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:48:18,467 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:48:19,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,170 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:48:19,170 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:48:19,171 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:48:19,171 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104819/output
2025-11-27 10:48:19,176 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104819
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:48:19,233 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104819.zip...
2025-11-27 10:48:19,444 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104819.zip
2025-11-27 10:48:19,447 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.59 MB
2025-11-27 10:48:19,447 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.36 MB (65.0% compression)
2025-11-27 10:48:19,447 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:48:19,448 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:48:19,454 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:48:19,454 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:48:19,454 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:48:19,454 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,858 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:48:19,858 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:48:19,859 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:48:19,859 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:19,859 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,904 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:48:19,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,905 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:48:19
File: selled_stock_drug_only_20251127_104819.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:48:19,917 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104819.csv
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104819.csv...
2025-11-27 10:48:19,917 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104819.csv
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:48:19,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104819.csv
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104819.csv by branches...
2025-11-27 10:48:19,975 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:48:20,014 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104819_asherin.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104819_wardani.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104819_akba.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104819_shahid.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104819_nujum.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104819_admin.csv
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:48:22,898 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.19 surplus=1.72 writes=0.32 total=2.92
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:48:22,899 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:48:22,899 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104819_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:48:23,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104819_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104819_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104819_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104819_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104819_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:48:23,245 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:48:23,245 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:48:23,411 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:48:23,411 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:48:23,412 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:48:24,094 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:48:24,094 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:24,708 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:48:25,343 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:48:25,970 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:48:26,596 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:48:27,227 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:48:27,846 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:48:27,846 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:48:28,289 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:48:28,290 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:28,290 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:48:28,290 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:48:28,979 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:48:28,990 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:48:29,146 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:48:29,147 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:48:29,147 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:31,347 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:31,348 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:31,349 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:31,350 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:31,351 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:31,352 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:31,352 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:32,138 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:48:33,390 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:48:33,391 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:48:34,682 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:48:34,682 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:34,682 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:48:34,683 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:48:34,683 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:48:35,304 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:48:35,305 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:48:35,305 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:35,306 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:48:35,306 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:48:35,307 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:48:35,307 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_104835/output
2025-11-27 10:48:35,313 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_104835
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 10:48:35,365 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_104835.zip...
2025-11-27 10:48:35,580 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_104835.zip
2025-11-27 10:48:35,582 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.59 MB
2025-11-27 10:48:35,582 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.36 MB (65.0% compression)
2025-11-27 10:48:35,582 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:48:35,583 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 10:48:35,589 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:48:35,589 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 10:48:35,589 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:48:35,589 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:35,590 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:48:35,590 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:48:36,062 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,062 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:48:36,063 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,106 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:48:36,107 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,107 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:48:36
File: selled_stock_drug_only_20251127_104835.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:48:36,116 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_104835.csv
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_104835.csv...
2025-11-27 10:48:36,116 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_104836.csv
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:48:36,159 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:36,159 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_104836.csv
2025-11-27 10:48:36,160 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_104836.csv by branches...
2025-11-27 10:48:36,160 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:48:36,204 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_104836_asherin.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_104836_wardani.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_104836_akba.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_104836_shahid.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_104836_nujum.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_104836_admin.csv
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:48:39,157 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.83 writes=0.31 total=3.00
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:48:39,158 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:48:39,158 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_104836_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:48:39,510 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_104836_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_104836_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_104836_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_104836_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_104836_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:48:39,511 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:48:39,511 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:48:39,666 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:48:39,666 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:48:39,667 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:48:40,401 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:48:40,401 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:41,027 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:48:41,693 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:48:42,290 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:48:42,900 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:48:43,512 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:48:44,132 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:48:44,133 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:48:44,535 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:48:44,535 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:48:45,178 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:48:45,187 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:48:45,343 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:48:45,344 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:48:45,344 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:18,879 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:18,884 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:18,885 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:18,886 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:18,887 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:18,888 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:18,889 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:19,293 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 10:51:20,720 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:20,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:22,529 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Shortage Files
2025-11-27 10:51:22,529 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-11-27 10:51:22,529 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:51:22,529 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:51:23,250 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:51:23,260 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:51:23,467 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:51:23,467 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:51:28,022 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:28,025 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 10:51:28,026 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 10:51:28,027 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 10:51:28,028 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 10:51:31,454 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 10:51:31,455 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 10:51:31,456 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 10:51:32,573 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:32,574 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 10:51:32,575 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_105132/output
2025-11-27 10:51:32,581 | INFO     | src.shared.utils.archiver |   Found 438 files in 98 directories
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_105132
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver |   - Archived 438 files in 98 directories
2025-11-27 10:51:32,642 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_105132.zip...
2025-11-27 10:51:32,863 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_105132.zip
2025-11-27 10:51:32,865 | INFO     | src.app.pipeline.step_1.handler | Archive created: 438 files, 98 dirs | Size: 9.82 MB
2025-11-27 10:51:32,865 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.53 MB (64.1% compression)
2025-11-27 10:51:32,865 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 10:51:32,866 | INFO     | src.shared.utils.archiver |   Found 438 files in 98 directories to delete
2025-11-27 10:51:32,872 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 10:51:32,872 | INFO     | src.shared.utils.archiver |   ✓ Deleted 438 files and 98 directories
2025-11-27 10:51:32,872 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 10:51:32,872 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:32,873 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 10:51:32,873 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 10:51:33,277 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,277 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 10:51:33,278 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,322 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 10:51:33,322 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,323 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 10:51:33
File: selled_stock_drug_only_20251127_105132.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 10:51:33,333 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_105132.csv
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_105132.csv...
2025-11-27 10:51:33,333 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_105133.csv
2025-11-27 10:51:33,377 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/renamed
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 10:51:33,377 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_105133.csv
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_105133.csv by branches...
2025-11-27 10:51:33,378 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 10:51:33,420 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 10:51:36,414 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_105133_asherin.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_105133_wardani.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_105133_akba.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_105133_shahid.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_105133_nujum.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_105133_admin.csv
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/analytics
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.20 surplus=1.86 writes=0.31 total=3.04
2025-11-27 10:51:36,415 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 10:51:36,415 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 10:51:36,416 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_admin_to_akba.csv (8.7 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_105133_from_akba_to_admin.csv (114.0 B)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_105133_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_105133_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_105133_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_105133_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_105133_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 10:51:36,793 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers
2025-11-27 10:51:36,793 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 10:51:36,794 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 10:51:36,794 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 10:51:36,794 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 10:51:36,958 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 10:51:36,959 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 10:51:36,959 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 10:51:37,680 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers_excel
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 10:51:37,680 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:38,326 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 10:51:38,971 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 10:51:39,588 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 10:51:40,201 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 10:51:40,816 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 10:51:41,426 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 10:51:41,427 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 10:51:41,843 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus_csv (organized by branch)
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus_excel (organized by branch)
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 10:51:41,844 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 10:51:41,844 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 10:51:42,574 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 10:51:42,584 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 10:51:42,754 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage_csv
2025-11-27 10:51:42,755 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage_excel
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 10:51:42,755 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:16,260 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 11:14:16,261 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 11:14:16,262 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 11:14:16,263 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 11:14:16,264 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 11:14:16,265 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:17,179 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-11-27 11:14:18,292 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 11:14:18,293 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 11:14:21,435 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-11-27 11:14:21,436 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:21,436 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-11-27 11:14:21,436 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-11-27 11:14:21,437 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-11-27 11:14:22,459 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-11-27 11:14:22,459 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-11-27 11:14:22,460 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:22,460 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-11-27 11:14:22,461 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251127_111422/output
2025-11-27 11:14:22,467 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251127_111422
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 98 directories
2025-11-27 11:14:22,498 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251127_111422.zip...
2025-11-27 11:14:22,721 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251127_111422.zip
2025-11-27 11:14:22,723 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 98 dirs | Size: 9.60 MB
2025-11-27 11:14:22,723 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-11-27 11:14:22,723 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-11-27 11:14:22,724 | INFO     | src.shared.utils.archiver |   Found 424 files in 98 directories to delete
2025-11-27 11:14:22,731 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-11-27 11:14:22,731 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 98 directories
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-11-27 11:14:22,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-11-27 11:14:22,731 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,181 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-11-27 11:14:23,181 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-11-27 11:14:23,182 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-11-27 11:14:23,182 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-11-27 11:14:23,182 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-11-27 11:14:23,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,228 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-11-27 11:14:23
File: selled_stock_drug_only_20251127_111422.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-11-27 11:14:23,238 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251127_111422.csv
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251127_111422.csv...
2025-11-27 11:14:23,238 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251127_111423.csv
2025-11-27 11:14:23,283 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-11-27 11:14:23,283 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251127_111423.csv
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251127_111423.csv by branches...
2025-11-27 11:14:23,284 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-11-27 11:14:23,320 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251127_111423_asherin.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251127_111423_wardani.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251127_111423_akba.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251127_111423_shahid.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251127_111423_nujum.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251127_111423_admin.csv
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.18 surplus=1.71 writes=0.32 total=2.83
2025-11-27 11:14:26,109 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-11-27 11:14:26,110 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-11-27 11:14:26,110 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_admin_to_akba.csv (8.7 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_admin_to_asherin.csv (8.1 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_admin_to_nujum.csv (5.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_admin_to_shahid.csv (10.2 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_admin_to_wardani.csv (5.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251127_111423_from_akba_to_admin.csv (114.0 B)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_akba_to_asherin.csv (3.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_akba_to_nujum.csv (3.6 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_akba_to_shahid.csv (3.2 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_akba_to_wardani.csv (2.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_asherin_to_akba.csv (4.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_asherin_to_nujum.csv (4.3 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_asherin_to_shahid.csv (4.0 KB)
2025-11-27 11:14:26,450 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_asherin_to_wardani.csv (2.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_nujum_to_akba.csv (15.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_nujum_to_asherin.csv (12.4 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_nujum_to_shahid.csv (12.9 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_nujum_to_wardani.csv (7.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_shahid_to_akba.csv (4.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_shahid_to_asherin.csv (3.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_shahid_to_nujum.csv (3.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251127_111423_from_shahid_to_wardani.csv (2.9 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251127_111423_from_wardani_to_akba.csv (6.6 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251127_111423_from_wardani_to_asherin.csv (5.7 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251127_111423_from_wardani_to_nujum.csv (6.3 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251127_111423_from_wardani_to_shahid.csv (7.1 KB)
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type
2025-11-27 11:14:26,451 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-11-27 11:14:26,451 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-11-27 11:14:26,614 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Convert Split Files to Excel
2025-11-27 11:14:26,614 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | Converting split CSV files to Excel format...
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | --------------------------------------------------
2025-11-27 11:14:26,615 | INFO     | src.app.pipeline.step_9.handler | Found 149 split CSV files to convert
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler | Generated 149 Excel files:
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - tablets_and_capsules: 26 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - injections: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - syrups: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - creams: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - sachets: 23 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler |   - other: 25 files
2025-11-27 11:14:27,320 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/transfers/excel
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Remaining Surplus Files
2025-11-27 11:14:27,320 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:27,934 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-11-27 11:14:28,577 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-11-27 11:14:29,152 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-11-27 11:14:29,729 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-11-27 11:14:30,308 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-11-27 11:14:30,889 | INFO     | src.app.pipeline.step_10.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-11-27 11:14:30,889 | INFO     | src.app.pipeline.step_10.handler | Converting remaining surplus files to Excel format...
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus CSV files
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Generated 36 remaining surplus Excel files
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Shortage Files
2025-11-27 11:14:31,281 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_11.handler | Calculating shortage products...
2025-11-27 11:14:31,281 | INFO     | src.app.pipeline.step_11.handler | --------------------------------------------------
2025-11-27 11:14:31,978 | INFO     | src.app.pipeline.step_11.handler | Found 1012 products with shortage
2025-11-27 11:14:31,987 | INFO     | src.app.pipeline.step_11.handler | Converting to Excel format...
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Generated shortage files:
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - tablets_and_capsules: 484 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - injections: 68 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - syrups: 47 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - creams: 105 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - sachets: 21 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - other: 287 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler |   - all (combined): 1012 products
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Total shortage quantity: 5617 units
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | 
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | CSV files saved to: data/output/shortage/csv
2025-11-27 11:14:32,154 | INFO     | src.app.pipeline.step_11.handler | Excel files saved to: data/output/shortage/excel
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 11:14:32,154 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-11-27 11:14:32,155 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | 
==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-11-27 16:43:00,111 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display |   0. Exit
2025-11-27 16:43:00,112 | INFO     | src.app.cli.ui.display | ==================================================
2025-11-27 16:43:00,437 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type
2025-12-02 22:04:51,808 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories: tablets_and_capsules, injections, syrups, creams, sachets, other
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   9. Convert Split Files to Excel
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Convert all split CSV files from step 8 to Excel format in separate directories
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   10. Generate Remaining Surplus Files
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   11. Generate Shortage Files
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:04:51,809 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:07:02,770 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:11:49,143 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:12:02,391 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-02 22:12:02,391 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:12:02,391 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-02 22:12:02,391 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-02 22:12:02,392 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-02 22:12:03,831 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-02 22:12:03,832 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-02 22:12:03,832 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:03,832 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-02 22:12:03,832 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251202_221203/output
2025-12-02 22:12:03,834 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251202_221203
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 103 directories
2025-12-02 22:12:03,856 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251202_221203.zip...
2025-12-02 22:12:04,078 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251202_221203.zip
2025-12-02 22:12:04,080 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 103 dirs | Size: 9.60 MB
2025-12-02 22:12:04,080 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-12-02 22:12:04,080 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-02 22:12:04,081 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories to delete
2025-12-02 22:12:04,086 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-02 22:12:04,086 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 103 directories
2025-12-02 22:12:04,086 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-02 22:12:04,086 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,087 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251115_073133.xlsx
2025-12-02 22:12:04,087 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-02 22:12:04,548 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-02 22:12:04,548 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-02 22:12:04,549 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,602 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-02 22:12:04,603 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,603 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-02 22:12:04
File: selled_stock_drug_only_20251202_221204.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-02 22:12:04,612 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_20251202_221204.csv
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251202_221204.csv...
2025-12-02 22:12:04,612 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251202_221204.csv
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-02 22:12:04,658 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:04,658 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_drug_only_renamed_20251202_221204.csv
2025-12-02 22:12:04,659 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251202_221204.csv by branches...
2025-12-02 22:12:04,659 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-02 22:12:04,709 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251202_221204_asherin.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251202_221204_wardani.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251202_221204_akba.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251202_221204_shahid.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251202_221204_nujum.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251202_221204_admin.csv
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.19 surplus=1.68 writes=0.29 total=2.77
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-02 22:12:07,430 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-02 22:12:07,430 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-02 22:12:07,755 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_admin_to_akba.csv (8.7 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_admin_to_asherin.csv (8.1 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_admin_to_nujum.csv (5.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_admin_to_shahid.csv (10.2 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_admin_to_wardani.csv (5.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251202_221204_from_akba_to_admin.csv (114.0 B)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_akba_to_asherin.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_akba_to_nujum.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_akba_to_shahid.csv (3.2 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_akba_to_wardani.csv (2.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_asherin_to_akba.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_asherin_to_nujum.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_asherin_to_shahid.csv (4.0 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_asherin_to_wardani.csv (2.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_nujum_to_akba.csv (15.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_nujum_to_asherin.csv (12.4 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_nujum_to_shahid.csv (12.9 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_nujum_to_wardani.csv (7.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_shahid_to_akba.csv (4.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_shahid_to_asherin.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_shahid_to_nujum.csv (3.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251202_221204_from_shahid_to_wardani.csv (2.9 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251202_221204_from_wardani_to_akba.csv (6.6 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251202_221204_from_wardani_to_asherin.csv (5.7 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251202_221204_from_wardani_to_nujum.csv (6.3 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251202_221204_from_wardani_to_shahid.csv (7.1 KB)
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:12:07,756 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:07,756 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-02 22:12:07,757 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-02 22:12:07,757 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-02 22:12:07,918 | INFO     | src.app.pipeline.step_8.handler | Found 149 split CSV files to convert
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler | Generated 149 Excel files:
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-02 22:12:08,634 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-02 22:12:08,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:09,284 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-12-02 22:12:09,915 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-12-02 22:12:10,517 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-12-02 22:12:11,114 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-12-02 22:12:11,709 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-12-02 22:12:12,321 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-12-02 22:12:12,322 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-02 22:12:12,716 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-02 22:12:12,716 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-02 22:12:12,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-02 22:12:12,717 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-02 22:12:13,434 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-02 22:12:13,443 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-02 22:12:13,613 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-02 22:12:13,614 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-02 22:12:13,614 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-02 22:40:28,986 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-02 22:40:28,986 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-02 22:40:28,987 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-02 22:40:28,988 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-02 22:40:28,989 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-02 22:40:28,990 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-02 22:40:28,991 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-02 22:40:29,822 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-03 07:26:44,813 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:26:44,814 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:26:51,625 | INFO     | src.app.cli.executors.step_executor | Executing: Generate Shortage Files
2025-12-03 07:26:51,625 | INFO     | src.app.cli.executors.step_executor | --------------------------------------------------
2025-12-03 07:26:51,626 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-03 07:26:51,626 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-03 07:26:52,341 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-03 07:26:52,351 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-03 07:26:52,583 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-03 07:26:52,584 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:39:08,156 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:39:08,157 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:08,158 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:39:08,159 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:08,530 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 07:39:10,431 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 07:39:12,579 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | Running steps 1 through 10 (Total: 10 steps)
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | [1/10] Executing: Archive Previous Output
2025-12-03 07:39:12,580 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:12,580 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-03 07:39:12,580 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251203_073912/output
2025-12-03 07:39:12,581 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251203_073912
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver |   - Archived 424 files in 103 directories
2025-12-03 07:39:12,604 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251203_073912.zip...
2025-12-03 07:39:12,816 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251203_073912.zip
2025-12-03 07:39:12,818 | INFO     | src.app.pipeline.step_1.handler | Archive created: 424 files, 103 dirs | Size: 9.60 MB
2025-12-03 07:39:12,818 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (64.9% compression)
2025-12-03 07:39:12,818 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-03 07:39:12,819 | INFO     | src.shared.utils.archiver |   Found 424 files in 103 directories to delete
2025-12-03 07:39:12,825 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-03 07:39:12,825 | INFO     | src.shared.utils.archiver |   ✓ Deleted 424 files and 103 directories
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | [2/10] Executing: Convert Excel to CSV
2025-12-03 07:39:12,825 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector | Available Excel files:
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_all.xlsx
2025-12-03 07:39:12,825 | INFO     | src.app.pipeline.utils.file_selector |   2. selled_stock_drug_only_20251115_073133.xlsx
2025-12-03 07:39:29,662 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_drug_only_20251115_073133.xlsx to selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | [3/10] Executing: Validate Data
2025-12-03 07:39:30,120 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:30,120 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:37,634 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:37,635 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-03 07:39:37,637 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 14/08/2025 07:57 to 14/11/2025 07:57 (>= 3 months)
2025-12-03 07:39:37,638 | INFO     | src.app.pipeline.step_3.handler |     Start: 14/08/2025 07:57, End: 14/11/2025 07:57
2025-12-03 07:39:37,638 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: Column headers validation successful: All headers match expected order
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-03 07:39:37,639 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:37,690 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | [4/10] Executing: Sales Analysis
2025-12-03 07:39:37,690 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:37,690 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:37,691 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:41,615 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:41,615 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-03 07:39:41
File: selled_stock_drug_only_20251203_073929.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,603
Total Columns: 25
Total Cells: 115,075
Filled Cells: 115,075
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | [5/10] Executing: Rename Columns
2025-12-03 07:39:41,631 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:41,631 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_20251203_073929.csv
2025-12-03 07:39:42,948 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_drug_only_20251203_073929.csv...
2025-12-03 07:39:42,948 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_drug_only_renamed_20251203_073942.csv
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | [6/10] Executing: Split by Branches
2025-12-03 07:39:43,012 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.utils.file_selector | Available CSV files:
2025-12-03 07:39:43,012 | INFO     | src.app.pipeline.utils.file_selector |   1. selled_stock_drug_only_renamed_20251203_073942.csv
2025-12-03 07:39:43,849 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_drug_only_renamed_20251203_073942.csv by branches...
2025-12-03 07:39:43,850 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-03 07:39:43,902 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4603 products
2025-12-03 07:39:46,584 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_drug_only_20251203_073943_asherin.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_drug_only_20251203_073943_wardani.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_drug_only_20251203_073943_akba.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_drug_only_20251203_073943_shahid.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_drug_only_20251203_073943_nujum.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_drug_only_20251203_073943_admin.csv
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.18 surplus=1.66 writes=0.28 total=2.73
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4603 branches=6
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | [7/10] Executing: Generate Transfer Files
2025-12-03 07:39:46,585 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-03 07:39:46,585 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-03 07:39:46,902 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_admin_to_akba.csv (8.7 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_admin_to_asherin.csv (8.1 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_admin_to_nujum.csv (5.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_admin_to_shahid.csv (10.2 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_admin_to_wardani.csv (5.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_drug_only_20251203_073943_from_akba_to_admin.csv (114.0 B)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_akba_to_asherin.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_akba_to_nujum.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_akba_to_shahid.csv (3.2 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_akba_to_wardani.csv (2.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_asherin_to_akba.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_asherin_to_nujum.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_asherin_to_shahid.csv (4.0 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_asherin_to_wardani.csv (2.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_nujum_to_akba.csv (15.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_nujum_to_asherin.csv (12.4 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_nujum_to_shahid.csv (12.9 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_nujum_to_wardani.csv (7.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_shahid_to_akba.csv (4.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_shahid_to_asherin.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_shahid_to_nujum.csv (3.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_drug_only_20251203_073943_from_shahid_to_wardani.csv (2.9 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_drug_only_20251203_073943_from_wardani_to_akba.csv (6.6 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_drug_only_20251203_073943_from_wardani_to_asherin.csv (5.7 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_drug_only_20251203_073943_from_wardani_to_nujum.csv (6.3 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_drug_only_20251203_073943_from_wardani_to_shahid.csv (7.1 KB)
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | [8/10] Executing: Split Transfer Files by Product Type & Convert to Excel
2025-12-03 07:39:46,903 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-03 07:39:46,903 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Generated 149 split files:
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-03 07:39:47,064 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-03 07:39:47,065 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-03 07:39:47,065 | INFO     | src.app.pipeline.step_8.handler | Found 149 split CSV files to convert
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler | Generated 149 Excel files:
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-03 07:39:47,741 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-03 07:39:47,742 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-03 07:39:47,742 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | [9/10] Executing: Generate Remaining Surplus Files
2025-12-03 07:39:47,742 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:48,358 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1342 products in 6 categories
2025-12-03 07:39:48,957 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1759 products in 6 categories
2025-12-03 07:39:49,551 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1508 products in 6 categories
2025-12-03 07:39:50,152 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1591 products in 6 categories
2025-12-03 07:39:50,763 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2557 products in 6 categories
2025-12-03 07:39:51,368 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1596 products in 6 categories
2025-12-03 07:39:51,368 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-03 07:39:51,757 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | [10/10] Executing: Generate Shortage Files
2025-12-03 07:39:51,758 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-03 07:39:51,758 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-03 07:39:51,758 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-03 07:39:52,457 | INFO     | src.app.pipeline.step_10.handler | Found 1012 products with shortage
2025-12-03 07:39:52,466 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 484 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - injections: 68 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 47 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - creams: 105 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 21 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - other: 287 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1012 products
2025-12-03 07:39:52,629 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 5617 units
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-03 07:39:52,630 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | 
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ✓ SUCCESS: All 10 steps completed successfully!
2025-12-03 07:39:52,630 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-03 09:04:09,827 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-03 09:04:09,828 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-03 09:04:10,215 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 15:42:46,864 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 15:42:46,864 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 15:42:46,864 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:42:46,864 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 15:42:46,864 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 15:42:46,865 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:42:49,601 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 15:42:49,601 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:42:49,601 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 15:42:49,601 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 15:42:49,601 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 15:42:51,350 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 15:42:51,350 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 15:42:51,351 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:51,352 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 15:42:51,352 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 15:42:51,353 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 15:42:51,353 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_154251/output
2025-12-05 15:42:51,353 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-05 15:42:51,356 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 15:42:51,356 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_154251
2025-12-05 15:42:51,356 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-05 15:42:51,356 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_154251.zip...
2025-12-05 15:42:51,415 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_154251.zip
2025-12-05 15:42:51,416 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 1.70 MB
2025-12-05 15:42:51,416 | INFO     | src.app.pipeline.step_1.handler | ZIP: 472.85 KB (72.9% compression)
2025-12-05 15:42:51,416 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 15:42:51,416 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-05 15:42:51,416 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 15:42:51,416 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-05 15:42:51,417 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 15:42:51,417 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 15:42:51,417 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 15:42:51,417 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:51,514 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-05 15:42:51,514 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251205_154251.csv...
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 15:42:52,089 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 15:42:52,089 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 15:42:52,089 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154251.csv
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251205_154251.csv...
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 15:42:52,089 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 15:42:52,090 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 15:42:52,090 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 15:42:52,090 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 15:42:52,090 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251205_154251.csv...
2025-12-05 15:42:52,144 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 15:42:52,144 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 15:42:52,144 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 15:42:52,144 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,144 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154251.csv
2025-12-05 15:42:52,144 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251205_154251.csv...
2025-12-05 15:42:52,144 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 15:42:52,156 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 15:42:52
File: selled_stock_all_less_coloum_20251205_154251.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-05 15:42:52,156 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 15:42:52,156 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 15:42:52,156 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,156 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154251.csv
2025-12-05 15:42:52,156 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251205_154251.csv...
2025-12-05 15:42:52,156 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 15:42:52,209 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 15:42:52,209 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251205_154252.csv
2025-12-05 15:42:52,209 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 15:42:52,209 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 15:42:52,209 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 15:42:52,209 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,209 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251205_154252.csv
2025-12-05 15:42:52,210 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251205_154252.csv by branches...
2025-12-05 15:42:52,210 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 15:42:52,210 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 15:42:52,221 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 15:42:52,229 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 15:42:52,238 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 15:42:52,245 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 15:42:52,252 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 15:42:52,259 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 15:42:52,266 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-05 15:42:52,266 | ERROR    | src.services.splitting.branch_splitter | Error splitting CSV: name 'has_date_header' is not defined
Traceback (most recent call last):
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/branch_splitter.py", line 54, in split_csv_by_branches
    branch_data, has_date_header, first_line = prepare_branch_data(csv_path)
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/processors/data_preparer.py", line 131, in prepare_branch_data
    return branch_data, has_date_header, first_line
                        ^^^^^^^^^^^^^^^
NameError: name 'has_date_header' is not defined
2025-12-05 15:42:52,268 | ERROR    | src.app.pipeline.step_6.handler | Error: Error splitting CSV: name 'has_date_header' is not defined
2025-12-05 15:42:52,269 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 6 failed
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,269 | ERROR    | src.app.pipeline.step_7.handler | No analytics files found in data/output/branches/analytics
2025-12-05 15:42:52,269 | ERROR    | src.app.pipeline.step_7.handler | Please run step 5 (Split by Branches) first to generate analytics files
2025-12-05 15:42:52,269 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 7 failed
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,269 | ERROR    | src.app.pipeline.step_8.handler | Transfers directory not found: data/output/transfers/csv
2025-12-05 15:42:52,269 | ERROR    | src.app.pipeline.step_8.handler | Please run step 6 (Generate Transfer Files) first to generate transfer files
2025-12-05 15:42:52,269 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 8 failed
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: asherin
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: wardani
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: akba
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: shahid
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: nujum
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: admin
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_9.handler | No remaining surplus files were created
2025-12-05 15:42:52,269 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 9 failed
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 15:42:52,269 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:42:52,269 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 15:42:52,269 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: asherin
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: wardani
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: akba
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: shahid
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: nujum
2025-12-05 15:42:52,269 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: admin
2025-12-05 15:42:52,270 | INFO     | src.app.pipeline.step_10.handler | No shortage products found. All needs are covered by surplus!
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor |   Successful: 6
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor |   Failed: 4
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 60.0%
2025-12-05 15:42:52,270 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 15:47:47,912 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 15:47:47,913 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 15:47:47,914 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:47:48,629 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 15:47:50,092 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 15:47:50,093 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 15:47:50,093 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:47:51,982 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 15:47:51,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:47:51,982 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 15:47:51,982 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 15:47:51,982 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 15:47:53,101 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 15:47:53,101 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 15:47:53,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,102 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 15:47:53,102 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 15:47:53,102 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 15:47:53,102 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_154753/output
2025-12-05 15:47:53,102 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-05 15:47:53,104 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 15:47:53,104 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_154753
2025-12-05 15:47:53,104 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-05 15:47:53,104 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_154753.zip...
2025-12-05 15:47:53,172 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_154753.zip
2025-12-05 15:47:53,172 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 1.70 MB
2025-12-05 15:47:53,172 | INFO     | src.app.pipeline.step_1.handler | ZIP: 472.85 KB (72.9% compression)
2025-12-05 15:47:53,172 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 15:47:53,172 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-05 15:47:53,172 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 15:47:53,173 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-05 15:47:53,173 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 15:47:53,173 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 15:47:53,173 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 15:47:53,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,271 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-05 15:47:53,271 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251205_154753.csv...
2025-12-05 15:47:53,849 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 15:47:53,849 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 15:47:53,849 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 15:47:53,849 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,849 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154753.csv
2025-12-05 15:47:53,849 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251205_154753.csv...
2025-12-05 15:47:53,849 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 15:47:53,850 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251205_154753.csv...
2025-12-05 15:47:53,905 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 15:47:53,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 15:47:53,905 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 15:47:53,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,905 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154753.csv
2025-12-05 15:47:53,905 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251205_154753.csv...
2025-12-05 15:47:53,905 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 15:47:53,918 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 15:47:53
File: selled_stock_all_less_coloum_20251205_154753.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-05 15:47:53,918 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 15:47:53,918 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 15:47:53,918 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,918 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_154753.csv
2025-12-05 15:47:53,918 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251205_154753.csv...
2025-12-05 15:47:53,918 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 15:47:53,972 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 15:47:53,972 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251205_154753.csv
2025-12-05 15:47:53,972 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 15:47:53,972 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 15:47:53,973 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 15:47:53,973 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:53,973 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251205_154753.csv
2025-12-05 15:47:53,973 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251205_154753.csv by branches...
2025-12-05 15:47:53,973 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 15:47:53,973 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 15:47:53,985 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 15:47:53,993 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 15:47:54,003 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 15:47:54,013 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 15:47:54,023 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 15:47:54,031 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 15:47:54,040 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_all_less_coloum_20251205_154753_asherin.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_all_less_coloum_20251205_154753_wardani.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_all_less_coloum_20251205_154753_akba.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_all_less_coloum_20251205_154753_shahid.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_all_less_coloum_20251205_154753_nujum.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_all_less_coloum_20251205_154753_admin.csv
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.07 allocation=0.30 surplus=2.98 writes=0.44 total=4.76
2025-12-05 15:47:58,736 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=7823 branches=6
2025-12-05 15:47:58,736 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 15:47:58,736 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 15:47:58,736 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:58,737 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 15:47:58,737 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 15:47:58,737 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_154753_from_admin_to_akba.csv (7.3 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_154753_from_admin_to_asherin.csv (7.5 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_154753_from_admin_to_nujum.csv (4.6 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_154753_from_admin_to_shahid.csv (9.2 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_154753_from_admin_to_wardani.csv (4.5 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_154753_from_akba_to_admin.csv (83.0 B)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_154753_from_akba_to_asherin.csv (7.3 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_154753_from_akba_to_nujum.csv (6.5 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_154753_from_akba_to_shahid.csv (6.8 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_154753_from_akba_to_wardani.csv (5.9 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (5 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_154753_from_asherin_to_admin.csv (117.0 B)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_154753_from_asherin_to_akba.csv (9.9 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_154753_from_asherin_to_nujum.csv (9.0 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_154753_from_asherin_to_shahid.csv (8.7 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_154753_from_asherin_to_wardani.csv (5.7 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_154753_from_nujum_to_akba.csv (22.5 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_154753_from_nujum_to_asherin.csv (17.9 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_154753_from_nujum_to_shahid.csv (19.2 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_154753_from_nujum_to_wardani.csv (12.1 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_154753_from_shahid_to_akba.csv (9.8 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_154753_from_shahid_to_asherin.csv (7.3 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_154753_from_shahid_to_nujum.csv (7.7 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_154753_from_shahid_to_wardani.csv (6.9 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_154753_from_wardani_to_akba.csv (13.4 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_154753_from_wardani_to_asherin.csv (9.4 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_154753_from_wardani_to_nujum.csv (10.8 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_154753_from_wardani_to_shahid.csv (10.8 KB)
2025-12-05 15:47:59,184 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 15:47:59,184 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 15:47:59,184 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:47:59,184 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:47:59,185 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 15:47:59,185 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 15:47:59,185 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler | Generated 153 split files:
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 15:47:59,352 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 15:47:59,353 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 15:47:59,353 | INFO     | src.app.pipeline.step_8.handler | Found 153 split CSV files to convert
2025-12-05 15:48:00,109 | INFO     | src.app.pipeline.step_8.handler | Generated 153 Excel files:
2025-12-05 15:48:00,109 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-05 15:48:00,110 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 15:48:00,110 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 15:48:00,110 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 15:48:00,110 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:48:01,059 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1752 products in 6 categories
2025-12-05 15:48:02,020 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 2250 products in 6 categories
2025-12-05 15:48:02,956 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 2003 products in 6 categories
2025-12-05 15:48:03,911 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 2153 products in 6 categories
2025-12-05 15:48:04,851 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 3182 products in 6 categories
2025-12-05 15:48:05,797 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1554 products in 6 categories
2025-12-05 15:48:05,797 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 15:48:06,261 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 15:48:06,262 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 15:48:06,262 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 15:48:06,262 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 15:48:06,262 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 15:48:07,425 | INFO     | src.app.pipeline.step_10.handler | Found 2408 products with shortage
2025-12-05 15:48:07,443 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 569 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - injections: 82 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 63 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - creams: 282 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 31 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - other: 1381 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 2408 products
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 12352 units
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 15:48:07,830 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 15:48:07,831 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 15:49:13,930 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 15:49:13,931 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 15:49:13,932 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 15:49:13,932 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 15:49:13,932 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 15:49:13,932 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 15:49:19,927 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 18:05:45,295 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:05:48,424 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 18:05:48,424 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:05:48,424 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 18:05:48,424 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 18:05:48,424 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 18:05:49,396 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 18:05:49,396 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 18:05:49,397 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:49,397 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 18:05:49,398 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 18:05:49,398 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 18:05:49,398 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_180549/output
2025-12-05 18:05:49,403 | INFO     | src.shared.utils.archiver |   Found 371 files in 87 directories
2025-12-05 18:05:49,443 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 18:05:49,443 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_180549
2025-12-05 18:05:49,443 | INFO     | src.shared.utils.archiver |   - Archived 371 files in 87 directories
2025-12-05 18:05:49,443 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_180549.zip...
2025-12-05 18:05:50,111 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_180549.zip
2025-12-05 18:05:50,113 | INFO     | src.app.pipeline.step_1.handler | Archive created: 371 files, 87 dirs | Size: 40.78 MB
2025-12-05 18:05:50,113 | INFO     | src.app.pipeline.step_1.handler | ZIP: 8.06 MB (80.2% compression)
2025-12-05 18:05:50,113 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 18:05:50,114 | INFO     | src.shared.utils.archiver |   Found 371 files in 87 directories to delete
2025-12-05 18:05:50,121 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 18:05:50,122 | INFO     | src.shared.utils.archiver |   ✓ Deleted 371 files and 87 directories
2025-12-05 18:05:50,122 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 18:05:50,122 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 18:05:50,122 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 18:05:50,122 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:50,221 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-05 18:05:50,221 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251205_180550.csv...
2025-12-05 18:05:50,820 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 18:05:50,820 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 18:05:50,820 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 18:05:50,820 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:50,820 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_180550.csv
2025-12-05 18:05:50,820 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251205_180550.csv...
2025-12-05 18:05:50,820 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:05:50,821 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251205_180550.csv...
2025-12-05 18:05:50,876 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 18:05:50,877 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 18:05:50,877 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 18:05:50,877 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:50,877 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_180550.csv
2025-12-05 18:05:50,877 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251205_180550.csv...
2025-12-05 18:05:50,877 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 18:05:50,889 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 18:05:50
File: selled_stock_all_less_coloum_20251205_180550.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-05 18:05:50,889 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 18:05:50,889 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 18:05:50,889 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:50,889 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_180550.csv
2025-12-05 18:05:50,889 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251205_180550.csv...
2025-12-05 18:05:50,889 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 18:05:50,942 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 18:05:50,942 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251205_180550.csv
2025-12-05 18:05:50,942 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 18:05:50,942 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 18:05:50,942 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 18:05:50,942 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:50,942 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251205_180550.csv
2025-12-05 18:05:50,943 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251205_180550.csv by branches...
2025-12-05 18:05:50,943 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 18:05:50,943 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 18:05:50,955 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 18:05:50,962 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 18:05:50,971 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 18:05:50,978 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 18:05:50,985 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 18:05:50,992 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 18:05:50,999 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-05 18:05:54,258 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-05 18:05:56,780 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.52s (3968 transfers)
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_all_less_coloum_20251205_180550_asherin.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_all_less_coloum_20251205_180550_wardani.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_all_less_coloum_20251205_180550_akba.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_all_less_coloum_20251205_180550_shahid.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_all_less_coloum_20251205_180550_nujum.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_all_less_coloum_20251205_180550_admin.csv
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=0.29 surplus=2.97 writes=0.63 total=7.48
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=7823 branches=6
2025-12-05 18:05:58,419 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 18:05:58,419 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 18:05:58,419 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 18:05:58,419 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler | Generated 28 transfer files:
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_180550_from_admin_to_akba.csv (9.0 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_180550_from_admin_to_asherin.csv (8.4 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_180550_from_admin_to_nujum.csv (5.2 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_180550_from_admin_to_shahid.csv (10.3 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_180550_from_admin_to_wardani.csv (4.9 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_180550_from_akba_to_admin.csv (113.0 B)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_180550_from_akba_to_asherin.csv (11.4 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_180550_from_akba_to_nujum.csv (8.4 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_180550_from_akba_to_shahid.csv (10.5 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_180550_from_akba_to_wardani.csv (8.2 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (5 files):
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_180550_from_asherin_to_admin.csv (117.0 B)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_180550_from_asherin_to_akba.csv (18.7 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_180550_from_asherin_to_nujum.csv (13.6 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_180550_from_asherin_to_shahid.csv (16.7 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_180550_from_asherin_to_wardani.csv (10.3 KB)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (5 files):
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_180550_from_nujum_to_admin.csv (87.0 B)
2025-12-05 18:05:59,190 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_180550_from_nujum_to_akba.csv (25.8 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_180550_from_nujum_to_asherin.csv (20.8 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_180550_from_nujum_to_shahid.csv (22.5 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_180550_from_nujum_to_wardani.csv (13.9 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_180550_from_shahid_to_akba.csv (14.4 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_180550_from_shahid_to_asherin.csv (10.8 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_180550_from_shahid_to_nujum.csv (9.3 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_180550_from_shahid_to_wardani.csv (9.0 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_180550_from_wardani_to_akba.csv (20.8 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_180550_from_wardani_to_asherin.csv (18.6 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_180550_from_wardani_to_nujum.csv (14.2 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_180550_from_wardani_to_shahid.csv (17.8 KB)
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 18:05:59,191 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 18:05:59,191 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:05:59,191 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:05:59,191 | INFO     | src.app.pipeline.step_8.handler | Found 28 transfer files to split
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler | Generated 155 split files:
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 28 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler |   - other: 27 files
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:05:59,367 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 18:05:59,368 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 18:05:59,368 | INFO     | src.app.pipeline.step_8.handler | Found 155 split CSV files to convert
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler | Generated 155 Excel files:
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 28 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler |   - other: 27 files
2025-12-05 18:06:00,233 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 18:06:00,233 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 18:06:00,233 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 18:06:00,233 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:06:01,381 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1189 products in 6 categories
2025-12-05 18:06:02,522 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1617 products in 6 categories
2025-12-05 18:06:03,660 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1694 products in 6 categories
2025-12-05 18:06:04,805 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1838 products in 6 categories
2025-12-05 18:06:05,935 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2771 products in 6 categories
2025-12-05 18:06:07,076 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1353 products in 6 categories
2025-12-05 18:06:07,076 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 18:06:07,481 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 18:06:07,481 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 18:06:07,481 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 18:06:07,481 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 18:06:07,481 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 18:06:07,482 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 18:06:07,482 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 18:06:07,482 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:06:07,482 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 18:06:07,482 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 18:06:08,733 | INFO     | src.app.pipeline.step_10.handler | Found 2408 products with shortage
2025-12-05 18:06:08,751 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 18:06:09,126 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 569 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - injections: 82 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 63 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - creams: 282 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 31 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - other: 1381 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 2408 products
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 12352 units
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 18:06:09,127 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 18:06:09,127 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 18:06:14,464 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 18:06:14,465 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:28:34,598 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 18:28:37,661 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:28:39,504 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 18:28:39,504 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:28:39,504 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 18:28:39,504 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 18:28:39,504 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 18:28:40,949 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 18:28:40,949 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 18:28:40,949 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:40,950 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 18:28:40,950 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 18:28:40,950 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 18:28:40,950 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_182840/output
2025-12-05 18:28:40,951 | INFO     | src.shared.utils.archiver |   Found 450 files in 107 directories
2025-12-05 18:28:40,977 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 18:28:40,977 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_182840
2025-12-05 18:28:40,977 | INFO     | src.shared.utils.archiver |   - Archived 450 files in 107 directories
2025-12-05 18:28:40,977 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_182840.zip...
2025-12-05 18:28:41,489 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_182840.zip
2025-12-05 18:28:41,491 | INFO     | src.app.pipeline.step_1.handler | Archive created: 450 files, 107 dirs | Size: 32.16 MB
2025-12-05 18:28:41,491 | INFO     | src.app.pipeline.step_1.handler | ZIP: 7.14 MB (77.8% compression)
2025-12-05 18:28:41,491 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 18:28:41,492 | INFO     | src.shared.utils.archiver |   Found 450 files in 107 directories to delete
2025-12-05 18:28:41,500 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 18:28:41,500 | INFO     | src.shared.utils.archiver |   ✓ Deleted 450 files and 107 directories
2025-12-05 18:28:41,500 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 18:28:41,500 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 18:28:41,500 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 18:28:41,500 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:41,598 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-05 18:28:41,598 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251205_182841.csv...
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 18:28:42,173 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 18:28:42,173 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 18:28:42,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_182841.csv
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251205_182841.csv...
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-05 18:28:42,173 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:28:42,174 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251205_182841.csv...
2025-12-05 18:28:42,230 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 18:28:42,230 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 18:28:42,230 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 18:28:42,230 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:42,230 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_182841.csv
2025-12-05 18:28:42,230 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251205_182841.csv...
2025-12-05 18:28:42,230 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 18:28:42,242 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 18:28:42
File: selled_stock_all_less_coloum_20251205_182841.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-05 18:28:42,242 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 18:28:42,242 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 18:28:42,242 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:42,243 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_182841.csv
2025-12-05 18:28:42,243 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251205_182841.csv...
2025-12-05 18:28:42,243 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251205_182842.csv
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 18:28:42,298 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 18:28:42,298 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 18:28:42,298 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251205_182842.csv
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251205_182842.csv by branches...
2025-12-05 18:28:42,298 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 18:28:42,298 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 18:28:42,310 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 18:28:42,318 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 18:28:42,327 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 18:28:42,335 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 18:28:42,346 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 18:28:42,356 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 18:28:42,365 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-05 18:28:46,707 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-05 18:28:49,324 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.62s (3977 transfers)
2025-12-05 18:28:51,175 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_all_less_coloum_20251205_182842_asherin.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_all_less_coloum_20251205_182842_wardani.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_all_less_coloum_20251205_182842_akba.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_all_less_coloum_20251205_182842_shahid.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_all_less_coloum_20251205_182842_nujum.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_all_less_coloum_20251205_182842_admin.csv
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.07 allocation=1.24 surplus=3.10 writes=0.72 total=8.88
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=7823 branches=6
2025-12-05 18:28:51,176 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 18:28:51,176 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 18:28:51,176 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 18:28:51,176 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 18:28:51,970 | INFO     | src.app.pipeline.step_7.handler | Generated 28 transfer files:
2025-12-05 18:28:51,970 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 18:28:51,970 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_182842_from_admin_to_akba.csv (8.9 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_182842_from_admin_to_asherin.csv (8.3 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_182842_from_admin_to_nujum.csv (5.2 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_182842_from_admin_to_shahid.csv (10.2 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_182842_from_admin_to_wardani.csv (4.8 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_182842_from_akba_to_admin.csv (113.0 B)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_182842_from_akba_to_asherin.csv (11.2 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_182842_from_akba_to_nujum.csv (8.3 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_182842_from_akba_to_shahid.csv (10.6 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_182842_from_akba_to_wardani.csv (8.3 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (5 files):
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_182842_from_asherin_to_admin.csv (117.0 B)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_182842_from_asherin_to_akba.csv (18.7 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_182842_from_asherin_to_nujum.csv (13.4 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_182842_from_asherin_to_shahid.csv (16.8 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_182842_from_asherin_to_wardani.csv (10.1 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (5 files):
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_182842_from_nujum_to_admin.csv (87.0 B)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_182842_from_nujum_to_akba.csv (25.9 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_182842_from_nujum_to_asherin.csv (20.6 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_182842_from_nujum_to_shahid.csv (22.6 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_182842_from_nujum_to_wardani.csv (13.7 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_182842_from_shahid_to_akba.csv (14.4 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_182842_from_shahid_to_asherin.csv (10.8 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_182842_from_shahid_to_nujum.csv (9.4 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_182842_from_shahid_to_wardani.csv (8.9 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_182842_from_wardani_to_akba.csv (20.5 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_182842_from_wardani_to_asherin.csv (18.2 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_182842_from_wardani_to_nujum.csv (14.3 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_182842_from_wardani_to_shahid.csv (17.8 KB)
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 18:28:51,971 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 18:28:51,971 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:28:51,971 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:28:51,971 | INFO     | src.app.pipeline.step_8.handler | Found 28 transfer files to split
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler | Generated 155 split files:
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 28 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler |   - other: 27 files
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:28:52,153 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 18:28:52,154 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 18:28:52,154 | INFO     | src.app.pipeline.step_8.handler | Found 155 split CSV files to convert
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler | Generated 155 Excel files:
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 28 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler |   - other: 27 files
2025-12-05 18:28:53,024 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 18:28:53,024 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 18:28:53,024 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 18:28:53,024 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:28:54,162 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1187 products in 6 categories
2025-12-05 18:28:55,304 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1616 products in 6 categories
2025-12-05 18:28:56,448 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1694 products in 6 categories
2025-12-05 18:28:57,566 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1839 products in 6 categories
2025-12-05 18:28:58,709 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2772 products in 6 categories
2025-12-05 18:28:59,827 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1354 products in 6 categories
2025-12-05 18:28:59,828 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 18:29:00,211 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 18:29:00,211 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 18:29:00,211 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 18:29:00,211 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 18:29:01,435 | INFO     | src.app.pipeline.step_10.handler | Found 2408 products with shortage
2025-12-05 18:29:01,452 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 569 products
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler |   - injections: 82 products
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 63 products
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler |   - creams: 282 products
2025-12-05 18:29:01,832 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 31 products
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler |   - other: 1381 products
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 2408 products
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 12352 units
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 18:29:01,833 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 18:29:01,833 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:36:32,812 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 18:36:32,812 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 18:36:32,812 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:36:32,812 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 18:36:32,813 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 18:36:32,814 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 18:36:32,815 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 18:36:32,816 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 18:36:32,816 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 18:36:32,816 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 18:36:32,816 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 18:36:32,816 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:36:33,674 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 18:36:35,341 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 18:36:35,342 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 18:36:35,342 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 18:36:36,638 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 18:36:36,638 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:36:36,638 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 18:36:36,638 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 18:36:36,638 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 18:36:37,638 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 18:36:37,638 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 18:36:37,638 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:37,638 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 18:36:37,638 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 18:36:37,638 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 18:36:37,638 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_183637/output
2025-12-05 18:36:37,639 | INFO     | src.shared.utils.archiver |   Found 450 files in 107 directories
2025-12-05 18:36:37,666 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 18:36:37,666 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_183637
2025-12-05 18:36:37,667 | INFO     | src.shared.utils.archiver |   - Archived 450 files in 107 directories
2025-12-05 18:36:37,667 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_183637.zip...
2025-12-05 18:36:38,173 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_183637.zip
2025-12-05 18:36:38,176 | INFO     | src.app.pipeline.step_1.handler | Archive created: 450 files, 107 dirs | Size: 32.15 MB
2025-12-05 18:36:38,176 | INFO     | src.app.pipeline.step_1.handler | ZIP: 7.14 MB (77.8% compression)
2025-12-05 18:36:38,176 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 18:36:38,177 | INFO     | src.shared.utils.archiver |   Found 450 files in 107 directories to delete
2025-12-05 18:36:38,184 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 18:36:38,184 | INFO     | src.shared.utils.archiver |   ✓ Deleted 450 files and 107 directories
2025-12-05 18:36:38,184 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 18:36:38,184 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 18:36:38,184 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 18:36:38,184 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:38,283 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-05 18:36:38,283 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251205_183638.csv...
2025-12-05 18:36:38,864 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 18:36:38,864 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 18:36:38,864 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 18:36:38,864 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:38,864 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_183638.csv
2025-12-05 18:36:38,864 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251205_183638.csv...
2025-12-05 18:36:38,864 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 18:36:38,865 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251205_183638.csv...
2025-12-05 18:36:38,920 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 18:36:38,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 18:36:38,921 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 18:36:38,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:38,921 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_183638.csv
2025-12-05 18:36:38,921 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251205_183638.csv...
2025-12-05 18:36:38,921 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 18:36:38,936 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 18:36:38
File: selled_stock_all_less_coloum_20251205_183638.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-05 18:36:38,936 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 18:36:38,936 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 18:36:38,936 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:38,936 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251205_183638.csv
2025-12-05 18:36:38,936 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251205_183638.csv...
2025-12-05 18:36:38,936 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251205_183638.csv
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 18:36:38,992 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 18:36:38,992 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 18:36:38,992 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251205_183638.csv
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251205_183638.csv by branches...
2025-12-05 18:36:38,992 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 18:36:38,992 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 18:36:39,004 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 18:36:39,012 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 18:36:39,020 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 18:36:39,028 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 18:36:39,035 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 18:36:39,042 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 18:36:39,048 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-05 18:36:43,602 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-05 18:36:46,334 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.73s (3985 transfers)
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_all_less_coloum_20251205_183638_asherin.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_all_less_coloum_20251205_183638_wardani.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_all_less_coloum_20251205_183638_akba.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_all_less_coloum_20251205_183638_shahid.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_all_less_coloum_20251205_183638_nujum.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_all_less_coloum_20251205_183638_admin.csv
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=1.35 surplus=3.20 writes=0.66 total=9.09
2025-12-05 18:36:48,084 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=7823 branches=6
2025-12-05 18:36:48,084 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 18:36:48,084 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 18:36:48,084 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:48,085 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 18:36:48,085 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 18:36:48,085 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_183638_from_admin_to_akba.csv (9.1 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_183638_from_admin_to_asherin.csv (8.2 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_183638_from_admin_to_nujum.csv (5.2 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_183638_from_admin_to_shahid.csv (10.5 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_183638_from_admin_to_wardani.csv (5.0 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_183638_from_akba_to_admin.csv (144.0 B)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_183638_from_akba_to_asherin.csv (11.6 KB)
2025-12-05 18:36:48,890 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_183638_from_akba_to_nujum.csv (8.4 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_183638_from_akba_to_shahid.csv (10.6 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_183638_from_akba_to_wardani.csv (8.1 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_183638_from_asherin_to_akba.csv (19.2 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_183638_from_asherin_to_nujum.csv (13.9 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_183638_from_asherin_to_shahid.csv (15.8 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_183638_from_asherin_to_wardani.csv (10.4 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (5 files):
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251205_183638_from_nujum_to_admin.csv (117.0 B)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_183638_from_nujum_to_akba.csv (25.7 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_183638_from_nujum_to_asherin.csv (20.8 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_183638_from_nujum_to_shahid.csv (22.3 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_183638_from_nujum_to_wardani.csv (13.9 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_183638_from_shahid_to_akba.csv (14.2 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_183638_from_shahid_to_asherin.csv (10.9 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_183638_from_shahid_to_nujum.csv (9.4 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251205_183638_from_shahid_to_wardani.csv (8.8 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251205_183638_from_wardani_to_akba.csv (20.2 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251205_183638_from_wardani_to_asherin.csv (19.4 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251205_183638_from_wardani_to_nujum.csv (13.9 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251205_183638_from_wardani_to_shahid.csv (18.1 KB)
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 18:36:48,891 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 18:36:48,891 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 18:36:48,891 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:36:48,891 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler | Generated 153 split files:
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 18:36:49,074 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 18:36:49,075 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 18:36:49,075 | INFO     | src.app.pipeline.step_8.handler | Found 153 split CSV files to convert
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler | Generated 153 Excel files:
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-05 18:36:49,933 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 18:36:49,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 18:36:49,933 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 18:36:49,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:51,095 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1186 products in 6 categories
2025-12-05 18:36:52,267 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1616 products in 6 categories
2025-12-05 18:36:53,418 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1696 products in 6 categories
2025-12-05 18:36:54,590 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1839 products in 6 categories
2025-12-05 18:36:55,759 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2774 products in 6 categories
2025-12-05 18:36:56,906 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1353 products in 6 categories
2025-12-05 18:36:56,907 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 18:36:57,286 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 18:36:57,286 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 18:36:57,286 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 18:36:57,286 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 18:36:58,535 | INFO     | src.app.pipeline.step_10.handler | Found 2408 products with shortage
2025-12-05 18:36:58,552 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 569 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - injections: 82 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 63 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - creams: 282 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 31 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - other: 1381 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 2408 products
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 12352 units
2025-12-05 18:36:58,938 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 18:36:58,939 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 18:36:58,939 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 18:36:58,939 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 19:54:06,333 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 19:54:06,334 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 19:54:06,335 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 19:54:08,585 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 22:39:51,907 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:39:54,118 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 22:39:54,118 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 22:39:54,118 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 22:39:54,118 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 22:39:54,118 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 22:39:55,173 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 22:39:55,173 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 22:39:55,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,174 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 22:39:55,174 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 22:39:55,174 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 22:39:55,174 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_223955/output
2025-12-05 22:39:55,175 | INFO     | src.shared.utils.archiver |   Found 422 files in 103 directories
2025-12-05 22:39:55,195 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 22:39:55,195 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_223955
2025-12-05 22:39:55,195 | INFO     | src.shared.utils.archiver |   - Archived 422 files in 103 directories
2025-12-05 22:39:55,195 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_223955.zip...
2025-12-05 22:39:55,403 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_223955.zip
2025-12-05 22:39:55,406 | INFO     | src.app.pipeline.step_1.handler | Archive created: 422 files, 103 dirs | Size: 11.16 MB
2025-12-05 22:39:55,406 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.43 MB (69.3% compression)
2025-12-05 22:39:55,406 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 22:39:55,407 | INFO     | src.shared.utils.archiver |   Found 422 files in 103 directories to delete
2025-12-05 22:39:55,413 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 22:39:55,413 | INFO     | src.shared.utils.archiver |   ✓ Deleted 422 files and 103 directories
2025-12-05 22:39:55,413 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 22:39:55,413 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 22:39:55,413 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 22:39:55,413 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,512 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-05 22:39:55,512 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv...
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 22:39:55,902 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 22:39:55,902 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 22:39:55,902 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv...
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-05 22:39:55,902 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 22:39:55,903 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv...
2025-12-05 22:39:55,938 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 22:39:55,938 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 22:39:55,938 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 22:39:55,938 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,938 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv
2025-12-05 22:39:55,938 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv...
2025-12-05 22:39:55,938 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 22:39:55,946 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 22:39:55
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-05 22:39:55,946 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 22:39:55,946 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 22:39:55,946 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,946 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv
2025-12-05 22:39:55,946 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955.csv...
2025-12-05 22:39:55,946 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 22:39:55,979 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 22:39:55,979 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_223955.csv
2025-12-05 22:39:55,979 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 22:39:55,979 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 22:39:55,979 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 22:39:55,979 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:39:55,980 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_223955.csv
2025-12-05 22:39:55,980 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_223955.csv by branches...
2025-12-05 22:39:55,980 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 22:39:55,980 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 22:39:55,988 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 22:39:55,993 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 22:39:55,997 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 22:39:56,003 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 22:39:56,011 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 22:39:56,019 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 22:39:56,024 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4632 products
2025-12-05 22:39:58,968 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-05 22:40:00,307 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.34s (436 transfers)
2025-12-05 22:40:01,313 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_asherin.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_wardani.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_akba.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_shahid.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_nujum.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_admin.csv
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.94 surplus=2.00 writes=0.39 total=5.33
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4632 branches=6
2025-12-05 22:40:01,314 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 22:40:01,314 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 22:40:01,314 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 22:40:01,314 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 22:40:01,747 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_admin_to_akba.csv (8.9 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_admin_to_asherin.csv (8.1 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_admin_to_nujum.csv (11.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_admin_to_shahid.csv (10.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_admin_to_wardani.csv (5.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_akba_to_asherin.csv (4.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_akba_to_nujum.csv (6.5 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_akba_to_shahid.csv (4.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_akba_to_wardani.csv (2.5 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_asherin_to_akba.csv (4.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_asherin_to_nujum.csv (6.3 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_asherin_to_shahid.csv (4.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_asherin_to_wardani.csv (2.7 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_nujum_to_akba.csv (7.3 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_nujum_to_asherin.csv (6.9 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_nujum_to_shahid.csv (6.3 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_nujum_to_wardani.csv (4.1 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_shahid_to_akba.csv (6.2 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_shahid_to_asherin.csv (4.2 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_shahid_to_nujum.csv (5.7 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_shahid_to_wardani.csv (2.6 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (5 files):
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_wardani_to_admin.csv (115.0 B)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_wardani_to_akba.csv (6.6 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_wardani_to_asherin.csv (7.9 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_wardani_to_nujum.csv (10.6 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_223955_from_wardani_to_shahid.csv (7.8 KB)
2025-12-05 22:40:01,748 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 22:40:01,748 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 22:40:01,748 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 22:40:01,748 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:01,749 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 22:40:01,749 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 22:40:01,749 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler | Generated 147 split files:
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 22:40:01,910 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 22:40:01,911 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 22:40:01,911 | INFO     | src.app.pipeline.step_8.handler | Found 147 split CSV files to convert
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler | Generated 147 Excel files:
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-05 22:40:02,563 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 22:40:02,563 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 22:40:02,563 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 22:40:02,563 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:03,233 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1235 products in 6 categories
2025-12-05 22:40:03,900 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1631 products in 6 categories
2025-12-05 22:40:04,581 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1567 products in 6 categories
2025-12-05 22:40:05,253 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1662 products in 6 categories
2025-12-05 22:40:06,036 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2010 products in 6 categories
2025-12-05 22:40:06,844 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1426 products in 6 categories
2025-12-05 22:40:06,845 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 22:40:07,255 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 22:40:07,256 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 22:40:07,256 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 22:40:07,256 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 22:40:07,256 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 22:40:08,094 | INFO     | src.app.pipeline.step_10.handler | Found 1203 products with shortage
2025-12-05 22:40:08,113 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 22:40:08,401 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 22:40:08,401 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 606 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - injections: 87 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 71 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - creams: 109 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 27 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - other: 303 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1203 products
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 9512 units
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 22:40:08,402 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 22:40:08,402 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 22:40:10,256 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 22:40:10,257 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:40:28,041 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-05 22:40:31,163 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-05 22:40:31,163 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-05 22:40:31,163 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:40:31,163 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-05 22:40:31,164 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-05 22:40:32,507 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-05 22:40:32,507 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 22:40:32,508 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-05 22:40:32,508 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-05 22:40:32,508 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-05 22:40:33,417 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-05 22:40:33,417 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-05 22:40:33,417 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:33,417 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-05 22:40:33,417 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-05 22:40:33,417 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-05 22:40:33,417 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251205_224033/output
2025-12-05 22:40:33,418 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories
2025-12-05 22:40:33,439 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-05 22:40:33,440 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251205_224033
2025-12-05 22:40:33,440 | INFO     | src.shared.utils.archiver |   - Archived 420 files in 103 directories
2025-12-05 22:40:33,440 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251205_224033.zip...
2025-12-05 22:40:33,643 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251205_224033.zip
2025-12-05 22:40:33,646 | INFO     | src.app.pipeline.step_1.handler | Archive created: 420 files, 103 dirs | Size: 11.05 MB
2025-12-05 22:40:33,646 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (69.5% compression)
2025-12-05 22:40:33,646 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-05 22:40:33,647 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories to delete
2025-12-05 22:40:33,652 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-05 22:40:33,653 | INFO     | src.shared.utils.archiver |   ✓ Deleted 420 files and 103 directories
2025-12-05 22:40:33,653 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-05 22:40:33,653 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-05 22:40:33,653 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-05 22:40:33,653 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:33,752 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-05 22:40:33,752 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv...
2025-12-05 22:40:34,184 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-05 22:40:34,184 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-05 22:40:34,184 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-05 22:40:34,184 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:34,184 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv
2025-12-05 22:40:34,184 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv...
2025-12-05 22:40:34,184 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-05 22:40:34,185 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv...
2025-12-05 22:40:34,225 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-05 22:40:34,226 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-05 22:40:34,226 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-05 22:40:34,226 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:34,226 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv
2025-12-05 22:40:34,226 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv...
2025-12-05 22:40:34,226 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-05 22:40:34,234 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-05 22:40:34
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-05 22:40:34,234 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-05 22:40:34,234 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-05 22:40:34,234 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:34,234 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv
2025-12-05 22:40:34,234 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224033.csv...
2025-12-05 22:40:34,234 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-05 22:40:34,274 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-05 22:40:34,274 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_224034.csv
2025-12-05 22:40:34,274 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-05 22:40:34,274 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-05 22:40:34,274 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-05 22:40:34,274 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:34,274 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_224034.csv
2025-12-05 22:40:34,275 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251205_224034.csv by branches...
2025-12-05 22:40:34,275 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-05 22:40:34,275 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-05 22:40:34,283 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-05 22:40:34,292 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-05 22:40:34,300 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-05 22:40:34,306 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-05 22:40:34,313 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-05 22:40:34,321 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-05 22:40:34,326 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4632 products
2025-12-05 22:40:37,359 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-05 22:40:38,697 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.34s (436 transfers)
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_asherin.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_wardani.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_akba.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_shahid.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_nujum.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_admin.csv
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=1.03 surplus=2.00 writes=0.44 total=5.54
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4632 branches=6
2025-12-05 22:40:39,817 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-05 22:40:39,817 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-05 22:40:39,817 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-05 22:40:39,817 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_admin_to_akba.csv (8.9 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_admin_to_asherin.csv (8.1 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_admin_to_nujum.csv (11.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_admin_to_shahid.csv (10.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_admin_to_wardani.csv (5.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_akba_to_asherin.csv (4.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_akba_to_nujum.csv (6.5 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_akba_to_shahid.csv (4.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_akba_to_wardani.csv (2.5 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_asherin_to_akba.csv (4.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_asherin_to_nujum.csv (6.3 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_asherin_to_shahid.csv (4.8 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_asherin_to_wardani.csv (2.7 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_nujum_to_akba.csv (7.3 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_nujum_to_asherin.csv (6.9 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_nujum_to_shahid.csv (6.3 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_nujum_to_wardani.csv (4.1 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_shahid_to_akba.csv (6.2 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_shahid_to_asherin.csv (4.2 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_shahid_to_nujum.csv (5.7 KB)
2025-12-05 22:40:40,255 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_shahid_to_wardani.csv (2.6 KB)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (5 files):
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler |     → admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_wardani_to_admin.csv (115.0 B)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_wardani_to_akba.csv (6.6 KB)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_wardani_to_asherin.csv (7.9 KB)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_wardani_to_nujum.csv (10.6 KB)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251205_224034_from_wardani_to_shahid.csv (7.8 KB)
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-05 22:40:40,256 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-05 22:40:40,256 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-05 22:40:40,256 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 22:40:40,256 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-05 22:40:40,415 | INFO     | src.app.pipeline.step_8.handler | Generated 147 split files:
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-05 22:40:40,416 | INFO     | src.app.pipeline.step_8.handler | Found 147 split CSV files to convert
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler | Generated 147 Excel files:
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-05 22:40:41,078 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-05 22:40:41,078 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-05 22:40:41,078 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-05 22:40:41,078 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:41,766 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1235 products in 6 categories
2025-12-05 22:40:42,462 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1631 products in 6 categories
2025-12-05 22:40:43,154 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1567 products in 6 categories
2025-12-05 22:40:43,845 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1662 products in 6 categories
2025-12-05 22:40:44,543 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2010 products in 6 categories
2025-12-05 22:40:45,237 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1426 products in 6 categories
2025-12-05 22:40:45,237 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-05 22:40:45,633 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-05 22:40:45,633 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-05 22:40:45,633 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-05 22:40:45,633 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-05 22:40:45,633 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-05 22:40:45,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-05 22:40:45,634 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-05 22:40:45,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-05 22:40:45,634 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-05 22:40:45,634 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-05 22:40:46,375 | INFO     | src.app.pipeline.step_10.handler | Found 1203 products with shortage
2025-12-05 22:40:46,385 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 606 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - injections: 87 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 71 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - creams: 109 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 27 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - other: 303 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1203 products
2025-12-05 22:40:46,580 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 22:40:46,581 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 9512 units
2025-12-05 22:40:46,581 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-05 22:40:46,581 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-05 22:40:46,581 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-05 22:40:46,581 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:20:32,063 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 07:20:32,064 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:20:35,068 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-06 07:20:35,069 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:20:35,069 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-06 07:20:35,069 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-06 07:20:35,069 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-06 07:20:35,663 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-06 07:20:35,663 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-06 07:20:35,663 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:35,663 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-06 07:20:35,663 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-06 07:20:35,663 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-06 07:20:35,664 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251206_072035/output
2025-12-06 07:20:35,665 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories
2025-12-06 07:20:35,690 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-06 07:20:35,690 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251206_072035
2025-12-06 07:20:35,690 | INFO     | src.shared.utils.archiver |   - Archived 420 files in 103 directories
2025-12-06 07:20:35,690 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251206_072035.zip...
2025-12-06 07:20:35,894 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251206_072035.zip
2025-12-06 07:20:35,897 | INFO     | src.app.pipeline.step_1.handler | Archive created: 420 files, 103 dirs | Size: 11.05 MB
2025-12-06 07:20:35,897 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.37 MB (69.5% compression)
2025-12-06 07:20:35,897 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-06 07:20:35,898 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories to delete
2025-12-06 07:20:35,903 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-06 07:20:35,903 | INFO     | src.shared.utils.archiver |   ✓ Deleted 420 files and 103 directories
2025-12-06 07:20:35,903 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-06 07:20:35,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-06 07:20:35,903 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-06 07:20:35,903 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:36,052 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-06 07:20:36,052 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv...
2025-12-06 07:20:36,500 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-06 07:20:36,500 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-06 07:20:36,500 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-06 07:20:36,500 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:36,500 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv
2025-12-06 07:20:36,500 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv...
2025-12-06 07:20:36,500 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 07:20:36,501 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv...
2025-12-06 07:20:36,544 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-06 07:20:36,544 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-06 07:20:36,544 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-06 07:20:36,544 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:36,544 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv
2025-12-06 07:20:36,544 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv...
2025-12-06 07:20:36,544 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-06 07:20:36,553 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-06 07:20:36
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-06 07:20:36,553 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-06 07:20:36,553 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-06 07:20:36,553 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:36,553 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv
2025-12-06 07:20:36,553 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036.csv...
2025-12-06 07:20:36,553 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-06 07:20:36,588 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-06 07:20:36,588 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_072036.csv
2025-12-06 07:20:36,588 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-06 07:20:36,588 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-06 07:20:36,589 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-06 07:20:36,589 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:36,589 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_072036.csv
2025-12-06 07:20:36,589 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_072036.csv by branches...
2025-12-06 07:20:36,589 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-06 07:20:36,589 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-06 07:20:36,597 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-06 07:20:36,603 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-06 07:20:36,608 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-06 07:20:36,614 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-06 07:20:36,619 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-06 07:20:36,624 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-06 07:20:36,628 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4632 products
2025-12-06 07:20:39,432 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-06 07:20:40,740 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.31s (261 transfers)
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_asherin.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_wardani.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_akba.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_shahid.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_nujum.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_admin.csv
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.91 surplus=1.89 writes=0.35 total=5.10
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4632 branches=6
2025-12-06 07:20:41,686 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-06 07:20:41,686 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-06 07:20:41,686 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-06 07:20:41,686 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_admin_to_akba.csv (8.8 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_admin_to_asherin.csv (8.1 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_admin_to_nujum.csv (11.0 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_admin_to_shahid.csv (10.5 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_admin_to_wardani.csv (5.8 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_akba_to_asherin.csv (5.0 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_akba_to_nujum.csv (5.8 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_akba_to_shahid.csv (4.6 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_akba_to_wardani.csv (2.5 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_asherin_to_akba.csv (4.7 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_asherin_to_nujum.csv (5.5 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_asherin_to_shahid.csv (4.2 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_asherin_to_wardani.csv (2.6 KB)
2025-12-06 07:20:42,083 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_nujum_to_akba.csv (7.3 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_nujum_to_asherin.csv (7.0 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_nujum_to_shahid.csv (6.3 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_nujum_to_wardani.csv (4.1 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_shahid_to_akba.csv (6.1 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_shahid_to_asherin.csv (4.3 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_shahid_to_nujum.csv (5.4 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_shahid_to_wardani.csv (2.6 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (5 files):
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_wardani_to_admin.csv (115.0 B)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_wardani_to_akba.csv (6.6 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_wardani_to_asherin.csv (8.3 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_wardani_to_nujum.csv (9.2 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_072036_from_wardani_to_shahid.csv (7.3 KB)
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-06 07:20:42,084 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-06 07:20:42,084 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-06 07:20:42,084 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 07:20:42,084 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler | Generated 146 split files:
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 20 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 07:20:42,240 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-06 07:20:42,241 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-06 07:20:42,241 | INFO     | src.app.pipeline.step_8.handler | Found 146 split CSV files to convert
2025-12-06 07:20:42,898 | INFO     | src.app.pipeline.step_8.handler | Generated 146 Excel files:
2025-12-06 07:20:42,898 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 07:20:42,898 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 07:20:42,898 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 07:20:42,898 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 07:20:42,899 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 20 files
2025-12-06 07:20:42,899 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 07:20:42,899 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-06 07:20:42,899 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-06 07:20:42,899 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-06 07:20:42,899 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:43,555 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1264 products in 6 categories
2025-12-06 07:20:44,204 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1656 products in 6 categories
2025-12-06 07:20:44,854 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1579 products in 6 categories
2025-12-06 07:20:45,500 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1668 products in 6 categories
2025-12-06 07:20:46,150 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2011 products in 6 categories
2025-12-06 07:20:46,801 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1459 products in 6 categories
2025-12-06 07:20:46,801 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-06 07:20:47,166 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-06 07:20:47,166 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-06 07:20:47,166 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-06 07:20:47,166 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-06 07:20:47,166 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-06 07:20:47,166 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-06 07:20:47,166 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-06 07:20:47,166 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:20:47,167 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-06 07:20:47,167 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-06 07:20:47,876 | INFO     | src.app.pipeline.step_10.handler | Found 1203 products with shortage
2025-12-06 07:20:47,886 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-06 07:20:48,112 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-06 07:20:48,112 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-06 07:20:48,112 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 606 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - injections: 87 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 71 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - creams: 109 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 27 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - other: 303 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1203 products
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 9512 units
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-06 07:20:48,113 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-06 07:20:48,113 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:49:00,889 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 07:49:00,889 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 07:49:00,889 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:49:00,890 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 07:49:00,890 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 07:49:00,890 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 07:49:00,890 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 07:49:00,890 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 07:49:00,891 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 07:49:00,892 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 07:49:00,893 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:49:02,208 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 07:49:06,502 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 07:49:06,503 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 07:49:07,863 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-06 07:49:07,864 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:49:07,864 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-06 07:49:07,864 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-06 07:49:07,864 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-06 07:49:08,301 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-06 07:49:08,301 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-06 07:49:08,301 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:08,301 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-06 07:49:08,301 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-06 07:49:08,301 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-06 07:49:08,301 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251206_074908/output
2025-12-06 07:49:08,302 | INFO     | src.shared.utils.archiver |   Found 418 files in 103 directories
2025-12-06 07:49:08,322 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-06 07:49:08,322 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251206_074908
2025-12-06 07:49:08,322 | INFO     | src.shared.utils.archiver |   - Archived 418 files in 103 directories
2025-12-06 07:49:08,323 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251206_074908.zip...
2025-12-06 07:49:08,526 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251206_074908.zip
2025-12-06 07:49:08,529 | INFO     | src.app.pipeline.step_1.handler | Archive created: 418 files, 103 dirs | Size: 10.34 MB
2025-12-06 07:49:08,529 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.35 MB (67.6% compression)
2025-12-06 07:49:08,529 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-06 07:49:08,530 | INFO     | src.shared.utils.archiver |   Found 418 files in 103 directories to delete
2025-12-06 07:49:08,535 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-06 07:49:08,535 | INFO     | src.shared.utils.archiver |   ✓ Deleted 418 files and 103 directories
2025-12-06 07:49:08,535 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-06 07:49:08,535 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-06 07:49:08,535 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-06 07:49:08,535 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:08,635 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-06 07:49:08,635 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv...
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-06 07:49:09,015 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-06 07:49:09,015 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-06 07:49:09,015 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv...
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 07:49:09,015 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv...
2025-12-06 07:49:09,049 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-06 07:49:09,049 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-06 07:49:09,049 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-06 07:49:09,049 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:09,049 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv
2025-12-06 07:49:09,049 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv...
2025-12-06 07:49:09,049 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-06 07:49:09,057 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-06 07:49:09
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-06 07:49:09,057 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-06 07:49:09,057 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-06 07:49:09,057 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:09,057 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv
2025-12-06 07:49:09,057 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074908.csv...
2025-12-06 07:49:09,057 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-06 07:49:09,092 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-06 07:49:09,092 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_074909.csv
2025-12-06 07:49:09,092 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-06 07:49:09,092 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-06 07:49:09,092 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-06 07:49:09,092 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:09,092 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_074909.csv
2025-12-06 07:49:09,092 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_074909.csv by branches...
2025-12-06 07:49:09,093 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-06 07:49:09,093 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-06 07:49:09,100 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-06 07:49:09,106 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-06 07:49:09,111 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-06 07:49:09,116 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-06 07:49:09,121 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-06 07:49:09,126 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-06 07:49:09,130 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4632 products
2025-12-06 07:49:12,001 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-06 07:49:13,368 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.37s (258 transfers)
2025-12-06 07:49:14,350 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_asherin.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_wardani.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_akba.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_shahid.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_nujum.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_admin.csv
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=0.94 surplus=1.93 writes=0.36 total=5.26
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4632 branches=6
2025-12-06 07:49:14,351 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-06 07:49:14,351 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-06 07:49:14,351 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-06 07:49:14,351 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_admin_to_akba.csv (8.9 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_admin_to_asherin.csv (8.3 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_admin_to_nujum.csv (11.6 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_admin_to_shahid.csv (10.9 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_admin_to_wardani.csv (5.9 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_akba_to_asherin.csv (5.1 KB)
2025-12-06 07:49:14,752 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_akba_to_nujum.csv (5.9 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_akba_to_shahid.csv (4.6 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_akba_to_wardani.csv (2.5 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_asherin_to_akba.csv (4.6 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_asherin_to_nujum.csv (5.7 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_asherin_to_shahid.csv (4.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_asherin_to_wardani.csv (2.6 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_nujum_to_akba.csv (7.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_nujum_to_asherin.csv (7.0 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_nujum_to_shahid.csv (6.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_nujum_to_wardani.csv (4.1 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_shahid_to_akba.csv (6.1 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_shahid_to_asherin.csv (4.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_shahid_to_nujum.csv (5.4 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_shahid_to_wardani.csv (2.6 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (5 files):
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_wardani_to_admin.csv (115.0 B)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_wardani_to_akba.csv (6.7 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_wardani_to_asherin.csv (8.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_wardani_to_nujum.csv (9.3 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_074909_from_wardani_to_shahid.csv (7.4 KB)
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-06 07:49:14,753 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-06 07:49:14,753 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-06 07:49:14,753 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 07:49:14,753 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler | Generated 147 split files:
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 07:49:14,912 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-06 07:49:14,913 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-06 07:49:14,913 | INFO     | src.app.pipeline.step_8.handler | Found 147 split CSV files to convert
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler | Generated 147 Excel files:
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 07:49:15,638 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-06 07:49:15,638 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-06 07:49:15,638 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-06 07:49:15,638 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:16,327 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1258 products in 6 categories
2025-12-06 07:49:16,982 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1650 products in 6 categories
2025-12-06 07:49:17,636 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1575 products in 6 categories
2025-12-06 07:49:18,287 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1665 products in 6 categories
2025-12-06 07:49:18,936 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 2011 products in 6 categories
2025-12-06 07:49:19,586 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1448 products in 6 categories
2025-12-06 07:49:19,586 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-06 07:49:19,949 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-06 07:49:19,949 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-06 07:49:19,949 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-06 07:49:19,949 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-06 07:49:19,949 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-06 07:49:19,950 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-06 07:49:19,950 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-06 07:49:19,950 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 07:49:19,950 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-06 07:49:19,950 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-06 07:49:20,696 | INFO     | src.app.pipeline.step_10.handler | Found 1203 products with shortage
2025-12-06 07:49:20,706 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 606 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - injections: 87 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 71 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - creams: 109 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 27 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - other: 303 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1203 products
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 9512 units
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-06 07:49:20,904 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-06 07:49:20,904 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-06 07:49:20,904 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 07:49:20,904 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-06 07:49:20,905 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-06 07:49:20,905 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-06 07:49:20,905 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-06 07:49:20,905 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-06 07:49:20,905 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 08:27:15,569 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 08:27:15,570 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:27:16,129 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 08:48:55,722 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:48:57,438 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-06 08:48:57,438 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:48:57,438 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-06 08:48:57,438 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-06 08:48:57,438 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-06 08:48:58,142 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-06 08:48:58,142 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-06 08:48:58,142 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,142 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-06 08:48:58,142 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-06 08:48:58,142 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-06 08:48:58,142 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251206_084858/output
2025-12-06 08:48:58,143 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-06 08:48:58,144 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-06 08:48:58,144 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251206_084858
2025-12-06 08:48:58,144 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-06 08:48:58,144 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251206_084858.zip...
2025-12-06 08:48:58,180 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251206_084858.zip
2025-12-06 08:48:58,180 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 988.99 KB
2025-12-06 08:48:58,180 | INFO     | src.app.pipeline.step_1.handler | ZIP: 287.24 KB (71.0% compression)
2025-12-06 08:48:58,180 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-06 08:48:58,180 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-06 08:48:58,181 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-06 08:48:58,181 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-06 08:48:58,181 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-06 08:48:58,181 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-06 08:48:58,181 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-06 08:48:58,181 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,286 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-06 08:48:58,286 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv...
2025-12-06 08:48:58,695 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-06 08:48:58,695 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-06 08:48:58,695 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-06 08:48:58,695 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,695 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv
2025-12-06 08:48:58,695 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv...
2025-12-06 08:48:58,695 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 08:48:58,696 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv...
2025-12-06 08:48:58,730 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-06 08:48:58,731 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-06 08:48:58,731 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-06 08:48:58,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,731 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv
2025-12-06 08:48:58,731 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv...
2025-12-06 08:48:58,731 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-06 08:48:58,739 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-06 08:48:58
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-06 08:48:58,739 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-06 08:48:58,739 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-06 08:48:58,739 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,739 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv
2025-12-06 08:48:58,739 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084858.csv...
2025-12-06 08:48:58,739 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-06 08:48:58,775 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-06 08:48:58,775 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084858.csv
2025-12-06 08:48:58,775 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-06 08:48:58,775 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-06 08:48:58,775 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-06 08:48:58,775 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,775 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084858.csv
2025-12-06 08:48:58,776 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084858.csv by branches...
2025-12-06 08:48:58,776 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-06 08:48:58,782 | ERROR    | src.app.pipeline.step_6.handler | Error: Missing required columns: {'shahid_avg_sales', 'admin_avg_sales', 'asherin_avg_sales', 'akba_avg_sales', 'nujum_avg_sales', 'wardani_avg_sales'}
2025-12-06 08:48:58,783 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 6 failed
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,783 | ERROR    | src.app.pipeline.step_7.handler | No analytics files found in data/output/branches/analytics
2025-12-06 08:48:58,783 | ERROR    | src.app.pipeline.step_7.handler | Please run step 5 (Split by Branches) first to generate analytics files
2025-12-06 08:48:58,783 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 7 failed
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,783 | ERROR    | src.app.pipeline.step_8.handler | Transfers directory not found: data/output/transfers/csv
2025-12-06 08:48:58,783 | ERROR    | src.app.pipeline.step_8.handler | Please run step 6 (Generate Transfer Files) first to generate transfer files
2025-12-06 08:48:58,783 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 8 failed
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: asherin
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: wardani
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: akba
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: shahid
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: nujum
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: admin
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_9.handler | No remaining surplus files were created
2025-12-06 08:48:58,783 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 9 failed
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-06 08:48:58,783 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:48:58,783 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-06 08:48:58,783 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: asherin
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: wardani
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: akba
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: shahid
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: nujum
2025-12-06 08:48:58,783 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: admin
2025-12-06 08:48:58,784 | INFO     | src.app.pipeline.step_10.handler | No shortage products found. All needs are covered by surplus!
2025-12-06 08:48:58,784 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-06 08:48:58,784 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:48:58,784 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-06 08:48:58,784 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-06 08:48:58,785 | INFO     | src.app.cli.executors.batch_executor |   Successful: 6
2025-12-06 08:48:58,785 | INFO     | src.app.cli.executors.batch_executor |   Failed: 4
2025-12-06 08:48:58,785 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 60.0%
2025-12-06 08:48:58,785 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 08:49:36,327 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:49:38,700 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-06 08:49:40,160 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-06 08:49:41,479 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-06 08:49:41,479 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:49:41,479 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-06 08:49:41,479 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-06 08:49:41,479 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-06 08:49:42,061 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-06 08:49:42,061 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-06 08:49:42,061 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,061 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-06 08:49:42,061 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-06 08:49:42,061 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-06 08:49:42,061 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251206_084942/output
2025-12-06 08:49:42,061 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-06 08:49:42,063 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-06 08:49:42,063 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251206_084942
2025-12-06 08:49:42,063 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-06 08:49:42,063 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251206_084942.zip...
2025-12-06 08:49:42,099 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251206_084942.zip
2025-12-06 08:49:42,100 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 988.99 KB
2025-12-06 08:49:42,100 | INFO     | src.app.pipeline.step_1.handler | ZIP: 287.24 KB (71.0% compression)
2025-12-06 08:49:42,100 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-06 08:49:42,100 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-06 08:49:42,101 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-06 08:49:42,101 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-06 08:49:42,101 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-06 08:49:42,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-06 08:49:42,101 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-06 08:49:42,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,205 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx
2025-12-06 08:49:42,205 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات اصناف تاريخ احد بدون متوسط بيع2.xlsx to مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv...
2025-12-06 08:49:42,607 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-06 08:49:42,607 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-06 08:49:42,607 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-06 08:49:42,608 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv...
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 05/09/2025 00:00 to 05/12/2025 20:05 (>= 3 months)
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler |     Start: 05/09/2025 00:00, End: 05/12/2025 20:05
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-06 08:49:42,608 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv...
2025-12-06 08:49:42,643 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-06 08:49:42,644 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-06 08:49:42,644 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-06 08:49:42,644 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,644 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv
2025-12-06 08:49:42,644 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv...
2025-12-06 08:49:42,644 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-06 08:49:42,652 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-06 08:49:42
File: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,632
Total Columns: 19
Total Cells: 88,008
Filled Cells: 83,376
Empty Cells: 4,632
Empty Cells Percentage: 5.26%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Review data sources to ensure complete data entry.
2. Implement data quality checks to prevent missing values.
3. Consider filling empty cells with appropriate default values or 'N/A'.
4. Ensure consistent data format across all columns.
5. Regular data audits to maintain data quality.

============================================================
2025-12-06 08:49:42,653 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-06 08:49:42,653 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-06 08:49:42,653 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,653 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv
2025-12-06 08:49:42,653 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942.csv...
2025-12-06 08:49:42,653 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084942.csv
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-06 08:49:42,690 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-06 08:49:42,690 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-06 08:49:42,690 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084942.csv
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات اصناف تاريخ احد بدون متوسط بيع2_renamed_20251206_084942.csv by branches...
2025-12-06 08:49:42,690 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-06 08:49:42,690 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-06 08:49:42,698 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-06 08:49:42,703 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-06 08:49:42,708 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-06 08:49:42,714 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-06 08:49:42,719 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-06 08:49:42,724 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-06 08:49:42,729 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4632 products
2025-12-06 08:49:46,001 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-06 08:49:47,357 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.36s (256 transfers)
2025-12-06 08:49:48,378 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-06 08:49:48,378 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_asherin.csv
2025-12-06 08:49:48,378 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_wardani.csv
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_akba.csv
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_shahid.csv
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_nujum.csv
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_admin.csv
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.00 surplus=2.27 writes=0.36 total=5.69
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4632 branches=6
2025-12-06 08:49:48,379 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-06 08:49:48,379 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-06 08:49:48,379 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-06 08:49:48,379 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | Generated 26 transfer files:
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_admin_to_akba.csv (9.2 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_admin_to_asherin.csv (8.4 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_admin_to_nujum.csv (12.1 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_admin_to_shahid.csv (10.9 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_admin_to_wardani.csv (6.0 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → admin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_akba_to_admin.csv (115.0 B)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_akba_to_asherin.csv (5.2 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_akba_to_nujum.csv (6.2 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_akba_to_shahid.csv (4.7 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_akba_to_wardani.csv (2.3 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_asherin_to_akba.csv (3.9 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_asherin_to_nujum.csv (5.2 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_asherin_to_shahid.csv (3.5 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_asherin_to_wardani.csv (2.3 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_nujum_to_akba.csv (8.2 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_nujum_to_asherin.csv (7.6 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_nujum_to_shahid.csv (7.0 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_nujum_to_wardani.csv (4.6 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_shahid_to_akba.csv (5.8 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_shahid_to_asherin.csv (4.9 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_shahid_to_nujum.csv (5.7 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_shahid_to_wardani.csv (2.6 KB)
2025-12-06 08:49:48,804 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_wardani_to_akba.csv (6.6 KB)
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_wardani_to_asherin.csv (6.9 KB)
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_wardani_to_nujum.csv (8.9 KB)
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات اصناف تاريخ احد بدون متوسط بيع2_20251206_084942_from_wardani_to_shahid.csv (7.3 KB)
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-06 08:49:48,805 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-06 08:49:48,805 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-06 08:49:48,805 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 08:49:48,805 | INFO     | src.app.pipeline.step_8.handler | Found 26 transfer files to split
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler | Generated 147 split files:
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-06 08:49:48,962 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-06 08:49:48,963 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-06 08:49:48,963 | INFO     | src.app.pipeline.step_8.handler | Found 147 split CSV files to convert
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler | Generated 147 Excel files:
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 26 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 21 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-06 08:49:49,734 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-06 08:49:49,734 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-06 08:49:49,734 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-06 08:49:49,734 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:50,416 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1311 products in 6 categories
2025-12-06 08:49:51,102 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1675 products in 6 categories
2025-12-06 08:49:51,877 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1570 products in 6 categories
2025-12-06 08:49:52,603 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1648 products in 6 categories
2025-12-06 08:49:53,314 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1966 products in 6 categories
2025-12-06 08:49:54,003 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1437 products in 6 categories
2025-12-06 08:49:54,003 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-06 08:49:54,420 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-06 08:49:54,420 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-06 08:49:54,420 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-06 08:49:54,420 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-06 08:49:54,420 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-06 08:49:54,421 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-06 08:49:54,421 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-06 08:49:54,421 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-06 08:49:54,421 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-06 08:49:54,421 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-06 08:49:55,221 | INFO     | src.app.pipeline.step_10.handler | Found 1203 products with shortage
2025-12-06 08:49:55,231 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 606 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - injections: 87 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 71 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - creams: 109 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 27 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - other: 303 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1203 products
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 9512 units
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-06 08:49:55,471 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-06 08:49:55,471 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-06 08:49:55,472 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-10 01:01:47,200 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:01:50,506 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-10 01:01:50,506 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:01:50,506 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-10 01:01:50,507 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-10 01:01:50,507 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-10 01:01:51,672 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-10 01:01:51,672 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-10 01:01:51,673 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:51,673 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-10 01:01:51,674 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-10 01:01:51,674 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-10 01:01:51,674 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251210_010151/output
2025-12-10 01:01:51,681 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories
2025-12-10 01:01:51,714 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-10 01:01:51,714 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251210_010151
2025-12-10 01:01:51,714 | INFO     | src.shared.utils.archiver |   - Archived 420 files in 103 directories
2025-12-10 01:01:51,714 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251210_010151.zip...
2025-12-10 01:01:51,920 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251210_010151.zip
2025-12-10 01:01:51,923 | INFO     | src.app.pipeline.step_1.handler | Archive created: 420 files, 103 dirs | Size: 10.35 MB
2025-12-10 01:01:51,923 | INFO     | src.app.pipeline.step_1.handler | ZIP: 3.35 MB (67.6% compression)
2025-12-10 01:01:51,923 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-10 01:01:51,924 | INFO     | src.shared.utils.archiver |   Found 420 files in 103 directories to delete
2025-12-10 01:01:51,930 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-10 01:01:51,930 | INFO     | src.shared.utils.archiver |   ✓ Deleted 420 files and 103 directories
2025-12-10 01:01:51,930 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-10 01:01:51,930 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-10 01:01:51,930 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-10 01:01:51,930 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,030 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_073133.xlsx
2025-12-10 01:01:52,030 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stocknew_20251210_073133.xlsx to selled_stocknew_20251210_010152.csv...
2025-12-10 01:01:52,507 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-10 01:01:52,507 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-10 01:01:52,507 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-10 01:01:52,507 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,507 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010152.csv
2025-12-10 01:01:52,507 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stocknew_20251210_010152.csv...
2025-12-10 01:01:52,507 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:01:52,508 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stocknew_20251210_010152.csv...
2025-12-10 01:01:52,561 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-10 01:01:52,561 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-10 01:01:52,561 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-10 01:01:52,561 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,561 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010152.csv
2025-12-10 01:01:52,561 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stocknew_20251210_010152.csv...
2025-12-10 01:01:52,561 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-10 01:01:52,574 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-10 01:01:52
File: selled_stocknew_20251210_010152.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-10 01:01:52,574 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-10 01:01:52,574 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-10 01:01:52,574 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,574 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010152.csv
2025-12-10 01:01:52,574 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stocknew_20251210_010152.csv...
2025-12-10 01:01:52,574 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-10 01:01:52,616 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-10 01:01:52,616 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stocknew_renamed_20251210_010152.csv
2025-12-10 01:01:52,616 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-10 01:01:52,616 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-10 01:01:52,616 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-10 01:01:52,616 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,616 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_renamed_20251210_010152.csv
2025-12-10 01:01:52,617 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stocknew_renamed_20251210_010152.csv by branches...
2025-12-10 01:01:52,617 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-10 01:01:52,617 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-10 01:01:52,628 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-10 01:01:52,630 | ERROR    | src.services.splitting.branch_splitter | Error splitting CSV: unsupported operand type(s) for -: 'str' and 'int'
Traceback (most recent call last):
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
             ^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/computation/expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/computation/expressions.py", line 73, in _evaluate_standard
    return op(a, b)
           ^^^^^^^^
TypeError: unsupported operand type(s) for -: 'str' and 'int'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/branch_splitter.py", line 54, in split_csv_by_branches
    branch_data, has_date_header, first_line = prepare_branch_data(csv_path)
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/processors/data_preparer.py", line 125, in prepare_branch_data
    branch_df = calculate_basic_quantities(branch_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/core/domain/calculations/quantity_calculator.py", line 23, in calculate_basic_quantities
    branch_df['surplus_quantity'] = (branch_df['balance'] - branch_df['monthly_quantity']).apply(
                                     ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/arraylike.py", line 194, in __sub__
    return self._arith_method(other, operator.sub)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 6154, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 227, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 163, in _masked_arith_op
    result[mask] = op(xrav[mask], yrav[mask])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for -: 'str' and 'int'
2025-12-10 01:01:52,634 | ERROR    | src.app.pipeline.step_6.handler | Error: Error splitting CSV: unsupported operand type(s) for -: 'str' and 'int'
2025-12-10 01:01:52,635 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 6 failed
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,635 | ERROR    | src.app.pipeline.step_7.handler | No analytics files found in data/output/branches/analytics
2025-12-10 01:01:52,635 | ERROR    | src.app.pipeline.step_7.handler | Please run step 5 (Split by Branches) first to generate analytics files
2025-12-10 01:01:52,635 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 7 failed
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,635 | ERROR    | src.app.pipeline.step_8.handler | Transfers directory not found: data/output/transfers/csv
2025-12-10 01:01:52,635 | ERROR    | src.app.pipeline.step_8.handler | Please run step 6 (Generate Transfer Files) first to generate transfer files
2025-12-10 01:01:52,635 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 8 failed
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: asherin
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: wardani
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: akba
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: shahid
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: nujum
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: admin
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_9.handler | No remaining surplus files were created
2025-12-10 01:01:52,635 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 9 failed
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-10 01:01:52,635 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:01:52,635 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-10 01:01:52,635 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: asherin
2025-12-10 01:01:52,635 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: wardani
2025-12-10 01:01:52,636 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: akba
2025-12-10 01:01:52,636 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: shahid
2025-12-10 01:01:52,636 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: nujum
2025-12-10 01:01:52,636 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: admin
2025-12-10 01:01:52,636 | INFO     | src.app.pipeline.step_10.handler | No shortage products found. All needs are covered by surplus!
2025-12-10 01:01:52,636 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-10 01:01:52,636 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:01:52,636 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-10 01:01:52,636 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-10 01:01:52,637 | INFO     | src.app.cli.executors.batch_executor |   Successful: 6
2025-12-10 01:01:52,637 | INFO     | src.app.cli.executors.batch_executor |   Failed: 4
2025-12-10 01:01:52,637 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 60.0%
2025-12-10 01:01:52,637 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:22,973 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-10 01:08:22,973 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-10 01:08:22,974 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:22,974 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-10 01:08:22,974 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-10 01:08:22,974 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-10 01:08:22,974 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-10 01:08:22,975 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-10 01:08:22,976 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-10 01:08:22,977 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-10 01:08:22,977 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:25,795 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-10 01:08:25,795 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:25,796 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-10 01:08:25,796 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-10 01:08:25,796 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-10 01:08:29,036 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-10 01:08:29,036 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-10 01:08:29,036 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,037 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-10 01:08:29,038 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-10 01:08:29,038 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-10 01:08:29,038 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251210_010829/output
2025-12-10 01:08:29,039 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-10 01:08:29,045 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-10 01:08:29,046 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251210_010829
2025-12-10 01:08:29,046 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-10 01:08:29,046 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251210_010829.zip...
2025-12-10 01:08:29,095 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251210_010829.zip
2025-12-10 01:08:29,095 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 1.13 MB
2025-12-10 01:08:29,095 | INFO     | src.app.pipeline.step_1.handler | ZIP: 318.30 KB (72.6% compression)
2025-12-10 01:08:29,095 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-10 01:08:29,095 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-10 01:08:29,096 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-10 01:08:29,096 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-10 01:08:29,096 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-10 01:08:29,096 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-10 01:08:29,096 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-10 01:08:29,096 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,096 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_073133.xlsx
2025-12-10 01:08:29,096 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stocknew_20251210_073133.xlsx to selled_stocknew_20251210_010829.csv...
2025-12-10 01:08:29,597 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-10 01:08:29,597 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-10 01:08:29,597 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-10 01:08:29,597 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,597 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010829.csv
2025-12-10 01:08:29,597 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stocknew_20251210_010829.csv...
2025-12-10 01:08:29,597 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:08:29,598 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stocknew_20251210_010829.csv...
2025-12-10 01:08:29,636 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-10 01:08:29,637 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-10 01:08:29,637 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-10 01:08:29,637 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,637 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010829.csv
2025-12-10 01:08:29,637 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stocknew_20251210_010829.csv...
2025-12-10 01:08:29,637 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-10 01:08:29,649 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-10 01:08:29
File: selled_stocknew_20251210_010829.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-10 01:08:29,649 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-10 01:08:29,649 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-10 01:08:29,649 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,650 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010829.csv
2025-12-10 01:08:29,650 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stocknew_20251210_010829.csv...
2025-12-10 01:08:29,650 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-10 01:08:29,689 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-10 01:08:29,689 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stocknew_renamed_20251210_010829.csv
2025-12-10 01:08:29,689 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-10 01:08:29,689 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-10 01:08:29,689 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-10 01:08:29,689 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,689 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_renamed_20251210_010829.csv
2025-12-10 01:08:29,690 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stocknew_renamed_20251210_010829.csv by branches...
2025-12-10 01:08:29,690 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-10 01:08:29,690 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-10 01:08:29,701 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-10 01:08:29,702 | ERROR    | src.services.splitting.branch_splitter | Error splitting CSV: unsupported operand type(s) for -: 'str' and 'int'
Traceback (most recent call last):
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
             ^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/computation/expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/computation/expressions.py", line 73, in _evaluate_standard
    return op(a, b)
           ^^^^^^^^
TypeError: unsupported operand type(s) for -: 'str' and 'int'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/branch_splitter.py", line 54, in split_csv_by_branches
    branch_data, has_date_header, first_line = prepare_branch_data(csv_path)
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/services/splitting/processors/data_preparer.py", line 125, in prepare_branch_data
    # Calculate avg_sales from sales and number of days
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/core/domain/calculations/quantity_calculator.py", line 23, in calculate_basic_quantities
    branch_df['surplus_quantity'] = (branch_df['balance'] - branch_df['monthly_quantity']).apply(
                                     ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/arraylike.py", line 194, in __sub__
    return self._arith_method(other, operator.sub)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 6154, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 227, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Documents/distribution_of_goods/.venv/lib/python3.12/site-packages/pandas/core/ops/array_ops.py", line 163, in _masked_arith_op
    result[mask] = op(xrav[mask], yrav[mask])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for -: 'str' and 'int'
2025-12-10 01:08:29,703 | ERROR    | src.app.pipeline.step_6.handler | Error: Error splitting CSV: unsupported operand type(s) for -: 'str' and 'int'
2025-12-10 01:08:29,704 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 6 failed
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,704 | ERROR    | src.app.pipeline.step_7.handler | No analytics files found in data/output/branches/analytics
2025-12-10 01:08:29,704 | ERROR    | src.app.pipeline.step_7.handler | Please run step 5 (Split by Branches) first to generate analytics files
2025-12-10 01:08:29,704 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 7 failed
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,704 | ERROR    | src.app.pipeline.step_8.handler | Transfers directory not found: data/output/transfers/csv
2025-12-10 01:08:29,704 | ERROR    | src.app.pipeline.step_8.handler | Please run step 6 (Generate Transfer Files) first to generate transfer files
2025-12-10 01:08:29,704 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 8 failed
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: asherin
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: wardani
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: akba
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: shahid
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: nujum
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No analytics file found for branch: admin
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_9.handler | No remaining surplus files were created
2025-12-10 01:08:29,704 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 9 failed
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-10 01:08:29,704 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:29,704 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-10 01:08:29,704 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: asherin
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: wardani
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: akba
2025-12-10 01:08:29,704 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: shahid
2025-12-10 01:08:29,705 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: nujum
2025-12-10 01:08:29,705 | WARNING  | src.app.pipeline.step_10.shortage_calculator | No analytics file found for branch: admin
2025-12-10 01:08:29,705 | INFO     | src.app.pipeline.step_10.handler | No shortage products found. All needs are covered by surplus!
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor |   Successful: 6
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor |   Failed: 4
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 60.0%
2025-12-10 01:08:29,705 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:34,860 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-10 01:08:34,861 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-10 01:08:34,862 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-10 01:08:34,863 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:35,348 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-10 01:08:37,455 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-10 01:08:37,456 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:08:38,716 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-10 01:08:38,717 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:38,717 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-10 01:08:38,717 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-10 01:08:38,717 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-10 01:08:39,431 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-10 01:08:39,431 | INFO     | src.app.cli.executors.batch_executor | [1/10] 1 - Archive Previous Output
2025-12-10 01:08:39,431 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:39,432 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-10 01:08:39,432 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-10 01:08:39,432 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-10 01:08:39,432 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251210_010839/output
2025-12-10 01:08:39,432 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories
2025-12-10 01:08:39,433 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-10 01:08:39,433 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251210_010839
2025-12-10 01:08:39,433 | INFO     | src.shared.utils.archiver |   - Archived 2 files in 18 directories
2025-12-10 01:08:39,433 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251210_010839.zip...
2025-12-10 01:08:39,473 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251210_010839.zip
2025-12-10 01:08:39,474 | INFO     | src.app.pipeline.step_1.handler | Archive created: 2 files, 18 dirs | Size: 1.13 MB
2025-12-10 01:08:39,474 | INFO     | src.app.pipeline.step_1.handler | ZIP: 318.30 KB (72.6% compression)
2025-12-10 01:08:39,474 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-10 01:08:39,474 | INFO     | src.shared.utils.archiver |   Found 2 files in 18 directories to delete
2025-12-10 01:08:39,475 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-10 01:08:39,475 | INFO     | src.shared.utils.archiver |   ✓ Deleted 2 files and 18 directories
2025-12-10 01:08:39,475 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-10 01:08:39,475 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-10 01:08:39,475 | INFO     | src.app.cli.executors.batch_executor | [2/10] 2 - Convert Excel to CSV
2025-12-10 01:08:39,475 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:39,598 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_073133.xlsx
2025-12-10 01:08:39,598 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stocknew_20251210_073133.xlsx to selled_stocknew_20251210_010839.csv...
2025-12-10 01:08:40,049 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-10 01:08:40,050 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-10 01:08:40,050 | INFO     | src.app.cli.executors.batch_executor | [3/10] 3 - Validate Data
2025-12-10 01:08:40,050 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010839.csv
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stocknew_20251210_010839.csv...
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-10 01:08:40,050 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stocknew_20251210_010839.csv...
2025-12-10 01:08:40,090 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-10 01:08:40,090 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-10 01:08:40,090 | INFO     | src.app.cli.executors.batch_executor | [4/10] 4 - Sales Analysis
2025-12-10 01:08:40,090 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:40,090 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010839.csv
2025-12-10 01:08:40,090 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stocknew_20251210_010839.csv...
2025-12-10 01:08:40,090 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-10 01:08:40,102 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-10 01:08:40
File: selled_stocknew_20251210_010839.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-10 01:08:40,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-10 01:08:40,102 | INFO     | src.app.cli.executors.batch_executor | [5/10] 5 - Rename Columns
2025-12-10 01:08:40,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:40,102 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_20251210_010839.csv
2025-12-10 01:08:40,102 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stocknew_20251210_010839.csv...
2025-12-10 01:08:40,102 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-10 01:08:40,141 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-10 01:08:40,141 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stocknew_renamed_20251210_010840.csv
2025-12-10 01:08:40,141 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-10 01:08:40,141 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-10 01:08:40,141 | INFO     | src.app.cli.executors.batch_executor | [6/10] 6 - Split by Branches
2025-12-10 01:08:40,141 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:40,141 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stocknew_renamed_20251210_010840.csv
2025-12-10 01:08:40,142 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stocknew_renamed_20251210_010840.csv by branches...
2025-12-10 01:08:40,142 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-10 01:08:40,142 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-10 01:08:40,154 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-10 01:08:40,161 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-10 01:08:40,168 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-10 01:08:40,174 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-10 01:08:40,181 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-10 01:08:40,187 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-10 01:08:40,191 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-10 01:08:43,232 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-10 01:08:44,445 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.21s (218 transfers)
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stocknew_20251210_010840_asherin.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stocknew_20251210_010840_wardani.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stocknew_20251210_010840_akba.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stocknew_20251210_010840_shahid.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stocknew_20251210_010840_nujum.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stocknew_20251210_010840_admin.csv
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.94 surplus=2.10 writes=0.36 total=5.33
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-10 01:08:45,472 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-10 01:08:45,472 | INFO     | src.app.cli.executors.batch_executor | [7/10] 7 - Generate Transfer Files
2025-12-10 01:08:45,472 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-10 01:08:45,472 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stocknew_20251210_010840_from_admin_to_akba.csv (5.8 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stocknew_20251210_010840_from_admin_to_asherin.csv (4.8 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stocknew_20251210_010840_from_admin_to_nujum.csv (11.3 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stocknew_20251210_010840_from_admin_to_shahid.csv (7.6 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stocknew_20251210_010840_from_admin_to_wardani.csv (5.4 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stocknew_20251210_010840_from_akba_to_asherin.csv (5.2 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stocknew_20251210_010840_from_akba_to_nujum.csv (7.5 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stocknew_20251210_010840_from_akba_to_shahid.csv (5.7 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stocknew_20251210_010840_from_akba_to_wardani.csv (3.0 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stocknew_20251210_010840_from_asherin_to_akba.csv (3.1 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stocknew_20251210_010840_from_asherin_to_nujum.csv (5.0 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stocknew_20251210_010840_from_asherin_to_shahid.csv (4.3 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stocknew_20251210_010840_from_asherin_to_wardani.csv (2.2 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stocknew_20251210_010840_from_nujum_to_akba.csv (7.4 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stocknew_20251210_010840_from_nujum_to_asherin.csv (7.7 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stocknew_20251210_010840_from_nujum_to_shahid.csv (7.0 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stocknew_20251210_010840_from_nujum_to_wardani.csv (4.1 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stocknew_20251210_010840_from_shahid_to_akba.csv (5.4 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stocknew_20251210_010840_from_shahid_to_asherin.csv (5.0 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stocknew_20251210_010840_from_shahid_to_nujum.csv (5.1 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stocknew_20251210_010840_from_shahid_to_wardani.csv (3.4 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stocknew_20251210_010840_from_wardani_to_akba.csv (5.5 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stocknew_20251210_010840_from_wardani_to_asherin.csv (6.2 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stocknew_20251210_010840_from_wardani_to_nujum.csv (9.6 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stocknew_20251210_010840_from_wardani_to_shahid.csv (7.3 KB)
2025-12-10 01:08:45,876 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-10 01:08:45,876 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-10 01:08:45,876 | INFO     | src.app.cli.executors.batch_executor | [8/10] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:08:45,876 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:45,877 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-10 01:08:45,877 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-10 01:08:45,877 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-10 01:08:46,026 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-10 01:08:46,027 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-10 01:08:46,027 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-10 01:08:46,704 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-10 01:08:46,705 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-10 01:08:46,705 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-10 01:08:46,705 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-10 01:08:46,705 | INFO     | src.app.cli.executors.batch_executor | [9/10] 9 - Generate Remaining Surplus Files
2025-12-10 01:08:46,705 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:47,371 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-10 01:08:48,024 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-10 01:08:48,686 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-10 01:08:49,335 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-10 01:08:50,004 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-10 01:08:50,642 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-10 01:08:50,643 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-10 01:08:51,019 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-10 01:08:51,019 | INFO     | src.app.cli.executors.batch_executor | [10/10] 10 - Generate Shortage Files
2025-12-10 01:08:51,019 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-10 01:08:51,019 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-10 01:08:51,710 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-10 01:08:51,720 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-10 01:08:51,928 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-10 01:08:51,929 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 10
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor |   Successful: 10
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-10 01:08:51,929 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-10 01:10:18,234 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-10 01:10:18,234 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-10 01:10:18,234 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:10:18,234 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-10 01:10:18,234 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display | 
  11. Execute all steps
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-10 01:10:18,235 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-10 01:10:18,740 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:27:09,083 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:27:09,084 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:27:13,730 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 13:27:13,730 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:27:13,730 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 13:27:13,730 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 13:27:13,730 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 13:27:15,602 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 13:27:15,602 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 13:27:15,602 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:15,602 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 13:27:15,602 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 13:27:15,602 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 13:27:15,602 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_132715/output
2025-12-16 13:27:15,603 | INFO     | src.shared.utils.archiver |   Found 778 files in 129 directories
2025-12-16 13:27:15,675 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 13:27:15,675 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_132715
2025-12-16 13:27:15,675 | INFO     | src.shared.utils.archiver |   - Archived 778 files in 129 directories
2025-12-16 13:27:15,675 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_132715.zip...
2025-12-16 13:27:15,972 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_132715.zip
2025-12-16 13:27:15,976 | INFO     | src.app.pipeline.step_1.handler | Archive created: 778 files, 129 dirs | Size: 13.89 MB
2025-12-16 13:27:15,976 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.67 MB (59.2% compression)
2025-12-16 13:27:15,976 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 13:27:15,978 | INFO     | src.shared.utils.archiver |   Found 778 files in 129 directories to delete
2025-12-16 13:27:15,986 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 13:27:15,987 | INFO     | src.shared.utils.archiver |   ✓ Deleted 778 files and 129 directories
2025-12-16 13:27:15,987 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 13:27:15,987 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 13:27:15,987 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 13:27:15,987 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:16,139 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 13:27:16,139 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv...
2025-12-16 13:27:16,584 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 13:27:16,584 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 13:27:16,584 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 13:27:16,584 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:16,584 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv
2025-12-16 13:27:16,584 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv...
2025-12-16 13:27:16,584 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:27:16,585 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv...
2025-12-16 13:27:16,624 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 13:27:16,624 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 13:27:16,624 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 13:27:16,624 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:16,624 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv
2025-12-16 13:27:16,625 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv...
2025-12-16 13:27:16,625 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 13:27:16,636 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 13:27:16
File: مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 13:27:16,636 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 13:27:16,636 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 13:27:16,636 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:16,636 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv
2025-12-16 13:27:16,636 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_132716.csv...
2025-12-16 13:27:16,636 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 13:27:16,676 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 13:27:16,676 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_132716.csv
2025-12-16 13:27:16,676 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 13:27:16,676 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 13:27:16,676 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 13:27:16,676 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:16,676 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_132716.csv
2025-12-16 13:27:16,677 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_132716.csv by branches...
2025-12-16 13:27:16,677 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 13:27:16,677 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 13:27:16,690 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 13:27:16,696 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 13:27:16,704 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 13:27:16,710 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 13:27:16,717 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 13:27:16,726 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 13:27:16,733 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 13:27:19,715 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 13:27:20,946 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.23s (218 transfers)
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_asherin.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_wardani.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_akba.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_shahid.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_nujum.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_admin.csv
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=0.95 surplus=2.02 writes=0.34 total=5.22
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 13:27:21,900 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 13:27:21,900 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 13:27:21,900 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 13:27:21,900 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_admin_to_akba.csv (5.8 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 13:27:22,312 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 13:27:22,313 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_132716_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 13:27:22,313 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 13:27:22,313 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 13:27:22,313 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:27:22,313 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:22,313 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 13:27:22,313 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:27:22,313 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 13:27:22,469 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 13:27:22,470 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:27:23,126 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 13:27:23,126 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 13:27:23,126 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 13:27:23,126 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:23,777 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 13:27:24,413 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 13:27:25,050 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 13:27:25,697 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 13:27:26,334 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 13:27:26,978 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 13:27:26,978 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 13:27:27,349 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 13:27:27,349 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 13:27:27,349 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 13:27:27,349 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 13:27:27,349 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 13:27:27,350 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 13:27:27,350 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 13:27:27,350 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:27,350 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 13:27:27,350 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 13:27:28,066 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 13:27:28,076 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 13:27:28,281 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 13:27:28,281 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 13:27:28,281 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 13:27:28,281 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 13:27:28,282 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 13:27:28,282 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 13:27:28,282 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:27:28,282 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 13:27:30,004 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 13:27:32,126 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 13:27:34,102 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 13:27:36,009 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 13:27:38,291 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 13:27:38,291 | INFO     | src.app.pipeline.step_11.handler | Generated 30 merged files (CSV + Excel)
2025-12-16 13:27:38,291 | INFO     | src.app.pipeline.step_11.handler | Generated 148 separate files (CSV + Excel)
2025-12-16 13:27:38,291 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 13:27:38,291 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 13:27:38,291 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:30:53,731 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:30:53,731 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:30:53,731 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:30:53,732 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:30:53,733 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:30:53,734 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:30:53,735 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:30:53,736 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:30:54,153 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:30:57,802 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:30:57,803 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:30:57,803 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:31:00,154 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 13:31:00,154 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:31:00,154 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 13:31:00,154 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 13:31:00,155 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 13:31:01,396 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 13:31:01,396 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 13:31:01,396 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:01,397 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 13:31:01,397 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 13:31:01,397 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 13:31:01,397 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_133101/output
2025-12-16 13:31:01,400 | INFO     | src.shared.utils.archiver |   Found 777 files in 154 directories
2025-12-16 13:31:01,432 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 13:31:01,432 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_133101
2025-12-16 13:31:01,432 | INFO     | src.shared.utils.archiver |   - Archived 777 files in 154 directories
2025-12-16 13:31:01,432 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_133101.zip...
2025-12-16 13:31:01,702 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_133101.zip
2025-12-16 13:31:01,707 | INFO     | src.app.pipeline.step_1.handler | Archive created: 777 files, 154 dirs | Size: 13.41 MB
2025-12-16 13:31:01,707 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.52 MB (58.8% compression)
2025-12-16 13:31:01,707 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 13:31:01,708 | INFO     | src.shared.utils.archiver |   Found 777 files in 154 directories to delete
2025-12-16 13:31:01,717 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 13:31:01,717 | INFO     | src.shared.utils.archiver |   ✓ Deleted 777 files and 154 directories
2025-12-16 13:31:01,717 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 13:31:01,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 13:31:01,717 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 13:31:01,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:01,815 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 13:31:01,816 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv...
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 13:31:02,221 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 13:31:02,221 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 13:31:02,221 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv...
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:31:02,221 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv...
2025-12-16 13:31:02,260 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 13:31:02,260 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 13:31:02,260 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 13:31:02,260 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:02,260 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv
2025-12-16 13:31:02,260 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv...
2025-12-16 13:31:02,260 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 13:31:02,271 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 13:31:02
File: مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 13:31:02,271 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 13:31:02,272 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 13:31:02,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:02,272 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv
2025-12-16 13:31:02,272 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_133101.csv...
2025-12-16 13:31:02,272 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 13:31:02,311 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 13:31:02,311 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_133102.csv
2025-12-16 13:31:02,311 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 13:31:02,311 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 13:31:02,311 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 13:31:02,311 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:02,312 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_133102.csv
2025-12-16 13:31:02,312 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_133102.csv by branches...
2025-12-16 13:31:02,312 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 13:31:02,312 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 13:31:02,325 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 13:31:02,331 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 13:31:02,339 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 13:31:02,345 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 13:31:02,352 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 13:31:02,358 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 13:31:02,363 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 13:31:05,271 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 13:31:06,500 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.23s (218 transfers)
2025-12-16 13:31:07,420 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_asherin.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_wardani.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_akba.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_shahid.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_nujum.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_admin.csv
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.90 surplus=2.01 writes=0.33 total=5.11
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 13:31:07,421 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 13:31:07,421 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 13:31:07,421 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 13:31:07,421 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 13:31:07,802 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_admin_to_akba.csv (5.8 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_133102_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 13:31:07,803 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 13:31:07,803 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 13:31:07,803 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:31:07,803 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:07,804 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 13:31:07,804 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:31:07,804 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:31:07,956 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 13:31:07,957 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 13:31:07,957 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:31:08,613 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 13:31:08,613 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 13:31:08,613 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 13:31:08,613 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:09,250 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 13:31:09,882 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 13:31:10,510 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 13:31:11,149 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 13:31:11,779 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 13:31:12,401 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 13:31:12,402 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 13:31:12,775 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 13:31:12,775 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 13:31:12,775 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 13:31:12,775 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 13:31:12,775 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 13:31:12,776 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 13:31:12,776 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 13:31:12,776 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:12,776 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 13:31:12,776 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 13:31:13,477 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 13:31:13,487 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 13:31:13,700 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 13:31:13,700 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 13:31:13,700 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 13:31:13,701 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 13:31:13,701 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 13:31:13,701 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:31:13,701 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 13:31:15,389 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 13:31:17,433 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 13:31:19,447 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 13:31:21,371 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 13:31:23,548 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 13:31:23,548 | INFO     | src.app.pipeline.step_11.handler | Generated 30 merged files (CSV + Excel)
2025-12-16 13:31:23,548 | INFO     | src.app.pipeline.step_11.handler | Generated 148 separate files (CSV + Excel)
2025-12-16 13:31:23,548 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 13:31:23,548 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 13:31:23,548 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:42:16,919 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:42:18,572 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 13:42:18,572 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:42:18,572 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 13:42:18,572 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 13:42:18,572 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 13:42:19,545 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 13:42:19,545 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 13:42:19,545 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:19,545 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 13:42:19,545 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 13:42:19,546 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 13:42:19,546 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_134219/output
2025-12-16 13:42:19,547 | INFO     | src.shared.utils.archiver |   Found 777 files in 154 directories
2025-12-16 13:42:19,581 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 13:42:19,581 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_134219
2025-12-16 13:42:19,581 | INFO     | src.shared.utils.archiver |   - Archived 777 files in 154 directories
2025-12-16 13:42:19,581 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_134219.zip...
2025-12-16 13:42:19,853 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_134219.zip
2025-12-16 13:42:19,857 | INFO     | src.app.pipeline.step_1.handler | Archive created: 777 files, 154 dirs | Size: 13.40 MB
2025-12-16 13:42:19,857 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.57 MB (58.5% compression)
2025-12-16 13:42:19,857 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 13:42:19,859 | INFO     | src.shared.utils.archiver |   Found 777 files in 154 directories to delete
2025-12-16 13:42:19,868 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 13:42:19,868 | INFO     | src.shared.utils.archiver |   ✓ Deleted 777 files and 154 directories
2025-12-16 13:42:19,868 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 13:42:19,868 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 13:42:19,869 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 13:42:19,869 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:19,869 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 13:42:19,869 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv...
2025-12-16 13:42:20,280 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 13:42:20,281 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 13:42:20,281 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 13:42:20,281 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv...
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:42:20,281 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv...
2025-12-16 13:42:20,319 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 13:42:20,319 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 13:42:20,319 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 13:42:20,319 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:20,319 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv
2025-12-16 13:42:20,319 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv...
2025-12-16 13:42:20,319 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 13:42:20,330 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 13:42:20
File: مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 13:42:20,330 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 13:42:20,330 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 13:42:20,330 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:20,330 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv
2025-12-16 13:42:20,330 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_134219.csv...
2025-12-16 13:42:20,330 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_134220.csv
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 13:42:20,367 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 13:42:20,367 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 13:42:20,367 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_134220.csv
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_134220.csv by branches...
2025-12-16 13:42:20,367 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 13:42:20,367 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 13:42:20,378 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 13:42:20,385 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 13:42:20,391 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 13:42:20,398 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 13:42:20,404 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 13:42:20,411 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 13:42:20,415 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 13:42:23,335 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 13:42:24,579 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.24s (218 transfers)
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_asherin.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_wardani.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_akba.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_shahid.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_nujum.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_admin.csv
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.91 surplus=2.01 writes=0.34 total=5.16
2025-12-16 13:42:25,525 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 13:42:25,525 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 13:42:25,525 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 13:42:25,525 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:25,526 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 13:42:25,526 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 13:42:25,526 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_admin_to_akba.csv (5.8 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_134220_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 13:42:25,898 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 13:42:25,899 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 13:42:25,899 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:42:25,899 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:25,899 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 13:42:25,899 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:42:25,899 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:42:26,050 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 13:42:26,051 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 13:42:26,051 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:42:26,705 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 13:42:26,706 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 13:42:26,706 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 13:42:26,706 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:27,326 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 13:42:27,958 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 13:42:28,591 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 13:42:29,217 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 13:42:29,847 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 13:42:30,468 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 13:42:30,468 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 13:42:30,831 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 13:42:30,831 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 13:42:30,831 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 13:42:30,831 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 13:42:30,831 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 13:42:30,832 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 13:42:30,832 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 13:42:30,832 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:30,832 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 13:42:30,832 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 13:42:31,526 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 13:42:31,537 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 13:42:31,751 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 13:42:31,751 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 13:42:31,751 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 13:42:31,752 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 13:42:31,752 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 13:42:31,752 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:42:31,752 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 13:42:33,456 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 13:42:35,538 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 13:42:37,475 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 13:42:39,469 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 13:42:41,816 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 13:42:41,816 | INFO     | src.app.pipeline.step_11.handler | Generated 30 merged files (CSV + Excel)
2025-12-16 13:42:41,816 | INFO     | src.app.pipeline.step_11.handler | Generated 148 separate files (CSV + Excel)
2025-12-16 13:42:41,816 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 13:42:41,816 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 13:42:41,816 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:56:02,301 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:56:04,738 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:56:06,614 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:56:06,615 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:56:13,741 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 13:56:13,741 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:56:13,741 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 13:56:13,741 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 13:56:13,741 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 13:56:14,903 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 13:56:14,903 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 13:56:14,903 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:14,904 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 13:56:14,904 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 13:56:14,904 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 13:56:14,904 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_135614/output
2025-12-16 13:56:14,910 | INFO     | src.shared.utils.archiver |   Found 859 files in 163 directories
2025-12-16 13:56:14,950 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 13:56:14,950 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_135614
2025-12-16 13:56:14,950 | INFO     | src.shared.utils.archiver |   - Archived 859 files in 163 directories
2025-12-16 13:56:14,950 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_135614.zip...
2025-12-16 13:56:15,237 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_135614.zip
2025-12-16 13:56:15,241 | INFO     | src.app.pipeline.step_1.handler | Archive created: 859 files, 163 dirs | Size: 14.18 MB
2025-12-16 13:56:15,242 | INFO     | src.app.pipeline.step_1.handler | ZIP: 6.11 MB (56.9% compression)
2025-12-16 13:56:15,242 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 13:56:15,243 | INFO     | src.shared.utils.archiver |   Found 859 files in 163 directories to delete
2025-12-16 13:56:15,253 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 13:56:15,253 | INFO     | src.shared.utils.archiver |   ✓ Deleted 859 files and 163 directories
2025-12-16 13:56:15,253 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 13:56:15,253 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 13:56:15,253 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 13:56:15,253 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:15,353 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 13:56:15,353 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv...
2025-12-16 13:56:15,759 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 13:56:15,759 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 13:56:15,759 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 13:56:15,759 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:15,759 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv
2025-12-16 13:56:15,759 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv...
2025-12-16 13:56:15,759 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:56:15,760 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv...
2025-12-16 13:56:15,799 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 13:56:15,800 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 13:56:15,800 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 13:56:15,800 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:15,800 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv
2025-12-16 13:56:15,800 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv...
2025-12-16 13:56:15,800 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 13:56:15,811 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 13:56:15
File: مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 13:56:15,811 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 13:56:15,811 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 13:56:15,811 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:15,812 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv
2025-12-16 13:56:15,812 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_135615.csv...
2025-12-16 13:56:15,812 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 13:56:15,851 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 13:56:15,851 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135615.csv
2025-12-16 13:56:15,851 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 13:56:15,851 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 13:56:15,851 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 13:56:15,851 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:15,851 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135615.csv
2025-12-16 13:56:15,852 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135615.csv by branches...
2025-12-16 13:56:15,852 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 13:56:15,852 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 13:56:15,865 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 13:56:15,871 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 13:56:15,878 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 13:56:15,885 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 13:56:15,891 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 13:56:15,898 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 13:56:15,902 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 13:56:18,843 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 13:56:20,085 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.24s (218 transfers)
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_asherin.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_wardani.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_akba.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_shahid.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_nujum.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_admin.csv
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.92 surplus=2.02 writes=0.34 total=5.17
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 13:56:21,026 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 13:56:21,026 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 13:56:21,026 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:21,026 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 13:56:21,027 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 13:56:21,027 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_admin_to_akba.csv (5.8 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135615_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 13:56:21,407 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 13:56:21,407 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 13:56:21,408 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:56:21,408 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:21,408 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 13:56:21,408 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:56:21,408 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 13:56:21,557 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 13:56:21,557 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:56:21,557 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:56:21,557 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 13:56:21,558 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 13:56:22,212 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 13:56:22,212 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 13:56:22,212 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 13:56:22,212 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:22,852 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 13:56:23,499 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 13:56:24,138 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 13:56:24,780 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 13:56:25,427 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 13:56:26,060 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 13:56:26,060 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 13:56:26,430 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 13:56:26,430 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 13:56:26,430 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 13:56:26,430 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 13:56:26,430 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 13:56:26,430 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 13:56:26,431 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 13:56:26,431 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:26,431 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 13:56:26,431 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 13:56:27,135 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 13:56:27,145 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 13:56:27,356 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 13:56:27,357 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 13:56:27,357 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 13:56:27,357 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:56:27,357 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 13:56:29,194 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 13:56:31,485 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 13:56:33,634 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 13:56:35,776 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 13:56:38,150 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 13:56:40,546 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 13:56:40,546 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 13:56:40,546 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 13:56:40,546 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 13:56:40,546 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 13:56:40,546 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:59:48,151 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:59:48,152 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:59:48,152 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:59:48,152 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:59:48,152 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:59:48,153 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:59:48,153 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:59:48,153 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:59:48,153 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:59:48,153 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:59:48,154 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:59:48,155 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:59:48,156 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:59:48,156 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:59:49,585 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 13:59:54,015 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 13:59:54,016 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 13:59:55,299 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 13:59:55,299 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 13:59:55,299 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 13:59:55,299 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 13:59:55,299 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 13:59:55,821 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 13:59:55,821 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 13:59:55,821 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:55,822 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 13:59:55,822 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 13:59:55,823 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 13:59:55,823 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_135955/output
2025-12-16 13:59:55,827 | INFO     | src.shared.utils.archiver |   Found 859 files in 163 directories
2025-12-16 13:59:55,862 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 13:59:55,862 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_135955
2025-12-16 13:59:55,862 | INFO     | src.shared.utils.archiver |   - Archived 859 files in 163 directories
2025-12-16 13:59:55,862 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_135955.zip...
2025-12-16 13:59:56,149 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_135955.zip
2025-12-16 13:59:56,154 | INFO     | src.app.pipeline.step_1.handler | Archive created: 859 files, 163 dirs | Size: 14.18 MB
2025-12-16 13:59:56,154 | INFO     | src.app.pipeline.step_1.handler | ZIP: 6.11 MB (56.9% compression)
2025-12-16 13:59:56,154 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 13:59:56,155 | INFO     | src.shared.utils.archiver |   Found 859 files in 163 directories to delete
2025-12-16 13:59:56,165 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 13:59:56,165 | INFO     | src.shared.utils.archiver |   ✓ Deleted 859 files and 163 directories
2025-12-16 13:59:56,165 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 13:59:56,165 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 13:59:56,165 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 13:59:56,165 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:56,267 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 13:59:56,267 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv...
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 13:59:56,672 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 13:59:56,672 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 13:59:56,672 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv...
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 13:59:56,672 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 13:59:56,673 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv...
2025-12-16 13:59:56,711 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 13:59:56,711 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 13:59:56,711 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 13:59:56,711 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:56,711 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv
2025-12-16 13:59:56,711 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv...
2025-12-16 13:59:56,711 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 13:59:56,723 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 13:59:56
File: مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 13:59:56,723 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 13:59:56,723 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 13:59:56,723 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:56,723 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv
2025-12-16 13:59:56,723 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_135956.csv...
2025-12-16 13:59:56,723 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135956.csv
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 13:59:56,763 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 13:59:56,763 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 13:59:56,763 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135956.csv
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_135956.csv by branches...
2025-12-16 13:59:56,763 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 13:59:56,764 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 13:59:56,776 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 13:59:56,783 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 13:59:56,790 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 13:59:56,796 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 13:59:56,803 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 13:59:56,809 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 13:59:56,813 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 13:59:59,748 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 14:00:00,949 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.20s (218 transfers)
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_asherin.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_wardani.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_akba.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_shahid.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_nujum.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_admin.csv
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.91 surplus=2.02 writes=0.34 total=5.14
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 14:00:01,905 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 14:00:01,905 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 14:00:01,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 14:00:01,905 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_admin_to_akba.csv (5.8 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 14:00:02,286 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_135956_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 14:00:02,287 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 14:00:02,287 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:00:02,287 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:00:02,287 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:00:02,436 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 14:00:02,437 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 14:00:02,437 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 14:00:03,100 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:00:03,101 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 14:00:03,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 14:00:03,101 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 14:00:03,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:00:03,734 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 14:00:04,367 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 14:00:04,997 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 14:00:05,626 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 14:00:06,245 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 14:00:06,863 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 14:00:06,863 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 14:00:07,238 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 14:00:07,238 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 14:00:07,239 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 14:00:07,239 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 14:00:07,239 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 14:00:07,239 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 14:00:07,239 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 14:00:07,239 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:00:07,239 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 14:00:07,239 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 14:00:07,938 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 14:00:07,948 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 14:00:08,161 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 14:00:08,162 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 14:00:08,162 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 14:00:08,162 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:00:08,162 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 14:00:10,008 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 14:00:12,274 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 14:00:14,415 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 14:00:16,557 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 14:00:18,966 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 14:00:21,457 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 14:00:21,457 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 14:00:21,457 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 14:00:21,457 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 14:00:21,457 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 14:00:21,457 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 14:07:05,122 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 14:07:05,123 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:07:08,299 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 14:07:08,299 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:07:08,299 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 14:07:08,299 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 14:07:08,299 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 14:07:09,249 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 14:07:09,249 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 14:07:09,249 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:09,249 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 14:07:09,249 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 14:07:09,249 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 14:07:09,249 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_140709/output
2025-12-16 14:07:09,251 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories
2025-12-16 14:07:09,304 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 14:07:09,304 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_140709
2025-12-16 14:07:09,304 | INFO     | src.shared.utils.archiver |   - Archived 859 files in 195 directories
2025-12-16 14:07:09,304 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_140709.zip...
2025-12-16 14:07:09,598 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_140709.zip
2025-12-16 14:07:09,603 | INFO     | src.app.pipeline.step_1.handler | Archive created: 859 files, 195 dirs | Size: 14.18 MB
2025-12-16 14:07:09,603 | INFO     | src.app.pipeline.step_1.handler | ZIP: 6.13 MB (56.8% compression)
2025-12-16 14:07:09,603 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 14:07:09,605 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories to delete
2025-12-16 14:07:09,619 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 14:07:09,619 | INFO     | src.shared.utils.archiver |   ✓ Deleted 859 files and 195 directories
2025-12-16 14:07:09,619 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 14:07:09,619 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 14:07:09,619 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 14:07:09,619 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:09,620 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 14:07:09,620 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv...
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 14:07:10,041 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 14:07:10,041 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 14:07:10,041 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv...
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 14:07:10,041 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 14:07:10,042 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:07:10,042 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 14:07:10,042 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:07:10,042 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv...
2025-12-16 14:07:10,078 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 14:07:10,078 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 14:07:10,078 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 14:07:10,078 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:10,078 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv
2025-12-16 14:07:10,078 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv...
2025-12-16 14:07:10,078 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 14:07:10,089 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 14:07:10
File: مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 14:07:10,089 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 14:07:10,089 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 14:07:10,089 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:10,089 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv
2025-12-16 14:07:10,089 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_140709.csv...
2025-12-16 14:07:10,089 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 14:07:10,126 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 14:07:10,126 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_140710.csv
2025-12-16 14:07:10,126 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 14:07:10,126 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 14:07:10,126 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 14:07:10,126 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:10,127 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_140710.csv
2025-12-16 14:07:10,127 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_140710.csv by branches...
2025-12-16 14:07:10,127 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 14:07:10,127 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 14:07:10,139 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 14:07:10,145 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 14:07:10,151 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 14:07:10,158 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 14:07:10,164 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 14:07:10,170 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 14:07:10,174 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 14:07:13,118 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 14:07:14,319 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.20s (218 transfers)
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_asherin.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_wardani.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_akba.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_shahid.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_nujum.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_admin.csv
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.91 surplus=2.03 writes=0.34 total=5.14
2025-12-16 14:07:15,265 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 14:07:15,265 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 14:07:15,265 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 14:07:15,265 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:15,266 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 14:07:15,266 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 14:07:15,266 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_admin_to_akba.csv (5.8 KB)
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 14:07:15,644 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_140710_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 14:07:15,645 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 14:07:15,645 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:07:15,645 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:07:15,645 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 14:07:15,794 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:07:16,469 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 14:07:16,469 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 14:07:16,469 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 14:07:16,469 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:17,101 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 14:07:17,733 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 14:07:18,382 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 14:07:19,009 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 14:07:19,630 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 14:07:20,263 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 14:07:20,263 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 14:07:20,639 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 14:07:20,639 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 14:07:20,639 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 14:07:20,639 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 14:07:20,639 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 14:07:20,640 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 14:07:20,640 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 14:07:20,640 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:20,640 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 14:07:20,640 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 14:07:21,353 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 14:07:21,363 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 14:07:21,560 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 14:07:21,560 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 14:07:21,560 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 14:07:21,560 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:07:21,561 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 14:07:23,414 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 14:07:25,672 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 14:07:27,829 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 14:07:29,925 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 14:07:32,337 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 14:07:34,778 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 14:07:34,779 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 14:07:34,779 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 14:07:34,779 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 14:07:34,779 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 14:07:34,779 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 14:13:48,769 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:13:49,392 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 14:13:51,088 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 14:13:51,089 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:13:52,112 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 14:13:52,113 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:13:52,113 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 14:13:52,113 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 14:13:52,113 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 14:13:52,498 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 14:13:52,499 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 14:13:52,499 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:52,499 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 14:13:52,499 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 14:13:52,499 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 14:13:52,499 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_141352/output
2025-12-16 14:13:52,501 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories
2025-12-16 14:13:52,537 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 14:13:52,537 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_141352
2025-12-16 14:13:52,537 | INFO     | src.shared.utils.archiver |   - Archived 859 files in 195 directories
2025-12-16 14:13:52,537 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_141352.zip...
2025-12-16 14:13:52,831 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_141352.zip
2025-12-16 14:13:52,836 | INFO     | src.app.pipeline.step_1.handler | Archive created: 859 files, 195 dirs | Size: 14.36 MB
2025-12-16 14:13:52,836 | INFO     | src.app.pipeline.step_1.handler | ZIP: 6.20 MB (56.8% compression)
2025-12-16 14:13:52,836 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 14:13:52,837 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories to delete
2025-12-16 14:13:52,848 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 14:13:52,848 | INFO     | src.shared.utils.archiver |   ✓ Deleted 859 files and 195 directories
2025-12-16 14:13:52,848 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 14:13:52,848 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 14:13:52,848 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 14:13:52,848 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:52,951 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 14:13:52,952 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv...
2025-12-16 14:13:53,359 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 14:13:53,359 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 14:13:53,359 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 14:13:53,359 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv...
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:13:53,360 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv...
2025-12-16 14:13:53,400 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 14:13:53,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 14:13:53,400 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 14:13:53,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:53,400 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv
2025-12-16 14:13:53,400 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv...
2025-12-16 14:13:53,400 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 14:13:53,412 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 14:13:53
File: مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 14:13:53,412 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 14:13:53,412 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 14:13:53,412 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:53,412 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv
2025-12-16 14:13:53,412 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_141352.csv...
2025-12-16 14:13:53,412 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_141353.csv
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 14:13:53,453 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 14:13:53,453 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 14:13:53,453 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_141353.csv
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_141353.csv by branches...
2025-12-16 14:13:53,453 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 14:13:53,454 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 14:13:53,467 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 14:13:53,473 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 14:13:53,481 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 14:13:53,488 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 14:13:53,495 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 14:13:53,502 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 14:13:53,506 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 14:13:56,543 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 14:13:57,778 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.24s (218 transfers)
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_asherin.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_wardani.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_akba.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_shahid.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_nujum.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_admin.csv
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.98 surplus=2.06 writes=0.35 total=5.30
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 14:13:58,752 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 14:13:58,752 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 14:13:58,752 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 14:13:58,752 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_admin_to_akba.csv (5.8 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 14:13:59,149 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 14:13:59,150 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_141353_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 14:13:59,150 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 14:13:59,150 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 14:13:59,150 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:13:59,150 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:13:59,150 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 14:13:59,150 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:13:59,150 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:13:59,303 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 14:13:59,304 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 14:13:59,304 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:13:59,972 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 14:13:59,972 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 14:13:59,972 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 14:13:59,972 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:14:00,622 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 14:14:01,278 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 14:14:01,914 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 14:14:02,560 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 14:14:03,202 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 14:14:03,849 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 14:14:03,849 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 14:14:04,229 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 14:14:04,229 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 14:14:04,229 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 14:14:04,229 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 14:14:04,943 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 14:14:04,953 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:14:05,168 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 14:14:05,169 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:14:05,169 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 14:14:05,169 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 14:14:05,169 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 14:14:05,169 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 14:14:05,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:14:05,169 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 14:14:07,046 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 14:14:09,353 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 14:14:11,536 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 14:14:13,671 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 14:14:16,124 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 14:14:18,530 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 14:14:18,530 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 14:14:18,530 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 14:14:18,530 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 14:14:18,530 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 14:14:18,530 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 14:21:51,353 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 14:21:52,642 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 14:21:52,642 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:21:52,642 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 14:21:52,642 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 14:21:52,642 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 14:21:53,205 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 14:21:53,205 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 14:21:53,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:53,205 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 14:21:53,205 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 14:21:53,206 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 14:21:53,206 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_142153/output
2025-12-16 14:21:53,208 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories
2025-12-16 14:21:53,249 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 14:21:53,249 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_142153
2025-12-16 14:21:53,249 | INFO     | src.shared.utils.archiver |   - Archived 859 files in 195 directories
2025-12-16 14:21:53,249 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_142153.zip...
2025-12-16 14:21:53,563 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_142153.zip
2025-12-16 14:21:53,568 | INFO     | src.app.pipeline.step_1.handler | Archive created: 859 files, 195 dirs | Size: 14.19 MB
2025-12-16 14:21:53,568 | INFO     | src.app.pipeline.step_1.handler | ZIP: 6.13 MB (56.8% compression)
2025-12-16 14:21:53,568 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 14:21:53,570 | INFO     | src.shared.utils.archiver |   Found 859 files in 195 directories to delete
2025-12-16 14:21:53,580 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 14:21:53,580 | INFO     | src.shared.utils.archiver |   ✓ Deleted 859 files and 195 directories
2025-12-16 14:21:53,580 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 14:21:53,580 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 14:21:53,580 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 14:21:53,580 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:53,580 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 14:21:53,580 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv...
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 14:21:53,991 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 14:21:53,991 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 14:21:53,991 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv...
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 14:21:53,991 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv...
2025-12-16 14:21:54,027 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 14:21:54,028 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 14:21:54,028 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 14:21:54,028 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:54,028 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv
2025-12-16 14:21:54,028 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv...
2025-12-16 14:21:54,028 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 14:21:54,039 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 14:21:54
File: مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 14:21:54,039 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 14:21:54,039 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 14:21:54,039 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:54,039 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv
2025-12-16 14:21:54,039 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_142153.csv...
2025-12-16 14:21:54,039 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 14:21:54,075 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 14:21:54,076 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_142154.csv
2025-12-16 14:21:54,076 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 14:21:54,076 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 14:21:54,076 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 14:21:54,076 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:54,076 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_142154.csv
2025-12-16 14:21:54,076 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_142154.csv by branches...
2025-12-16 14:21:54,076 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 14:21:54,076 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 14:21:54,088 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 14:21:54,094 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 14:21:54,100 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 14:21:54,107 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 14:21:54,113 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 14:21:54,119 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 14:21:54,123 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 14:21:57,028 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 14:21:58,231 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.20s (218 transfers)
2025-12-16 14:21:59,177 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_asherin.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_wardani.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_akba.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_shahid.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_nujum.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_admin.csv
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.92 surplus=1.99 writes=0.34 total=5.10
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 14:21:59,178 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 14:21:59,178 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 14:21:59,178 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 14:21:59,178 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_admin_to_akba.csv (5.8 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 14:21:59,564 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_142154_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 14:21:59,565 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 14:21:59,565 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 14:21:59,565 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:21:59,565 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 14:21:59,716 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 14:21:59,717 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 14:21:59,717 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 14:22:00,386 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 14:22:00,386 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 14:22:00,386 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 14:22:00,386 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:22:01,026 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 14:22:01,717 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 14:22:02,359 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 14:22:03,004 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 14:22:03,654 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 14:22:04,289 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 14:22:04,289 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 14:22:04,653 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 14:22:04,653 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 14:22:04,653 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 14:22:04,653 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 14:22:05,361 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 14:22:05,371 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 14:22:05,584 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 14:22:05,584 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 14:22:05,584 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 14:22:05,584 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 14:22:05,585 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 14:22:07,426 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 14:22:09,758 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 14:22:11,901 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 14:22:14,028 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 14:22:16,412 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 14:22:18,831 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 14:22:18,831 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 14:22:18,831 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 14:22:18,831 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 14:22:18,831 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 14:22:18,831 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 14:22:18,831 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 14:22:18,832 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:30:42,220 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 15:30:42,221 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:30:44,345 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 15:30:44,345 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:30:44,345 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 15:30:44,345 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 15:30:44,345 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 15:30:44,783 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 15:30:44,783 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 15:30:44,783 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:44,784 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 15:30:44,784 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 15:30:44,784 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 15:30:44,784 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_153044/output
2025-12-16 15:30:44,787 | INFO     | src.shared.utils.archiver |   Found 847 files in 193 directories
2025-12-16 15:30:44,822 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 15:30:44,822 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_153044
2025-12-16 15:30:44,822 | INFO     | src.shared.utils.archiver |   - Archived 847 files in 193 directories
2025-12-16 15:30:44,822 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_153044.zip...
2025-12-16 15:30:45,100 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_153044.zip
2025-12-16 15:30:45,105 | INFO     | src.app.pipeline.step_1.handler | Archive created: 847 files, 193 dirs | Size: 13.89 MB
2025-12-16 15:30:45,105 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.94 MB (57.2% compression)
2025-12-16 15:30:45,105 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 15:30:45,106 | INFO     | src.shared.utils.archiver |   Found 847 files in 193 directories to delete
2025-12-16 15:30:45,116 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 15:30:45,116 | INFO     | src.shared.utils.archiver |   ✓ Deleted 847 files and 193 directories
2025-12-16 15:30:45,116 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 15:30:45,116 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 15:30:45,116 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 15:30:45,116 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:45,117 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 15:30:45,117 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv...
2025-12-16 15:30:45,517 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 15:30:45,517 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 15:30:45,517 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 15:30:45,517 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:45,517 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv
2025-12-16 15:30:45,517 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv...
2025-12-16 15:30:45,517 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 15:30:45,518 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv...
2025-12-16 15:30:45,554 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 15:30:45,554 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 15:30:45,555 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 15:30:45,555 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:45,555 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv
2025-12-16 15:30:45,555 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv...
2025-12-16 15:30:45,555 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 15:30:45,565 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 15:30:45
File: مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 15:30:45,566 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 15:30:45,566 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 15:30:45,566 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:45,566 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv
2025-12-16 15:30:45,566 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_153045.csv...
2025-12-16 15:30:45,566 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 15:30:45,602 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 15:30:45,602 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153045.csv
2025-12-16 15:30:45,602 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 15:30:45,602 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 15:30:45,602 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 15:30:45,602 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:45,602 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153045.csv
2025-12-16 15:30:45,603 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153045.csv by branches...
2025-12-16 15:30:45,603 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 15:30:45,603 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 15:30:45,614 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 15:30:45,621 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 15:30:45,627 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 15:30:45,633 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 15:30:45,640 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 15:30:45,646 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 15:30:45,650 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 15:30:48,544 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 15:30:49,733 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.19s (218 transfers)
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_asherin.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_wardani.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_akba.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_shahid.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_nujum.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_admin.csv
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.92 surplus=1.97 writes=0.36 total=5.11
2025-12-16 15:30:50,716 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 15:30:50,716 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 15:30:50,717 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 15:30:50,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:50,717 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 15:30:50,717 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 15:30:50,717 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_admin_to_akba.csv (5.8 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 15:30:51,104 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153045_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 15:30:51,105 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 15:30:51,105 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 15:30:51,105 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 15:30:51,105 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 15:30:51,257 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 15:30:51,258 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 15:30:51,258 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 15:30:51,947 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 15:30:51,947 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 15:30:51,947 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 15:30:51,947 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:52,613 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 15:30:53,327 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 15:30:53,982 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 15:30:54,632 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 15:30:55,277 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 15:30:55,923 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 15:30:55,924 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 15:30:56,284 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 15:30:56,284 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 15:30:56,284 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 15:30:56,284 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 15:30:56,284 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 15:30:56,285 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 15:30:56,285 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 15:30:56,285 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:56,285 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 15:30:56,285 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 15:30:56,993 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 15:30:57,003 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 15:30:57,212 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 15:30:57,213 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 15:30:57,213 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 15:30:57,213 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 15:30:57,213 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 15:30:57,213 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 15:30:57,213 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 15:30:57,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:30:57,213 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 15:30:59,074 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 15:31:01,394 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 15:31:03,588 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 15:31:05,737 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 15:31:08,169 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 15:31:10,620 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 15:31:10,620 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 15:31:10,620 | INFO     | src.app.pipeline.step_11.handler | Generated 183 separate files (CSV + Excel)
2025-12-16 15:31:10,620 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 15:31:10,620 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 15:31:10,620 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 15:33:22,313 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:33:23,144 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 15:33:24,933 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 15:33:26,229 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 15:33:26,230 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:33:26,230 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 15:33:26,230 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 15:33:26,230 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 15:33:26,977 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 15:33:26,977 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 15:33:26,977 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:26,977 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 15:33:26,977 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 15:33:26,977 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 15:33:26,977 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_153326/output
2025-12-16 15:33:26,979 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories
2025-12-16 15:33:27,015 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 15:33:27,015 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_153326
2025-12-16 15:33:27,015 | INFO     | src.shared.utils.archiver |   - Archived 847 files in 192 directories
2025-12-16 15:33:27,015 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_153326.zip...
2025-12-16 15:33:27,300 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_153326.zip
2025-12-16 15:33:27,304 | INFO     | src.app.pipeline.step_1.handler | Archive created: 847 files, 192 dirs | Size: 13.89 MB
2025-12-16 15:33:27,304 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.94 MB (57.2% compression)
2025-12-16 15:33:27,304 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 15:33:27,306 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories to delete
2025-12-16 15:33:27,316 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 15:33:27,316 | INFO     | src.shared.utils.archiver |   ✓ Deleted 847 files and 192 directories
2025-12-16 15:33:27,316 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 15:33:27,316 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 15:33:27,316 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 15:33:27,316 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:27,414 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 15:33:27,414 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv...
2025-12-16 15:33:27,824 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 15:33:27,824 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 15:33:27,824 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 15:33:27,824 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:27,824 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv
2025-12-16 15:33:27,824 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv...
2025-12-16 15:33:27,824 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 15:33:27,825 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv...
2025-12-16 15:33:27,864 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 15:33:27,864 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 15:33:27,864 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 15:33:27,864 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:27,864 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv
2025-12-16 15:33:27,864 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv...
2025-12-16 15:33:27,864 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 15:33:27,876 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 15:33:27
File: مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 15:33:27,876 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 15:33:27,876 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 15:33:27,876 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:27,876 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv
2025-12-16 15:33:27,876 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_153327.csv...
2025-12-16 15:33:27,876 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 15:33:27,915 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 15:33:27,916 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153327.csv
2025-12-16 15:33:27,916 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 15:33:27,916 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 15:33:27,916 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 15:33:27,916 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:27,916 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153327.csv
2025-12-16 15:33:27,916 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_153327.csv by branches...
2025-12-16 15:33:27,916 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 15:33:27,916 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 15:33:27,929 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 15:33:27,935 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 15:33:27,943 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 15:33:27,949 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 15:33:27,955 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 15:33:27,962 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 15:33:27,966 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 15:33:30,965 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 15:33:32,163 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.20s (218 transfers)
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_asherin.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_wardani.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_akba.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_shahid.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_nujum.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_admin.csv
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.92 surplus=2.08 writes=0.34 total=5.19
2025-12-16 15:33:33,107 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 15:33:33,107 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 15:33:33,107 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 15:33:33,107 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:33,108 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 15:33:33,108 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 15:33:33,108 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_admin_to_akba.csv (5.8 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_153327_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 15:33:33,489 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 15:33:33,489 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 15:33:33,489 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 15:33:33,489 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:33,490 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 15:33:33,490 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 15:33:33,490 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 15:33:33,639 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 15:33:33,639 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 15:33:33,640 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 15:33:34,300 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 15:33:34,300 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 15:33:34,300 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 15:33:34,300 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:34,948 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 15:33:35,621 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 15:33:36,326 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 15:33:36,970 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 15:33:37,603 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 15:33:38,232 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 15:33:38,232 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 15:33:38,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 15:33:38,617 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 15:33:38,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 15:33:38,617 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 15:33:39,316 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 15:33:39,326 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 15:33:39,540 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 15:33:39,541 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 15:33:39,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 15:33:39,541 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 15:33:39,541 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 15:33:39,541 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 15:33:41,455 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 15:33:43,874 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 15:33:46,140 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 15:33:48,353 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 15:33:50,838 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 15:33:52,179 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 15:33:52,180 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 15:33:52,180 | INFO     | src.app.pipeline.step_11.handler | Generated 177 separate files (CSV + Excel)
2025-12-16 15:33:52,180 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 15:33:52,180 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 15:33:52,180 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 19:42:06,879 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 19:42:12,193 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 19:42:12,193 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 19:42:12,193 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 19:42:12,193 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 19:42:12,193 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 19:42:13,650 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 19:42:13,650 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 19:42:13,650 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:13,651 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 19:42:13,651 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 19:42:13,652 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 19:42:13,652 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_194213/output
2025-12-16 19:42:13,656 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories
2025-12-16 19:42:13,698 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 19:42:13,698 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_194213
2025-12-16 19:42:13,698 | INFO     | src.shared.utils.archiver |   - Archived 847 files in 192 directories
2025-12-16 19:42:13,698 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_194213.zip...
2025-12-16 19:42:13,994 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_194213.zip
2025-12-16 19:42:13,999 | INFO     | src.app.pipeline.step_1.handler | Archive created: 847 files, 192 dirs | Size: 13.89 MB
2025-12-16 19:42:13,999 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.94 MB (57.2% compression)
2025-12-16 19:42:13,999 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 19:42:14,001 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories to delete
2025-12-16 19:42:14,012 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 19:42:14,012 | INFO     | src.shared.utils.archiver |   ✓ Deleted 847 files and 192 directories
2025-12-16 19:42:14,012 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 19:42:14,012 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 19:42:14,012 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 19:42:14,013 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:14,114 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 19:42:14,114 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv...
2025-12-16 19:42:14,524 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 19:42:14,524 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 19:42:14,524 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 19:42:14,524 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:14,524 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv
2025-12-16 19:42:14,524 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv...
2025-12-16 19:42:14,524 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 19:42:14,525 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv...
2025-12-16 19:42:14,564 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 19:42:14,564 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 19:42:14,564 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 19:42:14,564 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:14,564 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv
2025-12-16 19:42:14,565 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv...
2025-12-16 19:42:14,565 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 19:42:14,576 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 19:42:14
File: مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 19:42:14,576 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 19:42:14,576 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 19:42:14,576 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:14,577 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv
2025-12-16 19:42:14,577 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_194214.csv...
2025-12-16 19:42:14,577 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 19:42:14,617 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 19:42:14,617 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_194214.csv
2025-12-16 19:42:14,617 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 19:42:14,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 19:42:14,617 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 19:42:14,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:14,617 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_194214.csv
2025-12-16 19:42:14,618 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_194214.csv by branches...
2025-12-16 19:42:14,618 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 19:42:14,618 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 19:42:14,631 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 19:42:14,637 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 19:42:14,645 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 19:42:14,651 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 19:42:14,658 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 19:42:14,665 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 19:42:14,669 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 19:42:17,673 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 19:42:18,898 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.23s (218 transfers)
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_asherin.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_wardani.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_akba.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_shahid.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_nujum.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_admin.csv
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.94 surplus=2.06 writes=0.35 total=5.24
2025-12-16 19:42:19,854 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 19:42:19,854 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 19:42:19,855 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 19:42:19,855 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:19,855 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 19:42:19,855 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 19:42:19,855 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_admin_to_akba.csv (5.8 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 19:42:20,251 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_194214_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 19:42:20,252 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 19:42:20,252 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 19:42:20,252 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 19:42:20,252 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 19:42:20,402 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 19:42:20,403 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 19:42:20,403 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 19:42:21,049 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 19:42:21,049 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 19:42:21,049 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 19:42:21,049 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:21,696 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 19:42:22,343 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 19:42:22,984 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 19:42:23,631 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 19:42:24,280 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 19:42:24,932 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 19:42:24,932 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 19:42:25,318 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 19:42:25,318 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 19:42:25,318 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 19:42:25,318 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 19:42:26,033 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 19:42:26,043 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 19:42:26,259 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 19:42:26,259 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 19:42:26,259 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 19:42:26,259 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 19:42:28,142 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 19:42:30,537 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 19:42:32,793 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 19:42:34,942 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 19:42:37,384 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 19:42:38,709 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 19:42:38,709 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 19:42:38,709 | INFO     | src.app.pipeline.step_11.handler | Generated 177 separate files (CSV + Excel)
2025-12-16 19:42:38,709 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 19:42:38,710 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 19:42:38,710 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 19:43:30,712 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 19:43:31,771 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:08:28,569 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:08:31,025 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 21:08:31,025 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:08:31,025 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 21:08:31,025 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 21:08:31,025 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 21:08:31,860 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 21:08:31,860 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 21:08:31,865 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:31,866 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 21:08:31,867 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 21:08:31,867 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 21:08:31,867 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_210831/output
2025-12-16 21:08:31,875 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories
2025-12-16 21:08:31,913 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 21:08:31,913 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_210831
2025-12-16 21:08:31,913 | INFO     | src.shared.utils.archiver |   - Archived 847 files in 192 directories
2025-12-16 21:08:31,913 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_210831.zip...
2025-12-16 21:08:32,204 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_210831.zip
2025-12-16 21:08:32,208 | INFO     | src.app.pipeline.step_1.handler | Archive created: 847 files, 192 dirs | Size: 13.89 MB
2025-12-16 21:08:32,209 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.94 MB (57.2% compression)
2025-12-16 21:08:32,209 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 21:08:32,210 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories to delete
2025-12-16 21:08:32,222 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 21:08:32,222 | INFO     | src.shared.utils.archiver |   ✓ Deleted 847 files and 192 directories
2025-12-16 21:08:32,222 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 21:08:32,222 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 21:08:32,222 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 21:08:32,222 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:32,320 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 21:08:32,320 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv...
2025-12-16 21:08:32,774 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 21:08:32,774 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 21:08:32,774 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 21:08:32,774 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:32,774 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv
2025-12-16 21:08:32,774 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv...
2025-12-16 21:08:32,774 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:08:32,775 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv...
2025-12-16 21:08:32,815 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 21:08:32,815 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 21:08:32,815 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 21:08:32,815 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:32,815 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv
2025-12-16 21:08:32,815 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv...
2025-12-16 21:08:32,815 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 21:08:32,827 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 21:08:32
File: مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 21:08:32,827 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 21:08:32,827 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 21:08:32,827 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:32,827 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv
2025-12-16 21:08:32,827 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_210832.csv...
2025-12-16 21:08:32,827 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 21:08:32,867 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 21:08:32,867 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_210832.csv
2025-12-16 21:08:32,867 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 21:08:32,867 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 21:08:32,867 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 21:08:32,867 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:32,867 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_210832.csv
2025-12-16 21:08:32,868 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_210832.csv by branches...
2025-12-16 21:08:32,868 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 21:08:32,868 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 21:08:32,880 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 21:08:32,887 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 21:08:32,895 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 21:08:32,901 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 21:08:32,908 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 21:08:32,914 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 21:08:32,919 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 21:08:35,946 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 21:08:37,218 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.27s (218 transfers)
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_asherin.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_wardani.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_akba.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_shahid.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_nujum.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_admin.csv
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=0.94 surplus=2.09 writes=0.36 total=5.32
2025-12-16 21:08:38,192 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 21:08:38,192 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 21:08:38,192 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 21:08:38,192 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:38,193 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 21:08:38,193 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 21:08:38,193 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 21:08:38,578 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 21:08:38,578 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 21:08:38,578 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_admin_to_akba.csv (5.8 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_210832_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 21:08:38,579 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 21:08:38,579 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:08:38,579 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 21:08:38,579 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:08:38,580 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:08:38,731 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 21:08:38,732 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 21:08:38,732 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 21:08:39,403 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 21:08:39,403 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 21:08:39,403 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:08:39,404 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:08:39,404 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:08:39,404 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 21:08:39,404 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 21:08:39,404 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 21:08:39,404 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 21:08:39,404 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 21:08:39,404 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:40,082 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 21:08:40,749 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 21:08:41,420 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 21:08:42,103 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 21:08:42,770 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 21:08:43,453 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 21:08:43,454 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 21:08:43,863 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 21:08:43,863 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 21:08:43,863 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 21:08:43,863 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 21:08:44,597 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 21:08:44,607 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 21:08:44,829 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 21:08:44,829 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 21:08:44,830 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 21:08:44,830 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:08:44,830 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 21:08:46,797 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 21:08:49,231 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 21:08:51,521 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 21:08:53,775 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 21:08:56,331 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 21:08:57,718 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 21:08:57,718 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 21:08:57,718 | INFO     | src.app.pipeline.step_11.handler | Generated 177 separate files (CSV + Excel)
2025-12-16 21:08:57,718 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 21:08:57,718 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 21:08:57,718 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:24:26,731 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:24:26,732 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:24:27,808 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:24:29,262 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:24:30,376 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 21:24:30,376 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:24:30,376 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 21:24:30,376 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 21:24:30,376 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 21:24:52,711 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 21:24:52,711 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 21:24:52,711 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:52,711 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 21:24:52,711 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 21:24:52,711 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 21:24:52,711 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_212452/output
2025-12-16 21:24:52,713 | INFO     | src.shared.utils.archiver |   Found 865 files in 196 directories
2025-12-16 21:24:52,750 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 21:24:52,750 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_212452
2025-12-16 21:24:52,750 | INFO     | src.shared.utils.archiver |   - Archived 865 files in 196 directories
2025-12-16 21:24:52,750 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_212452.zip...
2025-12-16 21:24:53,188 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_212452.zip
2025-12-16 21:24:53,192 | INFO     | src.app.pipeline.step_1.handler | Archive created: 865 files, 196 dirs | Size: 21.57 MB
2025-12-16 21:24:53,192 | INFO     | src.app.pipeline.step_1.handler | ZIP: 8.10 MB (62.4% compression)
2025-12-16 21:24:53,192 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 21:24:53,194 | INFO     | src.shared.utils.archiver |   Found 865 files in 196 directories to delete
2025-12-16 21:24:53,205 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 21:24:53,205 | INFO     | src.shared.utils.archiver |   ✓ Deleted 865 files and 196 directories
2025-12-16 21:24:53,205 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 21:24:53,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 21:24:53,205 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 21:24:53,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:53,304 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251215_073133.xlsx
2025-12-16 21:24:53,305 | INFO     | src.app.pipeline.step_2.handler | Converting selled_stock_all_less_coloum_20251215_073133.xlsx to selled_stock_all_less_coloum_20251216_212453.csv...
2025-12-16 21:24:53,848 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 21:24:53,848 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 21:24:53,848 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 21:24:53,849 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251216_212453.csv
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | Validating selled_stock_all_less_coloum_20251216_212453.csv...
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 13/08/2025 00:00 to 13/11/2025 21:14 (>= 3 months)
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler |     Start: 13/08/2025 00:00, End: 13/11/2025 21:14
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 2 columns
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:24:53,849 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from selled_stock_all_less_coloum_20251216_212453.csv...
2025-12-16 21:24:53,903 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 21:24:53,904 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 21:24:53,904 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 21:24:53,904 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:53,904 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251216_212453.csv
2025-12-16 21:24:53,904 | INFO     | src.app.pipeline.step_4.handler | Analyzing selled_stock_all_less_coloum_20251216_212453.csv...
2025-12-16 21:24:53,904 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 21:24:53,916 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 21:24:53
File: selled_stock_all_less_coloum_20251216_212453.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 7,823
Total Columns: 19
Total Cells: 148,637
Filled Cells: 148,637
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 21:24:53,916 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 21:24:53,916 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 21:24:53,916 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:53,916 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_20251216_212453.csv
2025-12-16 21:24:53,916 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in selled_stock_all_less_coloum_20251216_212453.csv...
2025-12-16 21:24:53,916 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.step_5.handler | Output file: selled_stock_all_less_coloum_renamed_20251216_212453.csv
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 21:24:53,971 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 21:24:53,971 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 21:24:53,971 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: selled_stock_all_less_coloum_renamed_20251216_212453.csv
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.step_6.handler | Splitting selled_stock_all_less_coloum_renamed_20251216_212453.csv by branches...
2025-12-16 21:24:53,971 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 21:24:53,971 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 21:24:53,984 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 21:24:53,992 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 21:24:54,000 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 21:24:54,008 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 21:24:54,015 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 21:24:54,023 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 21:24:54,030 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 7823 products
2025-12-16 21:24:58,768 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 21:25:01,039 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.27s (279 transfers)
2025-12-16 21:25:02,730 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - asherin: selled_stock_all_less_coloum_20251216_212453_asherin.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - wardani: selled_stock_all_less_coloum_20251216_212453_wardani.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - akba: selled_stock_all_less_coloum_20251216_212453_akba.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - shahid: selled_stock_all_less_coloum_20251216_212453_shahid.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - nujum: selled_stock_all_less_coloum_20251216_212453_nujum.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler |   - admin: selled_stock_all_less_coloum_20251216_212453_admin.csv
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=1.27 surplus=3.47 writes=0.62 total=8.76
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=7823 branches=6
2025-12-16 21:25:02,731 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 21:25:02,731 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 21:25:02,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 21:25:02,731 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 21:25:03,365 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251216_212453_from_admin_to_akba.csv (8.2 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251216_212453_from_admin_to_asherin.csv (7.4 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251216_212453_from_admin_to_nujum.csv (5.6 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251216_212453_from_admin_to_shahid.csv (10.3 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251216_212453_from_admin_to_wardani.csv (4.9 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251216_212453_from_akba_to_admin.csv (144.0 B)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251216_212453_from_akba_to_asherin.csv (7.1 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251216_212453_from_akba_to_nujum.csv (7.1 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251216_212453_from_akba_to_shahid.csv (7.1 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251216_212453_from_akba_to_wardani.csv (5.4 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251216_212453_from_asherin_to_akba.csv (9.8 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251216_212453_from_asherin_to_nujum.csv (8.4 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251216_212453_from_asherin_to_shahid.csv (7.3 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251216_212453_from_asherin_to_wardani.csv (5.3 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (5 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → admin: selled_stock_all_less_coloum_20251216_212453_from_nujum_to_admin.csv (86.0 B)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251216_212453_from_nujum_to_akba.csv (24.5 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251216_212453_from_nujum_to_asherin.csv (20.0 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251216_212453_from_nujum_to_shahid.csv (20.3 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251216_212453_from_nujum_to_wardani.csv (13.2 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251216_212453_from_shahid_to_akba.csv (9.9 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251216_212453_from_shahid_to_asherin.csv (7.8 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251216_212453_from_shahid_to_nujum.csv (8.6 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → wardani: selled_stock_all_less_coloum_20251216_212453_from_shahid_to_wardani.csv (7.0 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → akba: selled_stock_all_less_coloum_20251216_212453_from_wardani_to_akba.csv (12.5 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → asherin: selled_stock_all_less_coloum_20251216_212453_from_wardani_to_asherin.csv (9.2 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → nujum: selled_stock_all_less_coloum_20251216_212453_from_wardani_to_nujum.csv (10.7 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler |     → shahid: selled_stock_all_less_coloum_20251216_212453_from_wardani_to_shahid.csv (10.3 KB)
2025-12-16 21:25:03,366 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 21:25:03,366 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 21:25:03,366 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:25:03,366 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:25:03,367 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 21:25:03,367 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:25:03,367 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler | Generated 153 split files:
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:25:03,536 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 21:25:03,537 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 21:25:03,537 | INFO     | src.app.pipeline.step_8.handler | Found 153 split CSV files to convert
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler | Generated 153 Excel files:
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 25 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler |   - other: 26 files
2025-12-16 21:25:04,328 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 21:25:04,328 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 21:25:04,328 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 21:25:04,328 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:25:05,422 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1793 products in 6 categories
2025-12-16 21:25:06,540 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 2250 products in 6 categories
2025-12-16 21:25:07,631 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1980 products in 6 categories
2025-12-16 21:25:08,715 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 2113 products in 6 categories
2025-12-16 21:25:09,810 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 3048 products in 6 categories
2025-12-16 21:25:10,970 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1445 products in 6 categories
2025-12-16 21:25:10,970 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 21:25:11,441 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 21:25:11,441 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 21:25:11,441 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 21:25:11,441 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 21:25:12,746 | INFO     | src.app.pipeline.step_10.handler | Found 2408 products with shortage
2025-12-16 21:25:12,764 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 21:25:13,162 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 569 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - injections: 82 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 63 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - creams: 282 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 31 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - other: 1381 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 2408 products
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 12352 units
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 21:25:13,163 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 21:25:13,163 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 21:25:13,163 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:25:13,163 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 21:25:16,060 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 21:25:19,462 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 21:25:22,500 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 21:25:25,606 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 21:25:30,198 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 21:25:31,970 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 21:25:31,970 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 21:25:31,970 | INFO     | src.app.pipeline.step_11.handler | Generated 180 separate files (CSV + Excel)
2025-12-16 21:25:31,970 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 21:25:31,970 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 21:25:31,971 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:31:25,314 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:31:26,452 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-16 21:33:36,348 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:33:36,348 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:33:36,349 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:33:39,414 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-16 21:33:39,414 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:33:39,414 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-16 21:33:39,414 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-16 21:33:39,414 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-16 21:33:40,389 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-16 21:33:40,390 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-16 21:33:40,390 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:40,390 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-16 21:33:40,390 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-16 21:33:40,390 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-16 21:33:40,390 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251216_213340/output
2025-12-16 21:33:40,392 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories
2025-12-16 21:33:40,427 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-16 21:33:40,427 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251216_213340
2025-12-16 21:33:40,427 | INFO     | src.shared.utils.archiver |   - Archived 847 files in 192 directories
2025-12-16 21:33:40,427 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251216_213340.zip...
2025-12-16 21:33:40,713 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251216_213340.zip
2025-12-16 21:33:40,718 | INFO     | src.app.pipeline.step_1.handler | Archive created: 847 files, 192 dirs | Size: 13.89 MB
2025-12-16 21:33:40,718 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.94 MB (57.2% compression)
2025-12-16 21:33:40,718 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-16 21:33:40,720 | INFO     | src.shared.utils.archiver |   Found 847 files in 192 directories to delete
2025-12-16 21:33:40,730 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-16 21:33:40,731 | INFO     | src.shared.utils.archiver |   ✓ Deleted 847 files and 192 directories
2025-12-16 21:33:40,731 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-16 21:33:40,731 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-16 21:33:40,731 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-16 21:33:40,731 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:40,829 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122.xlsx
2025-12-16 21:33:40,830 | INFO     | src.app.pipeline.step_2.handler | Converting مبيعات الأصناف فى جميع المخازن10122.xlsx to مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv...
2025-12-16 21:33:41,247 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-16 21:33:41,247 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-16 21:33:41,247 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-16 21:33:41,247 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:41,247 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv
2025-12-16 21:33:41,247 | INFO     | src.app.pipeline.step_3.handler | Validating مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv...
2025-12-16 21:33:41,247 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-16 21:33:41,247 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 10/09/2025 00:00 to 10/12/2025 00:47 (>= 3 months)
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler |     Start: 10/09/2025 00:00, End: 10/12/2025 00:47
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-16 21:33:41,248 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv...
2025-12-16 21:33:41,287 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-16 21:33:41,287 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-16 21:33:41,287 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-16 21:33:41,287 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:41,288 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv
2025-12-16 21:33:41,288 | INFO     | src.app.pipeline.step_4.handler | Analyzing مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv...
2025-12-16 21:33:41,288 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-16 21:33:41,299 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-16 21:33:41
File: مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,624
Total Columns: 25
Total Cells: 115,600
Filled Cells: 115,600
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-16 21:33:41,299 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-16 21:33:41,299 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-16 21:33:41,299 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:41,299 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv
2025-12-16 21:33:41,299 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in مبيعات الأصناف فى جميع المخازن10122_20251216_213340.csv...
2025-12-16 21:33:41,299 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-16 21:33:41,340 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-16 21:33:41,340 | INFO     | src.app.pipeline.step_5.handler | Output file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_213341.csv
2025-12-16 21:33:41,340 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-16 21:33:41,340 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-16 21:33:41,340 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-16 21:33:41,340 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:41,340 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_213341.csv
2025-12-16 21:33:41,341 | INFO     | src.app.pipeline.step_6.handler | Splitting مبيعات الأصناف فى جميع المخازن10122_renamed_20251216_213341.csv by branches...
2025-12-16 21:33:41,341 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-16 21:33:41,341 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-16 21:33:41,355 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-16 21:33:41,362 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-16 21:33:41,371 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-16 21:33:41,379 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-16 21:33:41,386 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-16 21:33:41,395 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-16 21:33:41,399 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4624 products
2025-12-16 21:33:44,449 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-16 21:33:45,754 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.30s (218 transfers)
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_asherin.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_wardani.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_akba.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_shahid.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_nujum.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler |   - admin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_admin.csv
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=0.94 surplus=2.10 writes=0.39 total=5.44
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4624 branches=6
2025-12-16 21:33:46,785 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-16 21:33:46,785 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-16 21:33:46,785 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-16 21:33:46,785 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-16 21:33:46,786 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | Generated 25 transfer files:
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_admin_to_akba.csv (5.8 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_admin_to_asherin.csv (4.8 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_admin_to_nujum.csv (11.3 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_admin_to_shahid.csv (7.6 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_admin_to_wardani.csv (5.4 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (4 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_akba_to_asherin.csv (5.2 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_akba_to_nujum.csv (7.5 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_akba_to_shahid.csv (5.7 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_akba_to_wardani.csv (3.0 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_asherin_to_akba.csv (3.1 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_asherin_to_nujum.csv (5.0 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_asherin_to_shahid.csv (4.3 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_asherin_to_wardani.csv (2.2 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_nujum_to_akba.csv (7.4 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_nujum_to_asherin.csv (7.7 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_nujum_to_shahid.csv (7.0 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_nujum_to_wardani.csv (4.1 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (4 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_shahid_to_akba.csv (5.4 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_shahid_to_asherin.csv (5.0 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_shahid_to_nujum.csv (5.1 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → wardani: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_shahid_to_wardani.csv (3.4 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → akba: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_wardani_to_akba.csv (5.5 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → asherin: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_wardani_to_asherin.csv (6.2 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → nujum: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_wardani_to_nujum.csv (9.6 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler |     → shahid: مبيعات الأصناف فى جميع المخازن10122_20251216_213341_from_wardani_to_shahid.csv (7.3 KB)
2025-12-16 21:33:47,203 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-16 21:33:47,204 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-16 21:33:47,204 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:33:47,204 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:47,204 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-16 21:33:47,204 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:33:47,204 | INFO     | src.app.pipeline.step_8.handler | Found 25 transfer files to split
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Generated 148 split files:
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-16 21:33:47,367 | INFO     | src.app.pipeline.step_8.handler | Found 148 split CSV files to convert
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler | Generated 148 Excel files:
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 25 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - injections: 25 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 23 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-16 21:33:48,036 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-16 21:33:48,036 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-16 21:33:48,036 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-16 21:33:48,036 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:48,697 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1306 products in 6 categories
2025-12-16 21:33:49,364 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 1632 products in 6 categories
2025-12-16 21:33:50,022 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1647 products in 6 categories
2025-12-16 21:33:50,694 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1641 products in 6 categories
2025-12-16 21:33:51,360 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1940 products in 6 categories
2025-12-16 21:33:52,010 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 1497 products in 6 categories
2025-12-16 21:33:52,010 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-16 21:33:52,396 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-16 21:33:52,396 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-16 21:33:52,396 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-16 21:33:52,396 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-16 21:33:52,396 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-16 21:33:52,396 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-16 21:33:52,396 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-16 21:33:52,396 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:52,397 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-16 21:33:52,397 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-16 21:33:53,128 | INFO     | src.app.pipeline.step_10.handler | Found 1179 products with shortage
2025-12-16 21:33:53,138 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 567 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - injections: 85 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 82 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - creams: 97 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 32 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - other: 316 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1179 products
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 6838 units
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-16 21:33:53,353 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-16 21:33:53,354 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-16 21:33:53,354 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-16 21:33:53,354 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-16 21:33:53,354 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-16 21:33:55,344 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-16 21:33:57,810 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-16 21:34:00,119 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-16 21:34:02,336 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-16 21:34:04,957 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-16 21:34:06,367 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-16 21:34:06,367 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-16 21:34:06,367 | INFO     | src.app.pipeline.step_11.handler | Generated 177 separate files (CSV + Excel)
2025-12-16 21:34:06,368 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-16 21:34:06,368 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-16 21:34:06,368 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-16 21:35:32,096 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-16 21:35:32,097 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-16 21:35:32,097 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-16 21:35:32,097 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-16 21:35:32,097 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-16 21:35:32,097 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-16 21:35:32,455 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 15:33:51,733 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 15:33:51,734 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 15:33:54,097 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 15:33:54,097 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 15:33:54,097 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 15:33:54,097 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 15:33:54,097 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 15:33:55,098 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 15:33:55,098 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 15:33:55,098 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,099 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 15:33:55,099 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 15:33:55,100 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 15:33:55,100 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_153355/output
2025-12-21 15:33:55,100 | INFO     | src.shared.utils.archiver |   Found 14 files in 20 directories
2025-12-21 15:33:55,117 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 15:33:55,117 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_153355
2025-12-21 15:33:55,117 | INFO     | src.shared.utils.archiver |   - Archived 14 files in 20 directories
2025-12-21 15:33:55,117 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_153355.zip...
2025-12-21 15:33:55,278 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_153355.zip
2025-12-21 15:33:55,278 | INFO     | src.app.pipeline.step_1.handler | Archive created: 14 files, 20 dirs | Size: 8.56 MB
2025-12-21 15:33:55,278 | INFO     | src.app.pipeline.step_1.handler | ZIP: 1.60 MB (81.3% compression)
2025-12-21 15:33:55,278 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 15:33:55,278 | INFO     | src.shared.utils.archiver |   Found 14 files in 20 directories to delete
2025-12-21 15:33:55,279 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 15:33:55,279 | INFO     | src.shared.utils.archiver |   ✓ Deleted 14 files and 20 directories
2025-12-21 15:33:55,279 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 15:33:55,279 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 15:33:55,279 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 15:33:55,279 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,421 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 15:33:55,421 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_153355.csv...
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 15:33:55,832 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 15:33:55,832 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 15:33:55,832 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_153355.csv
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_153355.csv...
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 15:33:55,832 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 15:33:55,833 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 15:33:55,833 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_153355.csv...
2025-12-21 15:33:55,877 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 15:33:55,878 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 15:33:55,878 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 15:33:55,878 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,878 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_153355.csv
2025-12-21 15:33:55,878 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_153355.csv...
2025-12-21 15:33:55,878 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 15:33:55,887 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 15:33:55
File: problemm20251220_20251221_153355.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 15:33:55,887 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 15:33:55,887 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 15:33:55,887 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,887 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_153355.csv
2025-12-21 15:33:55,887 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_153355.csv...
2025-12-21 15:33:55,887 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_153355.csv
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 15:33:55,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 15:33:55,933 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 15:33:55,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_153355.csv
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_153355.csv by branches...
2025-12-21 15:33:55,933 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 15:33:55,934 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-21 15:33:55,943 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 15:33:55,949 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 15:33:55,956 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 15:33:55,961 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 15:33:55,966 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 15:33:55,971 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 15:33:55,975 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 15:33:59,086 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 15:34:00,410 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.32s (198 transfers)
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_153355_asherin.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_153355_wardani.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_153355_akba.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_153355_shahid.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_153355_nujum.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_153355_admin.csv
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=2.02 writes=0.36 total=5.46
2025-12-21 15:34:01,389 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 15:34:01,390 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 15:34:01,390 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 15:34:01,390 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:34:01,390 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 15:34:01,390 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 15:34:01,390 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_153355_from_admin_to_akba.csv (9.2 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_153355_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_153355_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_153355_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_153355_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_153355_from_akba_to_admin.csv (84.0 B)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_153355_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_153355_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_153355_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_153355_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_153355_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_153355_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_153355_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_153355_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_153355_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_153355_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_153355_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_153355_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_153355_from_shahid_to_admin.csv (87.0 B)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_153355_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_153355_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 15:34:01,777 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_153355_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_153355_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_153355_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_153355_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_153355_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_153355_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 15:34:01,778 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 15:34:01,778 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 15:34:01,778 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 15:34:01,778 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 15:34:01,932 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 15:34:01,933 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 15:34:01,933 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 15:34:02,557 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 15:34:02,558 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 15:34:02,558 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 15:34:02,558 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:34:03,213 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 15:34:03,858 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 15:34:04,517 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 15:34:05,165 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 15:34:05,821 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 15:34:06,482 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 15:34:06,482 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 15:34:06,818 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 15:34:06,818 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 15:34:06,818 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 15:34:06,818 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 15:34:06,818 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 15:34:06,819 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 15:34:06,819 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 15:34:06,819 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:34:06,819 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 15:34:06,819 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 15:34:07,547 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 15:34:07,558 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 15:34:07,802 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 15:34:07,803 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 15:34:07,803 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 15:34:07,803 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 15:34:07,803 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 15:34:07,803 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 15:34:07,803 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 15:34:07,803 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 15:34:07,803 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 15:34:09,526 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 15:34:10,973 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 15:34:12,874 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 15:34:15,044 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 15:34:17,088 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 15:34:18,717 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 15:34:18,717 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 15:34:18,717 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 15:34:18,717 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 15:34:18,717 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 15:34:18,717 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 20:47:15,055 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 20:47:15,056 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 20:47:15,056 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 20:47:15,056 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 20:47:15,056 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 20:47:15,056 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 20:47:18,274 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 20:47:18,274 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 20:47:18,275 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 20:47:18,275 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 20:47:18,275 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 20:47:18,849 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 20:47:18,849 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 20:47:18,849 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:18,850 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 20:47:18,851 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 20:47:18,851 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 20:47:18,851 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_204718/output
2025-12-21 20:47:18,861 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 20:47:18,903 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 20:47:18,903 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_204718
2025-12-21 20:47:18,903 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 20:47:18,903 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_204718.zip...
2025-12-21 20:47:19,187 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_204718.zip
2025-12-21 20:47:19,192 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 20:47:19,192 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 20:47:19,192 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 20:47:19,193 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 20:47:19,205 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 20:47:19,205 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 20:47:19,205 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 20:47:19,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 20:47:19,205 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 20:47:19,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:19,323 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 20:47:19,323 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_204719.csv...
2025-12-21 20:47:19,746 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 20:47:19,746 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 20:47:19,746 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 20:47:19,746 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:19,746 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_204719.csv
2025-12-21 20:47:19,746 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_204719.csv...
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 20:47:19,747 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_204719.csv...
2025-12-21 20:47:19,791 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 20:47:19,791 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 20:47:19,791 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 20:47:19,791 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:19,791 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_204719.csv
2025-12-21 20:47:19,791 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_204719.csv...
2025-12-21 20:47:19,791 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 20:47:19,800 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 20:47:19
File: problemm20251220_20251221_204719.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 20:47:19,800 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 20:47:19,800 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 20:47:19,800 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:19,800 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_204719.csv
2025-12-21 20:47:19,801 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_204719.csv...
2025-12-21 20:47:19,801 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 20:47:19,845 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 20:47:19,845 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_204719.csv
2025-12-21 20:47:19,845 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 20:47:19,845 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 20:47:19,845 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 20:47:19,845 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:19,845 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_204719.csv
2025-12-21 20:47:19,846 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_204719.csv by branches...
2025-12-21 20:47:19,846 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 20:47:19,846 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days for avg_sales calculation
2025-12-21 20:47:19,855 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 20:47:19,860 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 20:47:19,866 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 20:47:19,871 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 20:47:19,877 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 20:47:19,882 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 20:47:19,886 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 20:47:22,920 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 20:47:24,243 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.32s (198 transfers)
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_204719_asherin.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_204719_wardani.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_204719_akba.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_204719_shahid.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_204719_nujum.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_204719_admin.csv
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.04 surplus=1.99 writes=0.34 total=5.34
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 20:47:25,189 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 20:47:25,189 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 20:47:25,189 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 20:47:25,189 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_204719_from_admin_to_akba.csv (9.2 KB)
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_204719_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_204719_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_204719_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_204719_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 20:47:25,574 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_204719_from_akba_to_admin.csv (84.0 B)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_204719_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_204719_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_204719_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_204719_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_204719_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_204719_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_204719_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_204719_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_204719_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_204719_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_204719_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_204719_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_204719_from_shahid_to_admin.csv (87.0 B)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_204719_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_204719_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_204719_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_204719_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_204719_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_204719_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_204719_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_204719_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 20:47:25,575 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 20:47:25,575 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 20:47:25,575 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 20:47:25,575 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 20:47:25,728 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 20:47:25,729 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 20:47:25,729 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 20:47:26,404 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 20:47:26,405 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 20:47:26,405 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 20:47:26,405 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 20:47:26,405 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 20:47:26,405 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:27,064 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 20:47:27,720 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 20:47:28,391 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 20:47:29,023 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 20:47:29,662 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 20:47:30,307 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 20:47:30,307 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 20:47:30,642 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 20:47:30,642 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 20:47:30,642 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 20:47:30,642 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 20:47:30,642 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 20:47:30,643 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 20:47:30,643 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 20:47:30,643 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:30,643 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 20:47:30,643 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 20:47:31,349 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 20:47:31,360 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 20:47:31,603 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 20:47:31,603 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 20:47:31,603 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 20:47:31,603 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 20:47:31,604 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 20:47:33,285 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 20:47:34,713 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 20:47:36,586 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 20:47:38,823 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 20:47:40,945 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 20:47:42,575 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 20:47:42,575 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 20:47:42,575 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 20:47:42,575 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 20:47:42,575 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 20:47:42,575 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:14:41,323 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:14:41,323 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:14:41,323 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:14:41,324 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:14:41,324 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:14:41,324 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:14:41,324 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:14:41,324 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:14:41,325 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:14:42,455 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:14:44,068 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:14:44,069 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:14:45,242 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:14:45,242 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:14:45,242 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:14:45,242 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:14:45,242 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:14:46,481 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:14:46,482 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:14:46,482 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:46,483 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:14:46,484 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:14:46,484 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:14:46,484 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_211446/output
2025-12-21 21:14:46,495 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:14:46,547 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:14:46,547 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_211446
2025-12-21 21:14:46,547 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:14:46,547 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_211446.zip...
2025-12-21 21:14:46,833 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_211446.zip
2025-12-21 21:14:46,837 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:14:46,837 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:14:46,837 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:14:46,839 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:14:46,853 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:14:46,853 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:14:46,853 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:14:46,853 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:14:46,853 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:14:46,853 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:46,964 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:14:46,964 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_211446.csv...
2025-12-21 21:14:47,382 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:14:47,382 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:14:47,382 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:14:47,382 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:47,382 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_211446.csv
2025-12-21 21:14:47,382 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_211446.csv...
2025-12-21 21:14:47,382 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:14:47,383 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_211446.csv...
2025-12-21 21:14:47,427 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:14:47,427 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:14:47,427 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:14:47,427 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:47,428 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_211446.csv
2025-12-21 21:14:47,428 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_211446.csv...
2025-12-21 21:14:47,428 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:14:47,437 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:14:47
File: problemm20251220_20251221_211446.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:14:47,437 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:14:47,437 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:14:47,437 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:47,437 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_211446.csv
2025-12-21 21:14:47,437 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_211446.csv...
2025-12-21 21:14:47,437 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:14:47,482 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:14:47,482 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_211447.csv
2025-12-21 21:14:47,482 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:14:47,482 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:14:47,482 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:14:47,482 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:47,482 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_211447.csv
2025-12-21 21:14:47,483 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_211447.csv by branches...
2025-12-21 21:14:47,483 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:14:47,483 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:14:47,496 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:14:47,502 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:14:47,507 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:14:47,512 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:14:47,517 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:14:47,523 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:14:47,523 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:14:50,481 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:14:51,776 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.29s (198 transfers)
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_211447_asherin.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_211447_wardani.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_211447_akba.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_211447_shahid.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_211447_nujum.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_211447_admin.csv
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.05 surplus=1.91 writes=0.35 total=5.24
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:14:52,724 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:14:52,724 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:14:52,724 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:14:52,724 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_211447_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_211447_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_211447_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_211447_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_211447_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_211447_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_211447_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_211447_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_211447_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_211447_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_211447_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_211447_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_211447_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_211447_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_211447_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_211447_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_211447_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_211447_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_211447_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_211447_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_211447_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_211447_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_211447_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_211447_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_211447_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_211447_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_211447_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:14:53,106 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:14:53,106 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:14:53,106 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:14:53,106 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:53,107 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:14:53,107 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:14:53,107 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:14:53,259 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:14:53,887 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:14:53,887 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:14:53,887 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:14:53,887 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:54,521 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:14:55,169 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:14:55,800 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:14:56,439 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:14:57,087 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:14:57,723 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:14:57,724 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:14:58,075 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:14:58,075 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:14:58,075 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:14:58,075 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:14:58,075 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:14:58,075 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:14:58,075 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:14:58,076 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:58,076 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:14:58,076 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:14:58,658 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:14:58,669 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:14:58,906 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:14:58,906 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:14:58,906 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:14:58,906 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:14:58,906 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:14:58,907 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:14:58,907 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:14:58,907 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:14:58,907 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:15:00,591 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:15:02,048 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:15:03,947 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:15:06,097 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:15:08,065 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:15:09,658 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:15:09,658 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:15:09,658 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:15:09,658 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:15:09,658 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:15:09,658 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:22:34,417 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:22:34,417 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:22:34,417 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:34,417 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:22:34,418 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:22:34,419 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:22:34,420 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:22:34,421 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:22:34,421 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:22:34,421 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:22:34,421 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:34,832 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-12-21 21:22:36,153 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:22:36,154 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:22:36,154 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:36,154 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:22:36,154 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:22:36,154 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:22:36,155 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:22:36,156 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:22:36,157 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:22:36,157 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:22:36,157 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:22:36,157 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:22:36,157 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:36,649 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:22:38,434 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:22:38,435 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:22:38,435 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:22:39,857 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:22:39,857 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:22:39,857 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:22:39,858 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:22:39,858 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:22:40,344 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:22:40,344 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:22:40,345 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:40,345 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:22:40,346 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:22:40,346 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:22:40,346 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_212240/output
2025-12-21 21:22:40,357 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:22:40,401 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:22:40,401 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_212240
2025-12-21 21:22:40,401 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:22:40,401 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_212240.zip...
2025-12-21 21:22:40,696 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_212240.zip
2025-12-21 21:22:40,700 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:22:40,700 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:22:40,700 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:22:40,702 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:22:40,717 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:22:40,717 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:22:40,717 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:22:40,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:22:40,717 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:22:40,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:40,830 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:22:40,831 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_212240.csv...
2025-12-21 21:22:41,243 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:22:41,244 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:22:41,244 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:22:41,244 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_212240.csv
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_212240.csv...
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:22:41,244 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:22:41,245 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:22:41,245 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:22:41,245 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:22:41,245 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:22:41,245 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_212240.csv...
2025-12-21 21:22:41,288 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:22:41,288 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:22:41,288 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:22:41,288 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:41,288 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_212240.csv
2025-12-21 21:22:41,288 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_212240.csv...
2025-12-21 21:22:41,288 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:22:41,297 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:22:41
File: problemm20251220_20251221_212240.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:22:41,297 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:22:41,298 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:22:41,298 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:41,298 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_212240.csv
2025-12-21 21:22:41,298 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_212240.csv...
2025-12-21 21:22:41,298 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:22:41,344 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:22:41,344 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_212241.csv
2025-12-21 21:22:41,345 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:22:41,345 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:22:41,345 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:22:41,345 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:41,345 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_212241.csv
2025-12-21 21:22:41,345 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_212241.csv by branches...
2025-12-21 21:22:41,345 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:22:41,345 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:22:41,359 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:22:41,365 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:22:41,370 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:22:41,375 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:22:41,380 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:22:41,385 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:22:41,385 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:22:44,491 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:22:45,849 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.36s (198 transfers)
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_212241_asherin.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_212241_wardani.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_212241_akba.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_212241_shahid.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_212241_nujum.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_212241_admin.csv
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.11 surplus=1.99 writes=0.37 total=5.51
2025-12-21 21:22:46,855 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:22:46,855 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:22:46,855 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:22:46,855 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:46,856 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:22:46,856 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:22:46,856 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_212241_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_212241_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_212241_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_212241_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_212241_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:22:47,243 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_212241_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_212241_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_212241_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_212241_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_212241_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_212241_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_212241_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_212241_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_212241_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_212241_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_212241_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_212241_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_212241_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_212241_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_212241_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_212241_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_212241_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_212241_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_212241_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_212241_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_212241_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_212241_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:22:47,244 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:22:47,244 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:22:47,244 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:22:47,244 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:47,245 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:22:47,245 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:22:47,245 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:22:47,406 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:22:47,407 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:22:47,407 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:22:48,037 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:22:48,038 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:22:48,038 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:22:48,038 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:22:48,038 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:48,705 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:22:49,361 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:22:50,004 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:22:50,649 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:22:51,305 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:22:51,948 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:22:51,949 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:22:52,286 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:22:52,286 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:22:52,286 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:22:52,286 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:22:52,286 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:22:52,286 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:22:52,287 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:22:52,287 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:52,287 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:22:52,287 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:22:52,896 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:22:52,907 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:22:53,157 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:22:53,158 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:22:53,158 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:22:53,158 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:22:53,158 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:22:54,889 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:22:56,359 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:22:58,274 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:23:00,449 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:23:02,566 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:23:04,312 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:23:04,312 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:23:04,312 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:23:04,312 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:23:04,312 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:23:04,312 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:23:04,313 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:23:04,313 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:30:04,817 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:30:04,818 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:30:04,818 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:30:04,818 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:30:04,818 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:30:04,819 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:30:04,820 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:30:04,821 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:30:05,979 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:30:07,216 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:30:08,499 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:30:08,499 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:30:08,499 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:30:08,499 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:30:08,499 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:30:09,304 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:30:09,305 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:30:09,305 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:09,306 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:30:09,307 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:30:09,307 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:30:09,308 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_213009/output
2025-12-21 21:30:09,319 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:30:09,362 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:30:09,362 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_213009
2025-12-21 21:30:09,362 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:30:09,362 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_213009.zip...
2025-12-21 21:30:09,668 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_213009.zip
2025-12-21 21:30:09,673 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:30:09,673 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:30:09,673 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:30:09,674 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:30:09,687 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:30:09,687 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:30:09,687 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:30:09,687 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:30:09,687 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:30:09,687 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:09,785 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:30:09,785 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_213009.csv...
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:30:10,218 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:30:10,218 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:30:10,218 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213009.csv
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_213009.csv...
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:30:10,218 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:30:10,219 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_213009.csv...
2025-12-21 21:30:10,263 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:30:10,263 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:30:10,263 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:30:10,263 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:10,263 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213009.csv
2025-12-21 21:30:10,263 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_213009.csv...
2025-12-21 21:30:10,264 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:30:10,273 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:30:10
File: problemm20251220_20251221_213009.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:30:10,273 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:30:10,273 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:30:10,273 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:10,273 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213009.csv
2025-12-21 21:30:10,273 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_213009.csv...
2025-12-21 21:30:10,273 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:30:10,317 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:30:10,317 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_213010.csv
2025-12-21 21:30:10,317 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:30:10,317 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:30:10,317 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:30:10,317 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:10,317 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_213010.csv
2025-12-21 21:30:10,318 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_213010.csv by branches...
2025-12-21 21:30:10,318 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:30:10,318 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:30:10,331 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:30:10,337 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:30:10,342 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:30:10,347 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:30:10,352 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:30:10,357 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:30:10,357 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:30:13,354 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:30:14,692 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.34s (198 transfers)
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_213010_asherin.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_213010_wardani.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_213010_akba.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_213010_shahid.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_213010_nujum.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_213010_admin.csv
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=1.94 writes=0.34 total=5.34
2025-12-21 21:30:15,655 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:30:15,655 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:30:15,655 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:30:15,655 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:15,656 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:30:15,656 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:30:15,656 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:30:16,043 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213010_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213010_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213010_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213010_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213010_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_213010_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213010_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213010_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213010_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213010_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213010_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213010_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213010_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213010_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213010_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213010_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213010_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213010_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_213010_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213010_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213010_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213010_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213010_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213010_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213010_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213010_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213010_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:30:16,044 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:30:16,044 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:30:16,044 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:30:16,044 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:16,045 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:30:16,045 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:30:16,045 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:30:16,195 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:30:16,196 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:30:16,196 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:30:16,847 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:30:16,848 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:30:16,848 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:30:16,848 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:30:16,848 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:17,501 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:30:18,150 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:30:18,796 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:30:19,449 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:30:20,101 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:30:20,752 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:30:20,752 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:30:21,090 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:30:21,090 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:30:21,090 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:21,090 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:30:21,091 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:30:21,687 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:30:21,698 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:30:21,946 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:30:21,946 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:30:21,946 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:30:21,946 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:30:23,663 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:30:25,241 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:30:27,242 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:30:29,453 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:30:31,636 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:30:33,329 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:30:33,329 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:30:33,329 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:30:33,329 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:30:33,329 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:30:33,329 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:37:40,087 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:37:40,087 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:37:40,088 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:37:40,089 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:37:40,090 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:37:40,090 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:37:40,090 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:37:40,090 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:37:40,090 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:37:40,091 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:37:40,091 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:37:40,091 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:37:40,091 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:37:40,091 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:37:40,092 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:37:40,092 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:37:40,092 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:37:52,039 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:37:55,025 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:37:55,026 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:37:58,311 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:37:58,311 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:37:58,311 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:37:58,312 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:37:58,312 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:37:59,374 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:37:59,374 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:37:59,374 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:37:59,376 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:37:59,376 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:37:59,376 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:37:59,377 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_213759/output
2025-12-21 21:37:59,387 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:37:59,438 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:37:59,438 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_213759
2025-12-21 21:37:59,438 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:37:59,439 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_213759.zip...
2025-12-21 21:37:59,743 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_213759.zip
2025-12-21 21:37:59,747 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:37:59,747 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:37:59,747 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:37:59,749 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:37:59,760 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:37:59,760 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:37:59,760 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:37:59,760 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:37:59,760 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:37:59,760 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:37:59,861 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:37:59,861 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_213759.csv...
2025-12-21 21:38:00,311 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:38:00,311 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:38:00,311 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:38:00,311 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:00,311 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213759.csv
2025-12-21 21:38:00,311 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_213759.csv...
2025-12-21 21:38:00,311 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:38:00,312 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_213759.csv...
2025-12-21 21:38:00,361 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:38:00,361 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:38:00,362 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:38:00,362 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:00,362 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213759.csv
2025-12-21 21:38:00,362 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_213759.csv...
2025-12-21 21:38:00,362 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:38:00,373 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:38:00
File: problemm20251220_20251221_213759.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:38:00,373 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:38:00,373 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:38:00,373 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:00,373 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_213759.csv
2025-12-21 21:38:00,373 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_213759.csv...
2025-12-21 21:38:00,373 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:38:00,425 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:38:00,425 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_213800.csv
2025-12-21 21:38:00,425 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:38:00,425 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:38:00,425 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:38:00,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:00,425 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_213800.csv
2025-12-21 21:38:00,426 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_213800.csv by branches...
2025-12-21 21:38:00,426 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:38:00,426 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:38:00,440 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:38:00,446 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:38:00,452 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:38:00,457 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:38:00,463 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:38:00,468 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:38:00,468 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:38:03,579 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:38:04,923 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.34s (198 transfers)
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_213800_asherin.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_213800_wardani.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_213800_akba.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_213800_shahid.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_213800_nujum.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_213800_admin.csv
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=2.02 writes=0.36 total=5.48
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:38:05,903 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:38:05,903 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:38:05,903 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:38:05,903 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213800_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213800_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213800_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213800_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213800_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_213800_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213800_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213800_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213800_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213800_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213800_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213800_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213800_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213800_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213800_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213800_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213800_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213800_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_213800_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213800_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213800_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213800_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_213800_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_213800_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_213800_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_213800_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_213800_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:38:06,298 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:38:06,298 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:38:06,298 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:38:06,298 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:06,299 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:38:06,299 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:38:06,299 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:38:06,452 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:38:06,453 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:38:06,453 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:38:07,125 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:38:07,125 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:38:07,125 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:38:07,125 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:07,797 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:38:08,455 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:38:09,110 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:38:09,757 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:38:10,417 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:38:11,075 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:38:11,075 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:38:11,427 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:38:11,427 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:38:11,427 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:38:11,427 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:38:11,427 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:38:11,428 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:38:11,428 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:38:11,428 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:11,428 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:38:11,428 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:38:12,038 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:38:12,048 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:38:12,292 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:38:12,292 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:38:12,292 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:38:12,292 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:38:14,043 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:38:15,523 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:38:17,442 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:38:19,669 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:38:21,685 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:38:23,313 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:38:23,313 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:38:23,313 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:38:23,313 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:38:23,313 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:38:23,313 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:40:49,266 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:40:49,266 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:40:49,266 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:40:49,266 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:40:49,267 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:40:49,268 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:40:49,269 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:40:49,270 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:40:49,270 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:40:49,721 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:40:51,045 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:40:52,192 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:40:52,193 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:40:52,193 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:40:52,193 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:40:52,194 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:40:52,657 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:40:52,658 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:40:52,658 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:52,659 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:40:52,659 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:40:52,660 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:40:52,660 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_214052/output
2025-12-21 21:40:52,670 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:40:52,716 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:40:52,716 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_214052
2025-12-21 21:40:52,716 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:40:52,716 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_214052.zip...
2025-12-21 21:40:53,005 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_214052.zip
2025-12-21 21:40:53,009 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:40:53,009 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:40:53,009 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:40:53,011 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:40:53,021 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:40:53,021 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:40:53,021 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:40:53,021 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:40:53,021 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:40:53,021 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:53,123 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:40:53,123 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_214053.csv...
2025-12-21 21:40:53,531 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:40:53,531 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:40:53,531 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:40:53,531 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:53,531 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_214053.csv
2025-12-21 21:40:53,531 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_214053.csv...
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:40:53,532 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_214053.csv...
2025-12-21 21:40:53,575 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:40:53,575 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:40:53,575 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:40:53,575 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:53,575 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_214053.csv
2025-12-21 21:40:53,575 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_214053.csv...
2025-12-21 21:40:53,575 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:40:53,584 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:40:53
File: problemm20251220_20251221_214053.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:40:53,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:40:53,585 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:40:53,585 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:53,585 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_214053.csv
2025-12-21 21:40:53,585 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_214053.csv...
2025-12-21 21:40:53,585 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:40:53,628 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:40:53,628 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_214053.csv
2025-12-21 21:40:53,628 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:40:53,629 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:40:53,629 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:40:53,629 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:53,629 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_214053.csv
2025-12-21 21:40:53,629 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_214053.csv by branches...
2025-12-21 21:40:53,629 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:40:53,629 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:40:53,642 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:40:53,648 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:40:53,653 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:40:53,658 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:40:53,663 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:40:53,668 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:40:53,668 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:40:56,743 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:40:58,056 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.31s (198 transfers)
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_214053_asherin.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_214053_wardani.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_214053_akba.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_214053_shahid.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_214053_nujum.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_214053_admin.csv
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=2.01 writes=0.35 total=5.38
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:40:59,005 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:40:59,005 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:40:59,005 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:40:59,005 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_214053_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_214053_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_214053_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_214053_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_214053_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_214053_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_214053_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_214053_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_214053_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_214053_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_214053_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_214053_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_214053_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_214053_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_214053_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_214053_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_214053_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_214053_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_214053_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_214053_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_214053_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_214053_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_214053_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_214053_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_214053_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_214053_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:40:59,388 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_214053_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:40:59,389 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:40:59,389 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:40:59,389 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:40:59,389 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:40:59,389 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:40:59,389 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:40:59,389 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:40:59,537 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:40:59,537 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:40:59,537 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:40:59,538 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:41:00,157 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:41:00,157 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:41:00,157 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:41:00,157 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:41:00,811 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:41:01,474 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:41:02,118 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:41:02,771 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:41:03,424 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:41:04,077 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:41:04,077 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:41:04,411 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:41:04,411 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:41:04,411 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:41:04,411 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:41:04,998 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:41:05,008 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:41:05,248 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:41:05,248 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:41:05,248 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:41:05,249 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:41:05,249 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:41:05,249 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:41:05,249 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:41:06,965 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:41:08,432 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:41:10,379 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:41:12,579 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:41:14,606 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:41:16,331 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:41:16,331 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:41:16,331 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:41:16,331 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:41:16,331 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:41:16,331 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:59:05,185 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:59:05,185 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:59:05,185 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:59:05,185 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:59:05,185 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:59:05,186 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:59:05,187 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:59:05,188 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:59:05,189 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:59:06,296 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 21:59:09,187 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 21:59:10,840 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 21:59:10,841 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:59:10,841 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 21:59:10,841 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 21:59:10,841 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 21:59:11,252 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 21:59:11,252 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 21:59:11,252 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:11,252 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 21:59:11,252 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 21:59:11,252 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 21:59:11,252 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_215911/output
2025-12-21 21:59:11,254 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 21:59:11,292 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 21:59:11,292 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_215911
2025-12-21 21:59:11,292 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 21:59:11,292 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_215911.zip...
2025-12-21 21:59:11,612 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_215911.zip
2025-12-21 21:59:11,616 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 21:59:11,617 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 21:59:11,617 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 21:59:11,619 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 21:59:11,635 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 21:59:11,635 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 21:59:11,635 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 21:59:11,636 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 21:59:11,636 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 21:59:11,636 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:11,734 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 21:59:11,734 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_215911.csv...
2025-12-21 21:59:12,134 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 21:59:12,134 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 21:59:12,134 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 21:59:12,135 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_215911.csv
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_215911.csv...
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 21:59:12,135 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_215911.csv...
2025-12-21 21:59:12,179 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 21:59:12,179 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 21:59:12,179 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 21:59:12,179 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:12,179 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_215911.csv
2025-12-21 21:59:12,179 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_215911.csv...
2025-12-21 21:59:12,179 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 21:59:12,188 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 21:59:12
File: problemm20251220_20251221_215911.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 21:59:12,188 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 21:59:12,188 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 21:59:12,188 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:12,188 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_215911.csv
2025-12-21 21:59:12,188 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_215911.csv...
2025-12-21 21:59:12,188 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_215912.csv
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 21:59:12,232 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 21:59:12,232 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 21:59:12,232 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_215912.csv
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_215912.csv by branches...
2025-12-21 21:59:12,232 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 21:59:12,232 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 21:59:12,246 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 21:59:12,251 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 21:59:12,256 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 21:59:12,262 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 21:59:12,267 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 21:59:12,272 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 21:59:12,272 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 21:59:15,355 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 21:59:16,673 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.32s (198 transfers)
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_215912_asherin.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_215912_wardani.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_215912_akba.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_215912_shahid.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_215912_nujum.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_215912_admin.csv
2025-12-21 21:59:17,664 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=2.01 writes=0.35 total=5.43
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 21:59:17,665 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 21:59:17,665 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 21:59:17,665 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 21:59:17,665 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_215912_from_admin_to_akba.csv (9.2 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_215912_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_215912_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_215912_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_215912_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_215912_from_akba_to_admin.csv (84.0 B)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_215912_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_215912_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_215912_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_215912_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_215912_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_215912_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_215912_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_215912_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_215912_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_215912_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_215912_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_215912_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_215912_from_shahid_to_admin.csv (87.0 B)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_215912_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_215912_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_215912_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_215912_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_215912_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_215912_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_215912_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_215912_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 21:59:18,058 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 21:59:18,058 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 21:59:18,058 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 21:59:18,058 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:18,059 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 21:59:18,059 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:59:18,059 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 21:59:18,211 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 21:59:18,212 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 21:59:18,212 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 21:59:18,852 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 21:59:18,852 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 21:59:18,852 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 21:59:18,852 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:19,536 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 21:59:20,217 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 21:59:20,866 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 21:59:21,523 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 21:59:22,188 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 21:59:22,847 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 21:59:22,847 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 21:59:23,185 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 21:59:23,185 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 21:59:23,185 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 21:59:23,185 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 21:59:23,185 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 21:59:23,185 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 21:59:23,185 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 21:59:23,185 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:23,186 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 21:59:23,186 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 21:59:23,788 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 21:59:23,798 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 682 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - injections: 88 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 21:59:24,035 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 21:59:24,035 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 21:59:24,035 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 21:59:24,035 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 21:59:25,744 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 21:59:27,251 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 21:59:29,155 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 21:59:31,317 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 21:59:33,370 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 21:59:34,978 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 21:59:34,979 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 21:59:34,979 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 21:59:34,979 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 21:59:34,979 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 21:59:34,979 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:28:32,967 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:28:32,967 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:28:32,968 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:28:34,645 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 22:28:34,645 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:28:34,645 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 22:28:34,646 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 22:28:34,646 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 22:28:35,187 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 22:28:35,187 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 22:28:35,187 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:35,189 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 22:28:35,189 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 22:28:35,189 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 22:28:35,190 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_222835/output
2025-12-21 22:28:35,202 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 22:28:35,267 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 22:28:35,267 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_222835
2025-12-21 22:28:35,267 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 22:28:35,267 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_222835.zip...
2025-12-21 22:28:35,553 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_222835.zip
2025-12-21 22:28:35,557 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 22:28:35,557 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 22:28:35,557 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 22:28:35,559 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 22:28:35,573 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 22:28:35,573 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 22:28:35,573 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 22:28:35,573 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 22:28:35,573 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 22:28:35,573 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:35,675 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 22:28:35,675 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_222835.csv...
2025-12-21 22:28:36,074 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 22:28:36,074 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 22:28:36,074 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 22:28:36,074 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:36,074 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_222835.csv
2025-12-21 22:28:36,074 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_222835.csv...
2025-12-21 22:28:36,074 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:28:36,075 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_222835.csv...
2025-12-21 22:28:36,119 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 22:28:36,119 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 22:28:36,119 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 22:28:36,119 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:36,119 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_222835.csv
2025-12-21 22:28:36,119 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_222835.csv...
2025-12-21 22:28:36,119 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 22:28:36,128 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 22:28:36
File: problemm20251220_20251221_222835.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 22:28:36,128 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 22:28:36,128 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 22:28:36,128 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:36,129 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_222835.csv
2025-12-21 22:28:36,129 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_222835.csv...
2025-12-21 22:28:36,129 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_222836.csv
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 22:28:36,173 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 22:28:36,173 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 22:28:36,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_222836.csv
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_222836.csv by branches...
2025-12-21 22:28:36,173 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 22:28:36,174 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 22:28:36,187 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 22:28:36,193 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 22:28:36,198 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 22:28:36,203 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 22:28:36,208 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 22:28:36,214 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 22:28:36,214 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 22:28:39,328 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 22:28:40,705 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.38s (198 transfers)
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_222836_asherin.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_222836_wardani.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_222836_akba.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_222836_shahid.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_222836_nujum.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_222836_admin.csv
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.07 surplus=2.04 writes=0.36 total=5.51
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 22:28:41,681 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 22:28:41,681 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 22:28:41,681 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 22:28:41,681 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_222836_from_admin_to_akba.csv (9.2 KB)
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_222836_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_222836_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 22:28:42,060 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_222836_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_222836_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_222836_from_akba_to_admin.csv (84.0 B)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_222836_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_222836_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_222836_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_222836_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_222836_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_222836_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_222836_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_222836_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_222836_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_222836_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_222836_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_222836_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_222836_from_shahid_to_admin.csv (87.0 B)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_222836_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_222836_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_222836_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_222836_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_222836_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_222836_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_222836_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_222836_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 22:28:42,061 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 22:28:42,061 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:28:42,061 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:28:42,061 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:28:42,211 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 22:28:42,212 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 22:28:42,212 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:28:42,857 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 22:28:42,857 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 22:28:42,857 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 22:28:42,857 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:43,555 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 22:28:44,209 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 22:28:44,872 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 22:28:45,532 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 22:28:46,193 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 22:28:46,852 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 22:28:46,852 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 22:28:47,186 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 22:28:47,186 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 22:28:47,186 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 22:28:47,186 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 22:28:47,186 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 22:28:47,187 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 22:28:47,187 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 22:28:47,187 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:47,187 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 22:28:47,187 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 22:28:47,779 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 22:28:47,790 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 22:28:48,025 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 22:28:48,025 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 22:28:48,025 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:28:48,025 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 22:28:49,745 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 22:28:51,226 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 22:28:53,156 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 22:28:55,372 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 22:28:57,356 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 22:28:58,981 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 22:28:58,981 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 22:28:58,981 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 22:28:58,981 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 22:28:58,981 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 22:28:58,981 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 22:28:58,981 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 22:28:58,982 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:32:04,401 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:32:04,401 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:32:04,401 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:32:04,401 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:32:04,401 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:32:04,402 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:32:04,403 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:32:04,404 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:32:05,191 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:32:06,667 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:32:06,668 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:32:07,911 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 22:32:07,911 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:32:07,911 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 22:32:07,912 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 22:32:07,912 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 22:32:08,999 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 22:32:08,999 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 22:32:08,999 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,000 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 22:32:09,000 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 22:32:09,000 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 22:32:09,000 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_223209/output
2025-12-21 22:32:09,007 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 22:32:09,057 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 22:32:09,057 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_223209
2025-12-21 22:32:09,057 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 22:32:09,057 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_223209.zip...
2025-12-21 22:32:09,337 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_223209.zip
2025-12-21 22:32:09,341 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 22:32:09,341 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 22:32:09,341 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 22:32:09,343 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 22:32:09,353 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 22:32:09,353 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 22:32:09,353 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 22:32:09,353 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 22:32:09,353 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 22:32:09,353 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,457 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 22:32:09,457 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_223209.csv...
2025-12-21 22:32:09,889 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 22:32:09,890 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 22:32:09,890 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 22:32:09,890 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223209.csv
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_223209.csv...
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:32:09,890 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_223209.csv...
2025-12-21 22:32:09,933 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 22:32:09,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 22:32:09,933 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 22:32:09,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,933 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223209.csv
2025-12-21 22:32:09,933 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_223209.csv...
2025-12-21 22:32:09,933 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 22:32:09,942 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 22:32:09
File: problemm20251220_20251221_223209.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 22:32:09,942 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 22:32:09,943 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 22:32:09,943 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,943 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223209.csv
2025-12-21 22:32:09,943 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_223209.csv...
2025-12-21 22:32:09,943 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 22:32:09,986 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 22:32:09,986 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_223209.csv
2025-12-21 22:32:09,987 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 22:32:09,987 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 22:32:09,987 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 22:32:09,987 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:09,987 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_223209.csv
2025-12-21 22:32:09,987 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_223209.csv by branches...
2025-12-21 22:32:09,987 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 22:32:09,987 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 22:32:10,000 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 22:32:10,006 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 22:32:10,011 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 22:32:10,016 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 22:32:10,021 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 22:32:10,026 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 22:32:10,026 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 22:32:13,056 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 22:32:14,380 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.32s (198 transfers)
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_223209_asherin.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_223209_wardani.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_223209_akba.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_223209_shahid.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_223209_nujum.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_223209_admin.csv
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=1.97 writes=0.37 total=5.37
2025-12-21 22:32:15,358 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 22:32:15,358 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 22:32:15,358 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 22:32:15,358 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:15,359 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 22:32:15,359 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 22:32:15,359 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223209_from_admin_to_akba.csv (9.2 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223209_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223209_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223209_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223209_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_223209_from_akba_to_admin.csv (84.0 B)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223209_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223209_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223209_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223209_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223209_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223209_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223209_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223209_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223209_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223209_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223209_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223209_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_223209_from_shahid_to_admin.csv (87.0 B)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223209_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223209_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223209_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223209_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223209_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 22:32:15,747 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223209_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223209_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223209_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 22:32:15,748 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 22:32:15,748 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:32:15,748 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:32:15,748 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 22:32:15,904 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 22:32:15,905 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:32:16,541 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 22:32:16,541 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 22:32:16,541 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 22:32:16,541 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:17,222 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 22:32:17,897 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 22:32:18,569 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 22:32:19,221 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 22:32:19,882 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 22:32:20,544 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 22:32:20,544 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 22:32:20,863 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 22:32:20,863 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 22:32:20,863 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 22:32:20,863 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 22:32:21,439 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 22:32:21,450 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 22:32:21,693 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 22:32:21,693 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 22:32:21,693 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 22:32:21,694 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 22:32:21,694 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 22:32:21,694 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:32:21,694 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 22:32:23,406 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 22:32:24,859 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 22:32:26,785 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 22:32:28,959 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 22:32:31,022 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 22:32:32,686 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 22:32:32,686 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 22:32:32,686 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 22:32:32,686 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 22:32:32,686 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 22:32:32,686 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:39:17,761 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:39:19,040 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 22:39:19,040 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:39:19,040 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 22:39:19,040 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 22:39:19,040 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 22:39:19,613 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 22:39:19,613 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 22:39:19,613 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:19,614 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 22:39:19,614 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 22:39:19,614 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 22:39:19,614 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_223919/output
2025-12-21 22:39:19,621 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 22:39:19,658 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 22:39:19,659 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_223919
2025-12-21 22:39:19,659 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 22:39:19,659 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_223919.zip...
2025-12-21 22:39:19,940 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_223919.zip
2025-12-21 22:39:19,944 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 22:39:19,944 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 22:39:19,944 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 22:39:19,946 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 22:39:19,956 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 22:39:19,956 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 22:39:19,956 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 22:39:19,956 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 22:39:19,956 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 22:39:19,956 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:19,956 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 22:39:19,956 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_223919.csv...
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 22:39:20,373 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 22:39:20,373 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 22:39:20,373 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223919.csv
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_223919.csv...
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:39:20,373 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_223919.csv...
2025-12-21 22:39:20,414 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 22:39:20,415 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 22:39:20,415 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 22:39:20,415 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:20,415 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223919.csv
2025-12-21 22:39:20,415 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_223919.csv...
2025-12-21 22:39:20,415 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 22:39:20,423 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 22:39:20
File: problemm20251220_20251221_223919.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 22:39:20,423 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 22:39:20,423 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 22:39:20,423 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:20,423 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_223919.csv
2025-12-21 22:39:20,424 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_223919.csv...
2025-12-21 22:39:20,424 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_223920.csv
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 22:39:20,465 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 22:39:20,465 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 22:39:20,465 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_223920.csv
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_223920.csv by branches...
2025-12-21 22:39:20,465 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 22:39:20,465 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 22:39:20,478 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 22:39:20,483 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 22:39:20,488 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 22:39:20,493 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 22:39:20,498 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 22:39:20,503 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 22:39:20,503 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 22:39:23,605 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 22:39:24,951 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.35s (198 transfers)
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_223920_asherin.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_223920_wardani.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_223920_akba.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_223920_shahid.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_223920_nujum.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_223920_admin.csv
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.07 surplus=2.03 writes=0.35 total=5.47
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 22:39:25,932 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 22:39:25,932 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 22:39:25,932 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 22:39:25,932 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223920_from_admin_to_akba.csv (9.2 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223920_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223920_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223920_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223920_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_223920_from_akba_to_admin.csv (84.0 B)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223920_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223920_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223920_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223920_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223920_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223920_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223920_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223920_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223920_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223920_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223920_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223920_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 22:39:26,316 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_223920_from_shahid_to_admin.csv (87.0 B)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223920_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223920_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223920_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_223920_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_223920_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_223920_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_223920_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_223920_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 22:39:26,317 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 22:39:26,317 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:39:26,317 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:39:26,317 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 22:39:26,470 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:39:27,093 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 22:39:27,093 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 22:39:27,093 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 22:39:27,093 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:27,746 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 22:39:28,395 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 22:39:29,049 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 22:39:29,713 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 22:39:30,401 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 22:39:31,091 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 22:39:31,091 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 22:39:31,437 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 22:39:31,437 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 22:39:31,437 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 22:39:31,437 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 22:39:31,437 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 22:39:31,438 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 22:39:31,438 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 22:39:31,438 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:31,438 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 22:39:31,438 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 22:39:32,046 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 22:39:32,061 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 22:39:32,289 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 22:39:32,289 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 22:39:32,289 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 22:39:32,289 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:39:32,290 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 22:39:34,023 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 22:39:35,517 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 22:39:37,440 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 22:39:39,748 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 22:39:41,838 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 22:39:43,503 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 22:39:43,503 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 22:39:43,503 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 22:39:43,503 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 22:39:43,503 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 22:39:43,503 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:49:27,535 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:49:27,535 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:49:27,536 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:49:27,537 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:49:27,538 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:49:27,539 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:49:27,539 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:49:27,539 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:49:27,855 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 22:49:29,895 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:49:29,895 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:49:29,896 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:49:32,399 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 22:49:32,400 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:49:32,400 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 22:49:32,400 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 22:49:32,400 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 22:49:33,303 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 22:49:33,303 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 22:49:33,304 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:33,305 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 22:49:33,305 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 22:49:33,306 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 22:49:33,306 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_224933/output
2025-12-21 22:49:33,316 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 22:49:33,363 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 22:49:33,364 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_224933
2025-12-21 22:49:33,364 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 22:49:33,364 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_224933.zip...
2025-12-21 22:49:33,645 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_224933.zip
2025-12-21 22:49:33,649 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 22:49:33,649 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 22:49:33,649 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 22:49:33,651 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 22:49:33,661 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 22:49:33,662 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 22:49:33,662 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 22:49:33,662 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 22:49:33,662 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 22:49:33,662 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:33,761 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 22:49:33,762 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_224933.csv...
2025-12-21 22:49:34,179 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 22:49:34,179 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 22:49:34,179 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 22:49:34,179 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:34,179 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_224933.csv
2025-12-21 22:49:34,179 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_224933.csv...
2025-12-21 22:49:34,179 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:49:34,180 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_224933.csv...
2025-12-21 22:49:34,236 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 22:49:34,236 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 22:49:34,236 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 22:49:34,236 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:34,236 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_224933.csv
2025-12-21 22:49:34,236 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_224933.csv...
2025-12-21 22:49:34,236 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 22:49:34,245 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 22:49:34
File: problemm20251220_20251221_224933.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 22:49:34,245 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 22:49:34,245 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 22:49:34,245 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:34,245 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_224933.csv
2025-12-21 22:49:34,245 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_224933.csv...
2025-12-21 22:49:34,245 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 22:49:34,289 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 22:49:34,289 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_224934.csv
2025-12-21 22:49:34,289 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 22:49:34,289 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 22:49:34,289 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 22:49:34,289 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:34,289 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_224934.csv
2025-12-21 22:49:34,290 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_224934.csv by branches...
2025-12-21 22:49:34,290 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 22:49:34,290 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 22:49:34,303 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 22:49:34,309 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 22:49:34,314 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 22:49:34,319 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 22:49:34,324 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 22:49:34,330 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 22:49:34,330 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 22:49:37,457 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 22:49:38,810 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.35s (198 transfers)
2025-12-21 22:49:39,791 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_224934_asherin.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_224934_wardani.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_224934_akba.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_224934_shahid.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_224934_nujum.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_224934_admin.csv
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=2.04 writes=0.36 total=5.50
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 22:49:39,792 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 22:49:39,792 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 22:49:39,792 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 22:49:39,792 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_224934_from_admin_to_akba.csv (9.2 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_224934_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_224934_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_224934_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_224934_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_224934_from_akba_to_admin.csv (84.0 B)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_224934_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_224934_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_224934_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_224934_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_224934_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_224934_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_224934_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 22:49:40,191 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_224934_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_224934_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_224934_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_224934_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_224934_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_224934_from_shahid_to_admin.csv (87.0 B)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_224934_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_224934_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_224934_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_224934_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_224934_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_224934_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_224934_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_224934_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 22:49:40,192 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 22:49:40,192 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:49:40,192 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 22:49:40,192 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:49:40,193 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:49:40,347 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 22:49:40,348 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:49:40,348 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 22:49:40,348 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 22:49:40,348 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 22:49:41,005 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 22:49:41,005 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:49:41,005 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:49:41,006 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:49:41,006 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:49:41,006 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:49:41,006 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:49:41,006 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 22:49:41,006 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 22:49:41,006 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 22:49:41,006 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:41,669 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 22:49:42,330 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 22:49:42,992 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 22:49:43,664 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 22:49:44,329 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 22:49:45,008 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 22:49:45,008 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 22:49:45,332 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 22:49:45,332 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 22:49:45,332 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 22:49:45,332 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 22:49:45,937 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 22:49:45,946 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 22:49:46,191 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 22:49:46,191 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 22:49:46,191 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:49:46,191 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 22:49:47,910 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 22:49:49,355 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 22:49:51,294 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 22:49:53,486 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 22:49:55,507 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 22:49:57,124 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 22:49:57,124 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 22:49:57,124 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 22:49:57,124 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 22:49:57,124 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 22:49:57,124 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:56:30,926 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:56:30,927 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:56:30,928 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:56:30,929 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:56:30,930 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:56:31,590 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 22:56:33,897 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 22:56:33,898 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 22:56:34,670 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 22:56:34,670 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:56:34,671 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 22:56:34,671 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 22:56:34,671 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 22:56:35,397 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 22:56:35,398 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 22:56:35,398 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:35,399 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 22:56:35,400 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 22:56:35,400 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 22:56:35,400 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_225635/output
2025-12-21 22:56:35,411 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 22:56:35,462 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 22:56:35,462 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_225635
2025-12-21 22:56:35,462 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 22:56:35,462 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_225635.zip...
2025-12-21 22:56:35,765 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_225635.zip
2025-12-21 22:56:35,769 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 22:56:35,769 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 22:56:35,769 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 22:56:35,771 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 22:56:35,781 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 22:56:35,781 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 22:56:35,781 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 22:56:35,781 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 22:56:35,781 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 22:56:35,781 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:35,880 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 22:56:35,880 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_225635.csv...
2025-12-21 22:56:36,311 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 22:56:36,311 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 22:56:36,312 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 22:56:36,312 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_225635.csv
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_225635.csv...
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 22:56:36,312 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_225635.csv...
2025-12-21 22:56:36,356 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 22:56:36,356 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 22:56:36,356 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 22:56:36,356 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:36,356 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_225635.csv
2025-12-21 22:56:36,356 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_225635.csv...
2025-12-21 22:56:36,356 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 22:56:36,365 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 22:56:36
File: problemm20251220_20251221_225635.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 22:56:36,365 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 22:56:36,365 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 22:56:36,365 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:36,365 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_225635.csv
2025-12-21 22:56:36,365 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_225635.csv...
2025-12-21 22:56:36,365 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 22:56:36,412 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 22:56:36,412 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_225636.csv
2025-12-21 22:56:36,412 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 22:56:36,412 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 22:56:36,412 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 22:56:36,412 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:36,413 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_225636.csv
2025-12-21 22:56:36,413 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_225636.csv by branches...
2025-12-21 22:56:36,413 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 22:56:36,413 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 22:56:36,426 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 22:56:36,432 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 22:56:36,437 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 22:56:36,443 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 22:56:36,448 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 22:56:36,453 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 22:56:36,453 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 22:56:39,543 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 22:56:40,911 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.37s (198 transfers)
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_225636_asherin.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_225636_wardani.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_225636_akba.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_225636_shahid.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_225636_nujum.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_225636_admin.csv
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 22:56:41,892 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 22:56:41,893 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=2.00 writes=0.36 total=5.48
2025-12-21 22:56:41,893 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 22:56:41,893 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 22:56:41,893 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 22:56:41,893 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:41,893 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 22:56:41,893 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 22:56:41,893 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_225636_from_admin_to_akba.csv (9.2 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_225636_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_225636_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_225636_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_225636_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_225636_from_akba_to_admin.csv (84.0 B)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_225636_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_225636_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_225636_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_225636_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_225636_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_225636_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_225636_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_225636_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_225636_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_225636_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_225636_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_225636_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_225636_from_shahid_to_admin.csv (87.0 B)
2025-12-21 22:56:42,284 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_225636_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_225636_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_225636_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_225636_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_225636_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_225636_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_225636_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_225636_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 22:56:42,285 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 22:56:42,285 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 22:56:42,285 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:56:42,285 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 22:56:42,439 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 22:56:43,098 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 22:56:43,099 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 22:56:43,099 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 22:56:43,099 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:43,774 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 22:56:44,461 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 22:56:45,108 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 22:56:45,750 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 22:56:46,417 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 22:56:47,060 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 22:56:47,061 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 22:56:47,380 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 22:56:47,380 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 22:56:47,380 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 22:56:47,380 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 22:56:47,966 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 22:56:47,975 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 22:56:48,213 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 22:56:48,213 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 22:56:48,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 22:56:48,213 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 22:56:49,962 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 22:56:51,443 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 22:56:53,332 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 22:56:55,507 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 22:56:57,519 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 22:56:59,113 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 22:56:59,114 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 22:56:59,114 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 22:56:59,114 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 22:56:59,114 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 22:56:59,114 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 23:15:46,897 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:15:47,351 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 23:15:49,273 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 23:15:49,274 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:15:50,534 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 23:15:50,534 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:15:50,535 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 23:15:50,535 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 23:15:50,535 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 23:15:51,133 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 23:15:51,133 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 23:15:51,134 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:51,135 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 23:15:51,136 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 23:15:51,136 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 23:15:51,136 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_231551/output
2025-12-21 23:15:51,149 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 23:15:51,192 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 23:15:51,192 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_231551
2025-12-21 23:15:51,192 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 23:15:51,192 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_231551.zip...
2025-12-21 23:15:51,482 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_231551.zip
2025-12-21 23:15:51,486 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 23:15:51,486 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 23:15:51,486 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 23:15:51,488 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 23:15:51,498 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 23:15:51,499 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 23:15:51,499 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 23:15:51,499 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 23:15:51,499 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 23:15:51,499 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:51,597 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 23:15:51,597 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_231551.csv...
2025-12-21 23:15:52,020 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 23:15:52,020 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 23:15:52,020 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 23:15:52,020 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_231551.csv
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_231551.csv...
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 23:15:52,021 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_231551.csv...
2025-12-21 23:15:52,065 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 23:15:52,065 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 23:15:52,065 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 23:15:52,065 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:52,065 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_231551.csv
2025-12-21 23:15:52,065 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_231551.csv...
2025-12-21 23:15:52,065 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 23:15:52,075 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 23:15:52
File: problemm20251220_20251221_231551.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 23:15:52,075 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 23:15:52,075 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 23:15:52,075 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:52,075 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_231551.csv
2025-12-21 23:15:52,075 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_231551.csv...
2025-12-21 23:15:52,075 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_231552.csv
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 23:15:52,119 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 23:15:52,119 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 23:15:52,119 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_231552.csv
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_231552.csv by branches...
2025-12-21 23:15:52,119 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 23:15:52,119 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 23:15:52,132 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 23:15:52,138 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 23:15:52,144 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 23:15:52,149 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 23:15:52,154 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 23:15:52,159 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 23:15:52,159 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 23:15:55,236 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 23:15:56,521 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.29s (198 transfers)
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_231552_asherin.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_231552_wardani.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_231552_akba.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_231552_shahid.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_231552_nujum.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_231552_admin.csv
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=2.02 writes=0.35 total=5.36
2025-12-21 23:15:57,476 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 23:15:57,476 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 23:15:57,476 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 23:15:57,476 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:57,477 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 23:15:57,477 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 23:15:57,477 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 23:15:57,856 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 23:15:57,856 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 23:15:57,856 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_231552_from_admin_to_akba.csv (9.2 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_231552_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_231552_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_231552_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_231552_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_231552_from_akba_to_admin.csv (84.0 B)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_231552_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_231552_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_231552_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_231552_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_231552_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_231552_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_231552_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_231552_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_231552_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_231552_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_231552_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_231552_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_231552_from_shahid_to_admin.csv (87.0 B)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_231552_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_231552_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_231552_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_231552_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_231552_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_231552_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_231552_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_231552_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 23:15:57,857 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 23:15:57,857 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:15:57,857 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 23:15:57,857 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 23:15:58,010 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 23:15:58,011 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 23:15:58,011 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 23:15:58,675 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 23:15:58,675 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 23:15:58,675 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 23:15:58,675 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:15:59,334 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 23:15:59,974 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 23:16:00,618 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 23:16:01,260 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 23:16:01,900 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 23:16:02,536 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 23:16:02,536 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 23:16:02,855 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 23:16:02,855 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 23:16:02,855 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 23:16:02,855 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 23:16:02,855 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 23:16:02,856 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 23:16:02,856 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 23:16:02,856 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:16:02,856 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 23:16:02,856 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 23:16:03,437 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 23:16:03,446 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 23:16:03,682 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 23:16:03,682 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 23:16:03,682 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:16:03,682 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 23:16:05,364 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 23:16:06,785 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 23:16:08,640 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 23:16:10,765 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 23:16:12,751 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 23:16:14,328 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 23:16:14,328 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 23:16:14,328 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 23:16:14,328 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 23:16:14,328 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 23:16:14,328 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:37:17,043 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 23:37:17,044 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 23:37:17,045 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:37:17,486 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-21 23:37:19,172 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-21 23:37:19,791 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-21 23:37:19,791 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:37:19,791 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-21 23:37:19,791 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-21 23:37:19,792 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-21 23:37:20,246 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-21 23:37:20,247 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-21 23:37:20,247 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:20,248 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-21 23:37:20,248 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-21 23:37:20,248 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-21 23:37:20,249 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251221_233720/output
2025-12-21 23:37:20,259 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-21 23:37:20,300 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-21 23:37:20,300 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251221_233720
2025-12-21 23:37:20,300 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-21 23:37:20,300 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251221_233720.zip...
2025-12-21 23:37:20,583 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251221_233720.zip
2025-12-21 23:37:20,587 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-21 23:37:20,587 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-21 23:37:20,587 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-21 23:37:20,588 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-21 23:37:20,602 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-21 23:37:20,602 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-21 23:37:20,602 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-21 23:37:20,602 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-21 23:37:20,602 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-21 23:37:20,602 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:20,705 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-21 23:37:20,705 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251221_233720.csv...
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-21 23:37:21,140 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-21 23:37:21,140 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-21 23:37:21,140 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_233720.csv
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251221_233720.csv...
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-21 23:37:21,140 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-21 23:37:21,141 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251221_233720.csv...
2025-12-21 23:37:21,184 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-21 23:37:21,184 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-21 23:37:21,184 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-21 23:37:21,184 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:21,184 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_233720.csv
2025-12-21 23:37:21,184 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251221_233720.csv...
2025-12-21 23:37:21,184 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-21 23:37:21,194 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-21 23:37:21
File: problemm20251220_20251221_233720.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-21 23:37:21,194 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-21 23:37:21,194 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-21 23:37:21,194 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:21,194 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251221_233720.csv
2025-12-21 23:37:21,194 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251221_233720.csv...
2025-12-21 23:37:21,194 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251221_233721.csv
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-21 23:37:21,241 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-21 23:37:21,241 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-21 23:37:21,241 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251221_233721.csv
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251221_233721.csv by branches...
2025-12-21 23:37:21,241 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-21 23:37:21,242 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-21 23:37:21,254 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-21 23:37:21,260 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-21 23:37:21,266 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-21 23:37:21,271 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-21 23:37:21,276 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-21 23:37:21,281 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-21 23:37:21,281 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-21 23:37:24,385 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-21 23:37:25,717 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.33s (198 transfers)
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251221_233721_asherin.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251221_233721_wardani.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251221_233721_akba.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251221_233721_shahid.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251221_233721_nujum.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251221_233721_admin.csv
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=2.04 writes=0.38 total=5.48
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-21 23:37:26,718 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-21 23:37:26,718 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-21 23:37:26,718 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-21 23:37:26,718 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_233721_from_admin_to_akba.csv (9.2 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_233721_from_admin_to_asherin.csv (8.5 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_233721_from_admin_to_nujum.csv (14.4 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_233721_from_admin_to_shahid.csv (11.0 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_233721_from_admin_to_wardani.csv (7.5 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_233721_from_akba_to_admin.csv (84.0 B)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_233721_from_akba_to_asherin.csv (2.7 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_233721_from_akba_to_nujum.csv (6.5 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_233721_from_akba_to_shahid.csv (3.6 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_233721_from_akba_to_wardani.csv (2.6 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_233721_from_asherin_to_akba.csv (3.7 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_233721_from_asherin_to_nujum.csv (4.8 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_233721_from_asherin_to_shahid.csv (3.8 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_233721_from_asherin_to_wardani.csv (2.2 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_233721_from_nujum_to_akba.csv (6.2 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_233721_from_nujum_to_asherin.csv (4.6 KB)
2025-12-21 23:37:27,112 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_233721_from_nujum_to_shahid.csv (5.4 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_233721_from_nujum_to_wardani.csv (3.6 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251221_233721_from_shahid_to_admin.csv (87.0 B)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_233721_from_shahid_to_akba.csv (5.2 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_233721_from_shahid_to_asherin.csv (4.4 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_233721_from_shahid_to_nujum.csv (6.9 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251221_233721_from_shahid_to_wardani.csv (3.5 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251221_233721_from_wardani_to_akba.csv (2.8 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251221_233721_from_wardani_to_asherin.csv (2.1 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251221_233721_from_wardani_to_nujum.csv (3.0 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251221_233721_from_wardani_to_shahid.csv (2.9 KB)
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-21 23:37:27,113 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-21 23:37:27,113 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-21 23:37:27,113 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 23:37:27,113 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-21 23:37:27,264 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-21 23:37:27,265 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-21 23:37:27,958 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-21 23:37:27,958 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-21 23:37:27,958 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-21 23:37:27,959 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:28,645 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-21 23:37:29,306 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-21 23:37:29,953 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-21 23:37:30,622 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-21 23:37:31,264 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-21 23:37:31,912 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-21 23:37:31,912 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-21 23:37:32,231 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-21 23:37:32,231 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-21 23:37:32,231 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-21 23:37:32,231 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-21 23:37:32,813 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-21 23:37:32,821 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-21 23:37:33,073 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-21 23:37:33,073 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-21 23:37:33,073 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-21 23:37:33,073 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-21 23:37:34,783 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-21 23:37:36,222 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-21 23:37:38,121 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-21 23:37:40,300 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-21 23:37:42,343 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-21 23:37:43,944 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-21 23:37:43,944 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-21 23:37:43,944 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-21 23:37:43,944 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-21 23:37:43,944 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-21 23:37:43,944 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 05:32:17,665 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 05:32:17,666 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 05:32:17,666 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 05:32:17,666 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 05:32:17,666 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 05:32:17,666 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 05:32:17,667 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 05:32:17,667 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 05:32:17,667 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 05:32:17,667 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 05:32:17,667 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 05:32:17,668 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 05:32:17,669 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 05:32:17,670 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 05:32:17,670 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 05:32:17,670 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 05:32:17,670 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 05:32:17,670 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 05:32:18,107 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 05:32:19,724 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 05:32:19,725 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 05:32:21,041 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 05:32:21,042 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 05:32:21,042 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 05:32:21,042 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 05:32:21,042 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 05:32:21,618 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 05:32:21,618 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 05:32:21,618 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:21,620 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 05:32:21,620 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 05:32:21,620 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 05:32:21,621 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_053221/output
2025-12-22 05:32:21,632 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 05:32:21,681 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 05:32:21,681 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_053221
2025-12-22 05:32:21,681 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 05:32:21,681 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_053221.zip...
2025-12-22 05:32:21,994 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_053221.zip
2025-12-22 05:32:21,998 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 05:32:21,998 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 05:32:21,998 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 05:32:21,999 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 05:32:22,013 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 05:32:22,013 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 05:32:22,013 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 05:32:22,013 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 05:32:22,013 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 05:32:22,013 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:22,114 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 05:32:22,115 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_053222.csv...
2025-12-22 05:32:22,560 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 05:32:22,560 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 05:32:22,560 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 05:32:22,560 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:22,560 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_053222.csv
2025-12-22 05:32:22,560 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_053222.csv...
2025-12-22 05:32:22,560 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 05:32:22,560 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 05:32:22,561 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_053222.csv...
2025-12-22 05:32:22,605 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 05:32:22,605 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 05:32:22,605 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 05:32:22,605 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:22,605 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_053222.csv
2025-12-22 05:32:22,605 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_053222.csv...
2025-12-22 05:32:22,605 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 05:32:22,614 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 05:32:22
File: problemm20251220_20251222_053222.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 05:32:22,614 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 05:32:22,614 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 05:32:22,614 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:22,615 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_053222.csv
2025-12-22 05:32:22,615 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_053222.csv...
2025-12-22 05:32:22,615 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 05:32:22,659 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 05:32:22,659 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_053222.csv
2025-12-22 05:32:22,659 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 05:32:22,659 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 05:32:22,659 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 05:32:22,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:22,659 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_053222.csv
2025-12-22 05:32:22,660 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_053222.csv by branches...
2025-12-22 05:32:22,660 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 05:32:22,660 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 05:32:22,673 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 05:32:22,679 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 05:32:22,684 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 05:32:22,689 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 05:32:22,694 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 05:32:22,699 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 05:32:22,699 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 05:32:25,830 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 05:32:27,165 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.33s (198 transfers)
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_053222_asherin.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_053222_wardani.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_053222_akba.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_053222_shahid.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_053222_nujum.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_053222_admin.csv
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=2.05 writes=0.36 total=5.48
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 05:32:28,138 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 05:32:28,138 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 05:32:28,138 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 05:32:28,138 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 05:32:28,528 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 05:32:28,528 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_053222_from_admin_to_akba.csv (9.2 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_053222_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_053222_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_053222_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_053222_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_053222_from_akba_to_admin.csv (84.0 B)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_053222_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_053222_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_053222_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_053222_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_053222_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_053222_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_053222_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_053222_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_053222_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_053222_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_053222_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_053222_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_053222_from_shahid_to_admin.csv (87.0 B)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_053222_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_053222_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_053222_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_053222_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_053222_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_053222_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_053222_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_053222_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 05:32:28,529 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 05:32:28,529 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 05:32:28,529 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 05:32:28,529 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:28,530 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 05:32:28,530 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 05:32:28,530 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 05:32:28,701 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 05:32:29,356 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 05:32:29,356 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 05:32:29,356 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 05:32:29,356 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:30,020 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 05:32:30,681 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 05:32:31,343 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 05:32:31,998 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 05:32:32,658 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 05:32:33,324 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 05:32:33,325 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 05:32:33,649 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 05:32:33,649 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 05:32:33,649 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 05:32:33,649 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 05:32:34,229 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 05:32:34,238 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 05:32:34,481 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 05:32:34,481 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 05:32:34,481 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 05:32:34,481 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 05:32:36,240 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 05:32:37,733 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 05:32:39,683 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 05:32:41,952 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 05:32:43,979 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 05:32:45,599 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 05:32:45,600 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 05:32:45,600 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 05:32:45,600 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 05:32:45,600 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 05:32:45,600 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:18:22,187 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:18:22,187 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:18:22,187 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:18:22,187 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:18:22,187 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:18:22,188 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:18:22,189 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:18:22,190 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:18:22,190 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:18:22,190 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:18:22,190 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:18:22,190 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:18:24,546 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:18:27,341 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:18:27,342 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:18:28,994 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 06:18:28,994 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:18:28,994 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 06:18:28,995 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 06:18:28,995 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 06:18:29,807 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 06:18:29,808 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 06:18:29,808 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:29,809 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 06:18:29,809 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 06:18:29,810 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 06:18:29,810 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_061829/output
2025-12-22 06:18:29,817 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 06:18:29,859 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 06:18:29,859 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_061829
2025-12-22 06:18:29,859 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 06:18:29,859 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_061829.zip...
2025-12-22 06:18:30,148 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_061829.zip
2025-12-22 06:18:30,152 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 06:18:30,152 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 06:18:30,152 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 06:18:30,154 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 06:18:30,164 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 06:18:30,164 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 06:18:30,164 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 06:18:30,164 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 06:18:30,164 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 06:18:30,164 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:30,267 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 06:18:30,267 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_061830.csv...
2025-12-22 06:18:30,681 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 06:18:30,681 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 06:18:30,681 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 06:18:30,681 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:30,681 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_061830.csv
2025-12-22 06:18:30,681 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_061830.csv...
2025-12-22 06:18:30,681 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:18:30,682 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_061830.csv...
2025-12-22 06:18:30,725 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 06:18:30,725 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 06:18:30,725 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 06:18:30,725 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:30,725 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_061830.csv
2025-12-22 06:18:30,725 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_061830.csv...
2025-12-22 06:18:30,725 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 06:18:30,735 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 06:18:30
File: problemm20251220_20251222_061830.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 06:18:30,735 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 06:18:30,735 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 06:18:30,735 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:30,735 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_061830.csv
2025-12-22 06:18:30,735 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_061830.csv...
2025-12-22 06:18:30,735 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_061830.csv
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 06:18:30,779 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 06:18:30,779 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 06:18:30,779 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_061830.csv
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_061830.csv by branches...
2025-12-22 06:18:30,779 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 06:18:30,779 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 06:18:30,792 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 06:18:30,798 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 06:18:30,803 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 06:18:30,808 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 06:18:30,813 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 06:18:30,818 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 06:18:30,819 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 06:18:33,957 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 06:18:35,291 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.33s (198 transfers)
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_061830_asherin.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_061830_wardani.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_061830_akba.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_061830_shahid.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_061830_nujum.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_061830_admin.csv
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=2.05 writes=0.36 total=5.49
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 06:18:36,271 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 06:18:36,271 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 06:18:36,271 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 06:18:36,271 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_061830_from_admin_to_akba.csv (9.2 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_061830_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_061830_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_061830_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_061830_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_061830_from_akba_to_admin.csv (84.0 B)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_061830_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_061830_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_061830_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_061830_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_061830_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_061830_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_061830_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_061830_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_061830_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_061830_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_061830_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_061830_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_061830_from_shahid_to_admin.csv (87.0 B)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_061830_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_061830_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_061830_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_061830_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 06:18:36,665 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_061830_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_061830_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_061830_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_061830_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 06:18:36,666 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 06:18:36,666 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:18:36,666 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:18:36,666 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 06:18:36,819 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 06:18:36,820 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 06:18:37,477 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 06:18:37,477 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:18:37,477 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:18:37,478 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:18:37,478 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:18:37,478 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:18:37,478 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:18:37,478 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 06:18:37,478 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 06:18:37,478 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 06:18:37,478 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:38,144 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 06:18:38,813 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 06:18:39,488 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 06:18:40,153 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 06:18:40,809 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 06:18:41,472 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 06:18:41,473 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 06:18:41,795 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 06:18:41,795 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 06:18:41,795 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 06:18:41,795 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 06:18:42,383 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 06:18:42,392 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 06:18:42,634 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 06:18:42,634 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 06:18:42,634 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:18:42,634 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 06:18:44,393 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 06:18:45,863 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 06:18:47,819 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 06:18:50,049 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 06:18:52,116 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 06:18:53,771 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 06:18:53,771 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 06:18:53,771 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 06:18:53,771 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 06:18:53,771 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 06:18:53,771 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:37:58,389 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:37:58,389 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:37:58,390 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:37:58,390 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:37:58,390 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:37:58,390 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:37:58,390 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:37:58,391 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:37:58,391 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:37:58,391 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:37:58,391 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:37:58,391 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:37:58,392 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:37:58,393 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:37:58,394 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:37:58,394 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:37:58,394 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:37:58,394 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:37:58,394 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:38:00,188 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 06:38:00,188 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:38:00,188 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 06:38:00,189 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 06:38:00,189 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 06:38:00,780 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 06:38:00,780 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 06:38:00,781 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:00,782 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 06:38:00,782 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 06:38:00,782 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 06:38:00,783 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_063800/output
2025-12-22 06:38:00,786 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 06:38:00,824 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 06:38:00,825 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_063800
2025-12-22 06:38:00,825 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 06:38:00,825 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_063800.zip...
2025-12-22 06:38:01,129 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_063800.zip
2025-12-22 06:38:01,133 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 06:38:01,133 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 06:38:01,133 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 06:38:01,135 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 06:38:01,149 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 06:38:01,149 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 06:38:01,149 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 06:38:01,149 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 06:38:01,149 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 06:38:01,149 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:01,150 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 06:38:01,150 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_063801.csv...
2025-12-22 06:38:01,577 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 06:38:01,577 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 06:38:01,577 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 06:38:01,577 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:01,577 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_063801.csv
2025-12-22 06:38:01,577 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_063801.csv...
2025-12-22 06:38:01,577 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 06:38:01,577 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:38:01,578 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_063801.csv...
2025-12-22 06:38:01,619 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 06:38:01,619 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 06:38:01,619 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 06:38:01,619 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:01,619 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_063801.csv
2025-12-22 06:38:01,619 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_063801.csv...
2025-12-22 06:38:01,619 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 06:38:01,627 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 06:38:01
File: problemm20251220_20251222_063801.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 06:38:01,628 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 06:38:01,628 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 06:38:01,628 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:01,628 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_063801.csv
2025-12-22 06:38:01,628 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_063801.csv...
2025-12-22 06:38:01,628 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 06:38:01,669 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 06:38:01,669 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_063801.csv
2025-12-22 06:38:01,669 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 06:38:01,669 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 06:38:01,669 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 06:38:01,669 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:01,669 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_063801.csv
2025-12-22 06:38:01,670 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_063801.csv by branches...
2025-12-22 06:38:01,670 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 06:38:01,670 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 06:38:01,683 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 06:38:01,688 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 06:38:01,693 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 06:38:01,698 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 06:38:01,703 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 06:38:01,708 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 06:38:01,708 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 06:38:04,825 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 06:38:06,202 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.38s (198 transfers)
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_063801_asherin.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_063801_wardani.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_063801_akba.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_063801_shahid.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_063801_nujum.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_063801_admin.csv
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.07 surplus=2.05 writes=0.38 total=5.58
2025-12-22 06:38:07,253 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 06:38:07,253 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 06:38:07,253 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 06:38:07,253 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:07,254 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 06:38:07,254 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 06:38:07,254 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_063801_from_admin_to_akba.csv (9.2 KB)
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_063801_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_063801_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_063801_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_063801_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 06:38:07,639 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_063801_from_akba_to_admin.csv (84.0 B)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_063801_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_063801_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_063801_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_063801_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_063801_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_063801_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_063801_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_063801_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_063801_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_063801_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_063801_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_063801_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_063801_from_shahid_to_admin.csv (87.0 B)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_063801_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_063801_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_063801_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_063801_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_063801_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_063801_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_063801_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_063801_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 06:38:07,640 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 06:38:07,640 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:38:07,640 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:38:07,640 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:38:07,793 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 06:38:07,794 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 06:38:07,794 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:38:08,464 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 06:38:08,464 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 06:38:08,464 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 06:38:08,464 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:09,117 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 06:38:09,771 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 06:38:10,418 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 06:38:11,069 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 06:38:11,727 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 06:38:12,381 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 06:38:12,381 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 06:38:12,725 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 06:38:12,725 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 06:38:12,725 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 06:38:12,725 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 06:38:13,324 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 06:38:13,333 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 06:38:13,569 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 06:38:13,569 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 06:38:13,569 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:38:13,569 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 06:38:15,259 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 06:38:16,696 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 06:38:18,584 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 06:38:20,752 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 06:38:22,801 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 06:38:24,409 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 06:38:24,409 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 06:38:24,409 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 06:38:24,409 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 06:38:24,409 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 06:38:24,409 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:54:27,975 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:54:29,479 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:54:30,748 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:54:30,749 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:54:31,590 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 06:54:31,591 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:54:31,591 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 06:54:31,591 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 06:54:31,591 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 06:54:32,271 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 06:54:32,271 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 06:54:32,271 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:32,271 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 06:54:32,271 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 06:54:32,271 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 06:54:32,271 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_065432/output
2025-12-22 06:54:32,273 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 06:54:32,307 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 06:54:32,307 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_065432
2025-12-22 06:54:32,307 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 06:54:32,307 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_065432.zip...
2025-12-22 06:54:32,590 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_065432.zip
2025-12-22 06:54:32,594 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 06:54:32,594 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 06:54:32,594 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 06:54:32,596 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 06:54:32,607 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 06:54:32,607 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 06:54:32,607 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 06:54:32,607 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 06:54:32,607 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 06:54:32,607 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:32,708 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 06:54:32,708 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_065432.csv...
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 06:54:33,128 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 06:54:33,128 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 06:54:33,128 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065432.csv
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_065432.csv...
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 06:54:33,128 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 06:54:33,129 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:54:33,129 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 06:54:33,129 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:54:33,129 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_065432.csv...
2025-12-22 06:54:33,173 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 06:54:33,173 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 06:54:33,173 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 06:54:33,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:33,173 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065432.csv
2025-12-22 06:54:33,173 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_065432.csv...
2025-12-22 06:54:33,173 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 06:54:33,183 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 06:54:33
File: problemm20251220_20251222_065432.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 06:54:33,183 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 06:54:33,183 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 06:54:33,183 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:33,183 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065432.csv
2025-12-22 06:54:33,183 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_065432.csv...
2025-12-22 06:54:33,183 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 06:54:33,229 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 06:54:33,229 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_065433.csv
2025-12-22 06:54:33,229 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 06:54:33,229 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 06:54:33,229 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 06:54:33,229 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:33,229 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_065433.csv
2025-12-22 06:54:33,230 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_065433.csv by branches...
2025-12-22 06:54:33,230 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 06:54:33,230 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 06:54:33,243 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 06:54:33,250 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 06:54:33,255 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 06:54:33,260 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 06:54:33,266 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 06:54:33,271 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 06:54:33,271 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 06:54:36,495 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 06:54:37,820 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.32s (198 transfers)
2025-12-22 06:54:38,802 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_065433_asherin.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_065433_wardani.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_065433_akba.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_065433_shahid.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_065433_nujum.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_065433_admin.csv
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.12 surplus=2.10 writes=0.36 total=5.57
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 06:54:38,803 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 06:54:38,803 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 06:54:38,803 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 06:54:38,803 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065433_from_admin_to_akba.csv (9.2 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065433_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065433_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065433_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065433_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_065433_from_akba_to_admin.csv (84.0 B)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065433_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065433_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065433_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065433_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065433_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065433_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065433_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065433_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065433_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065433_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065433_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065433_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_065433_from_shahid_to_admin.csv (87.0 B)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065433_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065433_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065433_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065433_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065433_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065433_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065433_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 06:54:39,204 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065433_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 06:54:39,205 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 06:54:39,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 06:54:39,205 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:54:39,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:39,205 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 06:54:39,205 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:54:39,205 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:54:39,364 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 06:54:39,365 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 06:54:39,365 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:54:40,024 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 06:54:40,025 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 06:54:40,025 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 06:54:40,025 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:40,754 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 06:54:41,458 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 06:54:42,162 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 06:54:43,015 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 06:54:43,728 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 06:54:44,445 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 06:54:44,446 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 06:54:44,766 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 06:54:44,766 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 06:54:44,766 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 06:54:44,766 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 06:54:44,766 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 06:54:44,766 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 06:54:44,766 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 06:54:44,767 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:44,767 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 06:54:44,767 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 06:54:45,370 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 06:54:45,378 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 06:54:45,615 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 06:54:45,615 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 06:54:45,615 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 06:54:45,615 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:54:45,616 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 06:54:47,352 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 06:54:48,833 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 06:54:50,781 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 06:54:52,946 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 06:54:54,977 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 06:54:56,609 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 06:54:56,609 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 06:54:56,609 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 06:54:56,609 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 06:54:56,609 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 06:54:56,609 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:58:22,880 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:58:22,881 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:58:22,882 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:58:22,883 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:58:22,884 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:58:22,884 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:58:22,884 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:58:22,884 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:58:26,655 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 06:58:27,945 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 06:58:27,946 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 06:58:29,983 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 06:58:29,983 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:58:29,983 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 06:58:29,983 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 06:58:29,984 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 06:58:30,712 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 06:58:30,712 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 06:58:30,712 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:30,713 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 06:58:30,714 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 06:58:30,714 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 06:58:30,714 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_065830/output
2025-12-22 06:58:30,719 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 06:58:30,759 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 06:58:30,759 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_065830
2025-12-22 06:58:30,759 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 06:58:30,759 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_065830.zip...
2025-12-22 06:58:31,063 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_065830.zip
2025-12-22 06:58:31,067 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 06:58:31,067 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 06:58:31,067 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 06:58:31,069 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 06:58:31,083 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 06:58:31,083 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 06:58:31,083 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 06:58:31,083 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 06:58:31,083 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 06:58:31,083 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:31,190 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 06:58:31,190 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_065831.csv...
2025-12-22 06:58:31,603 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 06:58:31,604 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 06:58:31,604 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 06:58:31,604 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065831.csv
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_065831.csv...
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 06:58:31,604 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:58:31,605 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 06:58:31,605 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 06:58:31,605 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_065831.csv...
2025-12-22 06:58:31,648 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 06:58:31,648 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 06:58:31,648 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 06:58:31,648 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:31,648 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065831.csv
2025-12-22 06:58:31,648 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_065831.csv...
2025-12-22 06:58:31,648 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 06:58:31,657 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 06:58:31
File: problemm20251220_20251222_065831.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 06:58:31,657 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 06:58:31,657 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 06:58:31,657 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:31,658 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_065831.csv
2025-12-22 06:58:31,658 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_065831.csv...
2025-12-22 06:58:31,658 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_065831.csv
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 06:58:31,704 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 06:58:31,704 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 06:58:31,704 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_065831.csv
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_065831.csv by branches...
2025-12-22 06:58:31,704 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 06:58:31,704 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 06:58:31,718 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 06:58:31,724 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 06:58:31,729 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 06:58:31,734 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 06:58:31,739 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 06:58:31,744 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 06:58:31,744 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 06:58:34,791 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 06:58:36,094 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.30s (198 transfers)
2025-12-22 06:58:37,057 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_065831_asherin.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_065831_wardani.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_065831_akba.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_065831_shahid.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_065831_nujum.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_065831_admin.csv
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.07 surplus=1.98 writes=0.35 total=5.35
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 06:58:37,058 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 06:58:37,058 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 06:58:37,058 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 06:58:37,058 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065831_from_admin_to_akba.csv (9.2 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065831_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065831_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065831_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065831_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_065831_from_akba_to_admin.csv (84.0 B)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065831_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065831_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065831_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065831_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065831_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065831_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 06:58:37,441 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065831_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065831_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065831_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065831_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065831_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065831_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_065831_from_shahid_to_admin.csv (87.0 B)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065831_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065831_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065831_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_065831_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_065831_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_065831_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_065831_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_065831_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 06:58:37,442 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 06:58:37,442 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 06:58:37,442 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:58:37,442 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 06:58:37,596 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 06:58:37,597 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 06:58:37,597 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 06:58:38,256 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 06:58:38,256 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 06:58:38,256 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 06:58:38,256 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:38,900 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 06:58:39,551 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 06:58:40,197 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 06:58:40,838 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 06:58:41,476 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 06:58:42,122 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 06:58:42,123 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 06:58:42,440 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 06:58:42,440 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 06:58:42,440 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 06:58:42,440 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 06:58:42,440 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 06:58:42,441 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 06:58:42,441 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 06:58:42,441 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:42,441 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 06:58:42,441 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 06:58:43,025 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 06:58:43,033 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 06:58:43,281 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 06:58:43,282 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 06:58:43,282 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 06:58:43,282 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 06:58:43,282 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 06:58:44,985 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 06:58:46,511 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 06:58:48,539 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 06:58:50,786 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 06:58:52,837 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 06:58:54,516 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 06:58:54,516 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 06:58:54,516 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 06:58:54,517 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 06:58:54,517 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 06:58:54,517 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 07:03:17,594 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 07:03:17,594 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 07:03:17,594 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 07:03:17,594 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 07:03:17,595 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 07:03:17,596 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 07:03:17,597 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 07:03:17,598 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 07:03:17,598 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 07:03:17,598 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 07:03:19,241 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 07:03:21,413 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 07:03:21,413 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 07:03:21,413 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 07:03:21,413 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 07:03:21,414 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 07:03:21,983 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 07:03:21,983 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 07:03:21,983 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 07:03:21,983 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 07:03:21,983 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 07:03:22,527 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 07:03:22,527 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 07:03:22,527 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:22,527 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 07:03:22,527 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 07:03:22,527 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 07:03:22,527 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_070322/output
2025-12-22 07:03:22,529 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 07:03:22,563 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 07:03:22,563 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_070322
2025-12-22 07:03:22,563 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 07:03:22,563 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_070322.zip...
2025-12-22 07:03:22,846 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_070322.zip
2025-12-22 07:03:22,850 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 07:03:22,850 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 07:03:22,850 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 07:03:22,852 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 07:03:22,862 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 07:03:22,863 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 07:03:22,863 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 07:03:22,863 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 07:03:22,863 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 07:03:22,863 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:22,961 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 07:03:22,961 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_070322.csv...
2025-12-22 07:03:23,369 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 07:03:23,369 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 07:03:23,369 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 07:03:23,369 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:23,369 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_070322.csv
2025-12-22 07:03:23,369 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_070322.csv...
2025-12-22 07:03:23,369 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 07:03:23,370 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_070322.csv...
2025-12-22 07:03:23,413 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 07:03:23,414 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 07:03:23,414 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 07:03:23,414 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:23,414 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_070322.csv
2025-12-22 07:03:23,414 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_070322.csv...
2025-12-22 07:03:23,414 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 07:03:23,423 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 07:03:23
File: problemm20251220_20251222_070322.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 07:03:23,423 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 07:03:23,423 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 07:03:23,423 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:23,423 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_070322.csv
2025-12-22 07:03:23,423 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_070322.csv...
2025-12-22 07:03:23,423 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 07:03:23,466 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 07:03:23,466 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_070323.csv
2025-12-22 07:03:23,466 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 07:03:23,466 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 07:03:23,466 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 07:03:23,466 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:23,466 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_070323.csv
2025-12-22 07:03:23,467 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_070323.csv by branches...
2025-12-22 07:03:23,467 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 07:03:23,467 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 07:03:23,480 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 07:03:23,486 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 07:03:23,491 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 07:03:23,496 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 07:03:23,501 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 07:03:23,506 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 07:03:23,506 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 07:03:26,739 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 07:03:28,111 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.37s (198 transfers)
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_070323_asherin.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_070323_wardani.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_070323_akba.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_070323_shahid.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_070323_nujum.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_070323_admin.csv
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.10 surplus=2.13 writes=0.35 total=5.63
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 07:03:29,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 07:03:29,102 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 07:03:29,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 07:03:29,102 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_070323_from_admin_to_akba.csv (9.2 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_070323_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_070323_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_070323_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_070323_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_070323_from_akba_to_admin.csv (84.0 B)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_070323_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_070323_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_070323_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_070323_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_070323_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_070323_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_070323_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_070323_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 07:03:29,493 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_070323_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_070323_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_070323_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_070323_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_070323_from_shahid_to_admin.csv (87.0 B)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_070323_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_070323_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_070323_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_070323_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_070323_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_070323_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_070323_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_070323_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 07:03:29,494 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 07:03:29,494 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 07:03:29,494 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 07:03:29,494 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 07:03:29,646 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 07:03:29,647 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 07:03:29,647 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 07:03:29,647 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 07:03:29,647 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 07:03:29,647 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 07:03:30,304 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 07:03:30,304 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 07:03:30,304 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 07:03:30,304 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:30,971 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 07:03:31,620 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 07:03:32,293 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 07:03:32,961 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 07:03:33,656 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 07:03:34,334 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 07:03:34,335 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 07:03:34,663 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 07:03:34,663 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 07:03:34,663 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 07:03:34,663 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 07:03:34,663 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 07:03:34,664 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 07:03:34,664 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 07:03:34,664 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:34,664 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 07:03:34,664 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 07:03:35,261 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 07:03:35,270 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 07:03:35,515 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 07:03:35,515 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 07:03:35,515 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 07:03:35,515 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 07:03:35,516 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 07:03:37,285 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 07:03:38,829 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 07:03:40,738 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 07:03:42,956 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 07:03:44,960 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 07:03:46,621 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 07:03:46,621 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 07:03:46,621 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 07:03:46,621 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 07:03:46,621 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 07:03:46,621 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 08:02:40,560 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 08:02:40,561 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 08:02:40,561 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 08:02:40,561 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 08:02:40,561 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 08:02:40,561 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 08:02:40,562 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 08:02:40,563 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 08:02:40,564 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 08:02:40,565 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 08:02:41,639 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 08:02:43,326 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 08:02:43,327 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 08:02:44,295 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 08:02:44,296 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 08:02:44,296 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 08:02:44,296 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 08:02:44,296 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 08:02:44,960 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 08:02:44,960 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 08:02:44,961 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:44,962 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 08:02:44,963 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 08:02:44,963 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 08:02:44,963 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_080244/output
2025-12-22 08:02:44,977 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 08:02:45,017 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 08:02:45,017 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_080244
2025-12-22 08:02:45,017 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 08:02:45,017 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_080244.zip...
2025-12-22 08:02:45,296 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_080244.zip
2025-12-22 08:02:45,300 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 08:02:45,300 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 08:02:45,300 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 08:02:45,302 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 08:02:45,313 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 08:02:45,313 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 08:02:45,313 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 08:02:45,313 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 08:02:45,313 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 08:02:45,313 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:45,414 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 08:02:45,414 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_080245.csv...
2025-12-22 08:02:45,861 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 08:02:45,861 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 08:02:45,861 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 08:02:45,861 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:45,861 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_080245.csv
2025-12-22 08:02:45,861 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_080245.csv...
2025-12-22 08:02:45,861 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 08:02:45,862 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_080245.csv...
2025-12-22 08:02:45,905 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 08:02:45,906 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 08:02:45,906 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 08:02:45,906 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:45,906 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_080245.csv
2025-12-22 08:02:45,906 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_080245.csv...
2025-12-22 08:02:45,906 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 08:02:45,915 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 08:02:45
File: problemm20251220_20251222_080245.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 08:02:45,915 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 08:02:45,915 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 08:02:45,915 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:45,915 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_080245.csv
2025-12-22 08:02:45,915 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_080245.csv...
2025-12-22 08:02:45,915 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 08:02:45,962 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 08:02:45,962 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_080245.csv
2025-12-22 08:02:45,962 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 08:02:45,963 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 08:02:45,963 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 08:02:45,963 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:45,963 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_080245.csv
2025-12-22 08:02:45,963 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_080245.csv by branches...
2025-12-22 08:02:45,963 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 08:02:45,963 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 08:02:45,976 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 08:02:45,982 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 08:02:45,987 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 08:02:45,992 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 08:02:45,997 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 08:02:46,002 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 08:02:46,002 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 08:02:49,034 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 08:02:50,384 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 1.35s (198 transfers)
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_080245_asherin.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_080245_wardani.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_080245_akba.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_080245_shahid.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_080245_nujum.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_080245_admin.csv
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=1.97 writes=0.37 total=5.42
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 08:02:51,382 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 08:02:51,382 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 08:02:51,382 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 08:02:51,382 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_080245_from_admin_to_akba.csv (9.2 KB)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_080245_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_080245_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_080245_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_080245_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_080245_from_akba_to_admin.csv (84.0 B)
2025-12-22 08:02:51,774 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_080245_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_080245_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_080245_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_080245_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_080245_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_080245_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_080245_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_080245_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_080245_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_080245_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_080245_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_080245_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_080245_from_shahid_to_admin.csv (87.0 B)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_080245_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_080245_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_080245_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_080245_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_080245_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_080245_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_080245_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_080245_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 08:02:51,775 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 08:02:51,775 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 08:02:51,775 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 08:02:51,775 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 08:02:51,776 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 08:02:51,927 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 08:02:51,928 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 08:02:51,928 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 08:02:52,591 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 08:02:52,591 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 08:02:52,591 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 08:02:52,592 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:53,284 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 08:02:53,975 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 08:02:54,679 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 08:02:55,381 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 08:02:56,083 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 08:02:56,784 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 08:02:56,784 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 08:02:57,122 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 08:02:57,122 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 08:02:57,122 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 08:02:57,122 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 08:02:57,122 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 08:02:57,123 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 08:02:57,123 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 08:02:57,123 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:57,123 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 08:02:57,123 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 08:02:57,725 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 08:02:57,734 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 08:02:57,978 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 08:02:57,978 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 08:02:57,978 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 08:02:57,978 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 08:02:59,680 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 08:03:01,133 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 08:03:03,083 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 08:03:05,227 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 08:03:07,235 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 08:03:08,901 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 08:03:08,901 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 08:03:08,901 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 08:03:08,901 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 08:03:08,901 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 08:03:08,901 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 09:25:33,677 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:25:34,064 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 09:25:35,325 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 09:25:35,326 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:25:36,449 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 09:25:36,449 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:25:36,449 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 09:25:36,450 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 09:25:36,450 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 09:25:37,658 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 09:25:37,659 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 09:25:37,659 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:37,660 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 09:25:37,660 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 09:25:37,661 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 09:25:37,661 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_092537/output
2025-12-22 09:25:37,671 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 09:25:37,807 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 09:25:37,807 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_092537
2025-12-22 09:25:37,807 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 09:25:37,807 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_092537.zip...
2025-12-22 09:25:38,087 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_092537.zip
2025-12-22 09:25:38,091 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 09:25:38,091 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 09:25:38,091 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 09:25:38,093 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 09:25:38,103 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 09:25:38,104 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 09:25:38,104 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 09:25:38,104 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 09:25:38,104 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 09:25:38,104 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:38,205 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 09:25:38,205 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_092538.csv...
2025-12-22 09:25:38,617 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 09:25:38,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 09:25:38,617 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 09:25:38,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:38,617 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_092538.csv
2025-12-22 09:25:38,617 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_092538.csv...
2025-12-22 09:25:38,617 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 09:25:38,618 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_092538.csv...
2025-12-22 09:25:38,664 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 09:25:38,664 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 09:25:38,664 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 09:25:38,664 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:38,665 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_092538.csv
2025-12-22 09:25:38,665 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_092538.csv...
2025-12-22 09:25:38,665 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 09:25:38,676 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 09:25:38
File: problemm20251220_20251222_092538.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 09:25:38,676 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 09:25:38,676 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 09:25:38,676 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:38,676 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_092538.csv
2025-12-22 09:25:38,676 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_092538.csv...
2025-12-22 09:25:38,676 | INFO     | src.app.pipeline.step_5.handler | --------------------------------------------------
2025-12-22 09:25:38,729 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
2025-12-22 09:25:38,729 | INFO     | src.app.pipeline.step_5.handler | Output file: problemm20251220_renamed_20251222_092538.csv
2025-12-22 09:25:38,729 | INFO     | src.app.pipeline.step_5.handler | Saved to: data/output/converted/renamed
2025-12-22 09:25:38,729 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 09:25:38,729 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 09:25:38,729 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:38,729 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_092538.csv
2025-12-22 09:25:38,730 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_092538.csv by branches...
2025-12-22 09:25:38,730 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 09:25:38,730 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 09:25:38,745 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 09:25:38,751 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 09:25:38,756 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 09:25:38,766 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 09:25:38,773 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 09:25:38,780 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 09:25:38,780 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 09:25:41,899 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 09:25:43,919 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.02s (198 transfers)
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_092538_asherin.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_092538_wardani.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_092538_akba.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_092538_shahid.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_092538_nujum.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_092538_admin.csv
2025-12-22 09:25:44,917 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=1.07 surplus=2.05 writes=0.36 total=6.19
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 09:25:44,918 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 09:25:44,918 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 09:25:44,918 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 09:25:44,918 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 09:25:45,309 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_092538_from_admin_to_akba.csv (9.2 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_092538_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_092538_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_092538_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_092538_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_092538_from_akba_to_admin.csv (84.0 B)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_092538_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_092538_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_092538_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_092538_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_092538_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_092538_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_092538_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_092538_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_092538_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_092538_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_092538_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_092538_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_092538_from_shahid_to_admin.csv (87.0 B)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_092538_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_092538_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_092538_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_092538_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_092538_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_092538_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_092538_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_092538_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 09:25:45,310 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 09:25:45,310 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 09:25:45,310 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:25:45,310 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:45,311 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
2025-12-22 09:25:45,311 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 09:25:45,311 | INFO     | src.app.pipeline.step_8.handler | Found 27 transfer files to split
2025-12-22 09:25:45,467 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 09:25:45,467 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 09:25:45,467 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 09:25:45,467 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 09:25:45,467 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler | Starting Excel conversion...
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 09:25:45,468 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 09:25:46,119 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 09:25:46,119 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 09:25:46,119 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 09:25:46,119 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:46,820 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 09:25:47,512 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 09:25:48,260 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 09:25:48,973 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 09:25:49,667 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 09:25:50,363 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 09:25:50,363 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 09:25:50,699 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 09:25:50,699 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 09:25:50,699 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 09:25:50,699 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 09:25:51,317 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 09:25:51,325 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 09:25:51,580 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 09:25:51,580 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 09:25:51,580 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:25:51,580 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 09:25:53,337 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 09:25:54,804 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 09:25:56,677 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 09:25:58,885 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 09:26:01,201 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 09:26:02,939 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 09:26:02,939 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 09:26:02,939 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 09:26:02,939 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 09:26:02,939 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 09:26:02,939 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display | 
Available steps:
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 09:42:14,331 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display |   0. Exit
2025-12-22 09:42:14,332 | INFO     | src.app.cli.ui.display | ==================================================
2025-12-22 09:42:17,155 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 09:42:20,413 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 09:42:20,414 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 09:42:25,579 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 09:42:25,579 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:42:25,579 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 09:42:25,579 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 09:42:25,579 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 09:42:26,835 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 09:42:26,835 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 09:42:26,835 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:26,835 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 09:42:26,835 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
2025-12-22 09:42:26,835 | INFO     | src.shared.utils.archiver |   Source: data/output
2025-12-22 09:42:26,835 | INFO     | src.shared.utils.archiver |   Destination: data/archive/archive_20251222_094226/output
2025-12-22 09:42:26,838 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 09:42:26,977 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 09:42:26,978 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_094226
2025-12-22 09:42:26,978 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 09:42:26,978 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_094226.zip...
2025-12-22 09:42:27,328 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_094226.zip
2025-12-22 09:42:27,332 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 09:42:27,332 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 09:42:27,332 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 09:42:27,334 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 09:42:27,347 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
2025-12-22 09:42:27,347 | INFO     | src.shared.utils.archiver |   ✓ Deleted 833 files and 196 directories
2025-12-22 09:42:27,347 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 09:42:27,347 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 09:42:27,347 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 09:42:27,347 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:27,485 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 09:42:27,485 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_094227.csv...
2025-12-22 09:42:28,006 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 09:42:28,006 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 09:42:28,006 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 09:42:28,006 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:28,006 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_094227.csv
2025-12-22 09:42:28,006 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_094227.csv...
2025-12-22 09:42:28,006 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 09:42:28,006 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 09:42:28,007 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_094227.csv...
2025-12-22 09:42:28,055 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 09:42:28,055 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 09:42:28,055 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 09:42:28,055 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:28,055 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_094227.csv
2025-12-22 09:42:28,055 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_094227.csv...
2025-12-22 09:42:28,055 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 09:42:28,067 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 09:42:28
File: problemm20251220_20251222_094227.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 09:42:28,067 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 09:42:28,067 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 09:42:28,067 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:28,067 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_094227.csv
2025-12-22 09:42:28,067 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_094227.csv...
--------------------------------------------------
2025-12-22 09:42:28,126 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_094228.csv
Saved to: data/output/converted/renamed
2025-12-22 09:42:28,126 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 09:42:28,126 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 09:42:28,126 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:28,127 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_094228.csv
2025-12-22 09:42:28,127 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_094228.csv by branches...
2025-12-22 09:42:28,127 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 09:42:28,127 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 09:42:28,142 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 09:42:28,149 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 09:42:28,155 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 09:42:28,161 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 09:42:28,166 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 09:42:28,172 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 09:42:28,172 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 09:42:31,755 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 09:42:34,035 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.28s (198 transfers)
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_094228_asherin.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_094228_wardani.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_094228_akba.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_094228_shahid.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_094228_nujum.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_094228_admin.csv
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 09:42:35,175 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 09:42:35,176 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.26 surplus=2.33 writes=0.43 total=7.05
2025-12-22 09:42:35,176 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 09:42:35,176 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 09:42:35,176 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 09:42:35,176 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:35,176 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 09:42:35,176 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 09:42:35,176 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 09:42:35,647 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 09:42:35,647 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_094228_from_admin_to_akba.csv (9.2 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_094228_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_094228_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_094228_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_094228_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_094228_from_akba_to_admin.csv (84.0 B)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_094228_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_094228_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_094228_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_094228_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_094228_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_094228_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_094228_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_094228_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_094228_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_094228_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_094228_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_094228_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_094228_from_shahid_to_admin.csv (87.0 B)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_094228_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_094228_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_094228_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_094228_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_094228_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_094228_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 09:42:35,648 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_094228_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 09:42:35,649 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_094228_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 09:42:35,649 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 09:42:35,649 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 09:42:35,649 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 09:42:35,649 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:35,649 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 09:42:35,852 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 09:42:35,853 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 09:42:35,854 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 09:42:35,854 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 09:42:36,724 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 09:42:36,724 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 09:42:36,724 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 09:42:36,724 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:37,487 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 09:42:38,264 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 09:42:39,034 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 09:42:39,843 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 09:42:40,685 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 09:42:41,596 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 09:42:41,597 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 09:42:42,077 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 09:42:42,077 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 09:42:42,077 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 09:42:42,077 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 09:42:42,077 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 09:42:42,078 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 09:42:42,078 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 09:42:42,078 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:42,078 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
2025-12-22 09:42:42,078 | INFO     | src.app.pipeline.step_10.handler | --------------------------------------------------
2025-12-22 09:42:42,914 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 09:42:42,924 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler | ==================================================
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler | Generated shortage files:
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 09:42:43,264 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler | Total shortage quantity: 7223 units
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler | 
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler | CSV files saved to: data/output/shortage/csv
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_10.handler | Excel files saved to: data/output/shortage/excel
2025-12-22 09:42:43,265 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 09:42:43,265 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 09:42:43,265 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 09:42:43,265 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 09:42:45,783 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 09:42:47,457 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 09:42:49,727 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 09:42:52,531 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 09:42:55,037 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 09:42:57,090 | INFO     | src.app.pipeline.step_11.handler | ==================================================
2025-12-22 09:42:57,090 | INFO     | src.app.pipeline.step_11.handler | Generated 36 merged files (CSV + Excel)
2025-12-22 09:42:57,090 | INFO     | src.app.pipeline.step_11.handler | Generated 172 separate files (CSV + Excel)
2025-12-22 09:42:57,090 | INFO     | src.app.pipeline.step_11.handler | Merged output: data/output/combined_transfers/merged/excel
2025-12-22 09:42:57,090 | INFO     | src.app.pipeline.step_11.handler | Separate output: data/output/combined_transfers/separate/excel
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor | Execution Summary:
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor |   Total steps: 11
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor |   Successful: 11
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor |   Failed: 0
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor |   Success rate: 100.0%
2025-12-22 09:42:57,090 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 12:26:34,698 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 12:26:34,699 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 12:26:34,699 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 12:26:34,700 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 12:26:34,700 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 12:26:34,700 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 12:26:34,701 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 12:26:34,702 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 12:26:34,702 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 12:26:34,703 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 12:26:34,704 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 12:26:34,704 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 12:26:34,704 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 12:26:34,705 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 12:26:34,706 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 12:26:34,707 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 12:26:34,707 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 12:26:34,708 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 12:26:34,708 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 12:26:34,708 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 12:26:34,708 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 12:26:34,709 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 12:26:34,709 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 12:26:34,710 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 12:26:34,710 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 12:26:34,711 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 12:26:38,017 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 12:26:38,018 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 12:26:38,018 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 12:26:38,018 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 12:26:38,018 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 12:26:44,370 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 12:26:44,371 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 12:26:45,380 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 12:26:45,380 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 12:26:45,380 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 12:26:45,380 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 12:26:45,380 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 12:26:45,668 | ERROR    | src.app.cli.handlers.input_handler | Invalid option!
2025-12-22 12:26:48,604 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 12:26:48,604 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 12:26:48,604 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 12:26:48,604 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 12:26:48,604 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 12:26:48,605 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 12:26:50,268 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 12:26:50,268 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 12:26:50,268 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 12:26:50,268 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 12:26:50,268 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 12:26:51,164 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 12:26:51,164 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 12:26:51,164 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:51,165 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 12:26:51,166 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_122651/output
2025-12-22 12:26:51,168 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 12:26:51,333 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 12:26:51,333 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_122651
2025-12-22 12:26:51,333 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 12:26:51,333 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_122651.zip...
2025-12-22 12:26:51,675 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_122651.zip
2025-12-22 12:26:51,679 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 12:26:51,679 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 12:26:51,679 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 12:26:51,681 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 12:26:51,691 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 12:26:51,691 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 12:26:51,691 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 12:26:51,691 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 12:26:51,691 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:51,811 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 12:26:51,811 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_122651.csv...
2025-12-22 12:26:52,316 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 12:26:52,316 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 12:26:52,316 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 12:26:52,316 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:52,316 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_122651.csv
2025-12-22 12:26:52,316 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_122651.csv...
2025-12-22 12:26:52,316 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 12:26:52,317 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_122651.csv...
2025-12-22 12:26:52,368 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 12:26:52,368 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 12:26:52,368 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 12:26:52,368 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:52,368 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_122651.csv
2025-12-22 12:26:52,368 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_122651.csv...
2025-12-22 12:26:52,368 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 12:26:52,378 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 12:26:52
File: problemm20251220_20251222_122651.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 12:26:52,378 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 12:26:52,378 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 12:26:52,378 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:52,378 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_122651.csv
2025-12-22 12:26:52,378 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_122651.csv...
--------------------------------------------------
2025-12-22 12:26:52,427 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_122652.csv
Saved to: data/output/converted/renamed
2025-12-22 12:26:52,427 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 12:26:52,427 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 12:26:52,427 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:52,427 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_122652.csv
2025-12-22 12:26:52,428 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_122652.csv by branches...
2025-12-22 12:26:52,428 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 12:26:52,428 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 12:26:52,441 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 12:26:52,448 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 12:26:52,454 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 12:26:52,460 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 12:26:52,465 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 12:26:52,471 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 12:26:52,471 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 12:26:55,583 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 12:26:57,699 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.12s (198 transfers)
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_122652_asherin.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_122652_wardani.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_122652_akba.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_122652_shahid.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_122652_nujum.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_122652_admin.csv
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.14 surplus=1.98 writes=0.41 total=6.33
2025-12-22 12:26:58,754 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 12:26:58,754 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 12:26:58,754 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 12:26:58,754 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:58,755 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 12:26:58,755 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 12:26:58,755 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_122652_from_admin_to_akba.csv (9.2 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_122652_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_122652_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_122652_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_122652_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_122652_from_akba_to_admin.csv (84.0 B)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_122652_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_122652_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_122652_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_122652_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_122652_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_122652_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_122652_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_122652_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_122652_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_122652_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_122652_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_122652_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 12:26:59,176 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_122652_from_shahid_to_admin.csv (87.0 B)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_122652_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_122652_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_122652_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_122652_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_122652_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_122652_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_122652_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_122652_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 12:26:59,177 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 12:26:59,177 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 12:26:59,177 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:26:59,177 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 12:26:59,356 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 12:26:59,357 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 12:26:59,357 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 12:27:00,152 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 12:27:00,152 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 12:27:00,152 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 12:27:00,152 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:27:00,881 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 12:27:01,605 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 12:27:02,360 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 12:27:03,083 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 12:27:03,811 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 12:27:04,549 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 12:27:04,550 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 12:27:04,924 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 12:27:04,924 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 12:27:04,924 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 12:27:04,924 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 12:27:04,924 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 12:27:04,925 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 12:27:04,925 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 12:27:04,925 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:27:04,925 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 12:27:05,572 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 12:27:05,582 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 12:27:05,843 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 12:27:05,844 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 12:27:05,844 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 12:27:05,844 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 12:27:05,844 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 12:27:07,745 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 12:27:09,358 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 12:27:11,417 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 12:27:13,778 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 12:27:15,996 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 12:27:17,825 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 12:27:17,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 12:27:17,825 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 13:07:18,462 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 13:07:18,462 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 13:07:18,463 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 13:07:18,463 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 13:07:18,463 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 13:07:18,463 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 13:07:18,464 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 13:07:18,464 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 13:07:18,464 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 13:07:18,464 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 13:07:18,464 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 13:07:18,465 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 13:07:19,094 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 13:07:20,991 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 13:07:20,992 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 13:07:22,289 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 13:07:22,289 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 13:07:22,289 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 13:07:22,289 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 13:07:22,290 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 13:07:23,219 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 13:07:23,220 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 13:07:23,220 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:23,221 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 13:07:23,222 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_130723/output
2025-12-22 13:07:23,236 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 13:07:23,325 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 13:07:23,325 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_130723
2025-12-22 13:07:23,325 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 13:07:23,325 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_130723.zip...
2025-12-22 13:07:23,655 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_130723.zip
2025-12-22 13:07:23,660 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 13:07:23,660 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 13:07:23,660 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 13:07:23,662 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 13:07:23,670 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 13:07:23,670 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 13:07:23,670 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 13:07:23,670 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 13:07:23,671 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:23,804 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 13:07:23,805 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_130723.csv...
2025-12-22 13:07:24,228 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 13:07:24,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 13:07:24,228 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 13:07:24,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:24,228 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_130723.csv
2025-12-22 13:07:24,228 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_130723.csv...
2025-12-22 13:07:24,228 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 13:07:24,229 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_130723.csv...
2025-12-22 13:07:24,273 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 13:07:24,273 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 13:07:24,273 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 13:07:24,273 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:24,274 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_130723.csv
2025-12-22 13:07:24,274 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_130723.csv...
2025-12-22 13:07:24,274 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 13:07:24,283 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 13:07:24
File: problemm20251220_20251222_130723.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 13:07:24,283 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 13:07:24,283 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 13:07:24,283 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:24,283 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_130723.csv
2025-12-22 13:07:24,283 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_130723.csv...
--------------------------------------------------
2025-12-22 13:07:24,330 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_130724.csv
Saved to: data/output/converted/renamed
2025-12-22 13:07:24,330 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 13:07:24,330 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 13:07:24,330 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:24,330 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_130724.csv
2025-12-22 13:07:24,330 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_130724.csv by branches...
2025-12-22 13:07:24,330 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 13:07:24,331 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 13:07:24,344 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 13:07:24,350 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 13:07:24,356 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 13:07:24,361 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 13:07:24,366 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 13:07:24,371 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 13:07:24,371 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 13:07:27,459 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 13:07:29,559 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.10s (198 transfers)
2025-12-22 13:07:30,616 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_130724_asherin.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_130724_wardani.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_130724_akba.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_130724_shahid.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_130724_nujum.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_130724_admin.csv
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=2.01 writes=0.38 total=6.29
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 13:07:30,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 13:07:30,617 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 13:07:30,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 13:07:30,617 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_130724_from_admin_to_akba.csv (9.2 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_130724_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_130724_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_130724_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_130724_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_130724_from_akba_to_admin.csv (84.0 B)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_130724_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_130724_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_130724_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_130724_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_130724_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_130724_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_130724_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_130724_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_130724_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_130724_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_130724_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 13:07:31,037 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_130724_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_130724_from_shahid_to_admin.csv (87.0 B)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_130724_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_130724_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_130724_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_130724_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_130724_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_130724_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_130724_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_130724_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 13:07:31,038 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 13:07:31,038 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:07:31,038 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:31,038 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 13:07:31,190 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 13:07:31,191 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 13:07:31,191 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 13:07:31,908 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 13:07:31,908 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 13:07:31,908 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 13:07:31,908 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:32,608 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 13:07:33,291 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 13:07:33,988 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 13:07:34,682 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 13:07:35,369 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 13:07:36,071 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 13:07:36,071 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 13:07:36,399 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 13:07:36,399 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 13:07:36,399 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 13:07:36,399 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 13:07:36,400 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 13:07:36,400 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 13:07:36,400 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 13:07:36,400 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:36,400 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 13:07:37,012 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 13:07:37,021 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 13:07:37,261 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 13:07:37,261 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 13:07:37,261 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:07:37,261 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 13:07:38,979 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 13:07:40,460 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 13:07:42,381 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 13:07:44,716 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 13:07:46,967 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 13:07:48,602 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 13:07:48,602 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 13:07:48,602 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 13:35:12,096 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 13:35:12,096 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 13:35:12,096 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 13:35:12,096 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 13:35:12,096 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 13:35:12,097 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 13:35:14,008 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 13:35:15,533 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 13:35:15,533 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 13:35:15,533 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 13:35:15,533 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 13:35:15,533 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 13:35:15,534 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 13:35:16,240 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 13:35:16,240 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 13:35:16,240 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 13:35:16,240 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 13:35:16,240 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 13:35:16,888 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 13:35:16,888 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 13:35:16,888 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:16,888 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 13:35:16,888 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_133516/output
2025-12-22 13:35:16,890 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 13:35:17,013 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 13:35:17,013 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_133516
2025-12-22 13:35:17,013 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 13:35:17,013 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_133516.zip...
2025-12-22 13:35:17,304 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_133516.zip
2025-12-22 13:35:17,308 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 13:35:17,308 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 13:35:17,308 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 13:35:17,310 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 13:35:17,321 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 13:35:17,321 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 13:35:17,321 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 13:35:17,321 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 13:35:17,321 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:17,428 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 13:35:17,428 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_133517.csv...
2025-12-22 13:35:17,918 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 13:35:17,918 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 13:35:17,918 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 13:35:17,918 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:17,918 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_133517.csv
2025-12-22 13:35:17,918 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_133517.csv...
2025-12-22 13:35:17,918 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 13:35:17,919 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_133517.csv...
2025-12-22 13:35:17,964 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 13:35:17,964 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 13:35:17,965 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 13:35:17,965 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:17,965 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_133517.csv
2025-12-22 13:35:17,965 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_133517.csv...
2025-12-22 13:35:17,965 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 13:35:17,975 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 13:35:17
File: problemm20251220_20251222_133517.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 13:35:17,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 13:35:17,975 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 13:35:17,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:17,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_133517.csv
2025-12-22 13:35:17,975 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_133517.csv...
--------------------------------------------------
2025-12-22 13:35:18,028 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_133517.csv
Saved to: data/output/converted/renamed
2025-12-22 13:35:18,029 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 13:35:18,029 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 13:35:18,029 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:18,029 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_133517.csv
2025-12-22 13:35:18,029 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_133517.csv by branches...
2025-12-22 13:35:18,029 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 13:35:18,030 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 13:35:18,051 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 13:35:18,061 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 13:35:18,071 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 13:35:18,077 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 13:35:18,083 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 13:35:18,091 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 13:35:18,091 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 13:35:21,182 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 13:35:23,280 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.10s (198 transfers)
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_133518_asherin.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_133518_wardani.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_133518_akba.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_133518_shahid.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_133518_nujum.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_133518_admin.csv
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.06 allocation=1.13 surplus=1.96 writes=0.36 total=6.25
2025-12-22 13:35:24,284 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 13:35:24,285 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 13:35:24,285 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 13:35:24,285 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:24,285 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 13:35:24,285 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 13:35:24,285 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 13:35:24,694 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_133518_from_admin_to_akba.csv (9.2 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_133518_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_133518_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_133518_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_133518_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_133518_from_akba_to_admin.csv (84.0 B)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_133518_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_133518_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_133518_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_133518_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_133518_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_133518_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_133518_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_133518_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_133518_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_133518_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_133518_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_133518_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_133518_from_shahid_to_admin.csv (87.0 B)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_133518_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_133518_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_133518_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_133518_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_133518_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_133518_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_133518_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_133518_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 13:35:24,695 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 13:35:24,695 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 13:35:24,695 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 13:35:24,695 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:24,696 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 13:35:24,848 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 13:35:25,571 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 13:35:25,571 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 13:35:25,571 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 13:35:25,571 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:26,296 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 13:35:27,003 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 13:35:27,699 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 13:35:28,405 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 13:35:29,109 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 13:35:29,826 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 13:35:29,827 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 13:35:30,149 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 13:35:30,149 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 13:35:30,149 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 13:35:30,149 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 13:35:30,149 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 13:35:30,150 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 13:35:30,150 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 13:35:30,150 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:30,150 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 13:35:30,774 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 13:35:30,782 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 13:35:31,025 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 13:35:31,025 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 13:35:31,025 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 13:35:31,025 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 13:35:31,025 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 13:35:31,026 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 13:35:31,026 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 13:35:31,026 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 13:35:31,026 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 13:35:31,026 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 13:35:31,026 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 13:35:31,026 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 13:35:32,775 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 13:35:34,296 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 13:35:36,276 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 13:35:38,605 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 13:35:40,714 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 13:35:42,378 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 13:35:42,378 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 13:35:42,378 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 14:42:05,396 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:42:05,396 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:42:05,396 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:42:05,396 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:42:05,396 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:42:05,397 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:42:05,398 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:42:05,399 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:42:05,399 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:42:06,331 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 14:42:07,906 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:42:07,906 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:42:07,906 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:42:07,906 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:42:07,906 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:42:07,907 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:42:10,889 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 14:42:10,889 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 14:42:10,889 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 14:42:10,889 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 14:42:10,890 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 14:42:11,905 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 14:42:11,905 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 14:42:11,905 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:11,906 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 14:42:11,907 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_144211/output
2025-12-22 14:42:11,910 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 14:42:11,943 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 14:42:11,943 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_144211
2025-12-22 14:42:11,943 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 14:42:11,943 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_144211.zip...
2025-12-22 14:42:12,234 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_144211.zip
2025-12-22 14:42:12,238 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 14:42:12,239 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 14:42:12,239 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 14:42:12,240 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 14:42:12,251 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 14:42:12,252 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 14:42:12,252 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:42:12,252 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 14:42:12,252 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:12,358 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 14:42:12,359 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_144212.csv...
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 14:42:12,836 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 14:42:12,836 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 14:42:12,836 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144212.csv
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_144212.csv...
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 14:42:12,836 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:42:12,837 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_144212.csv...
2025-12-22 14:42:12,881 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 14:42:12,881 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 14:42:12,881 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 14:42:12,881 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:12,881 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144212.csv
2025-12-22 14:42:12,882 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_144212.csv...
2025-12-22 14:42:12,882 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 14:42:12,891 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 14:42:12
File: problemm20251220_20251222_144212.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 14:42:12,891 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 14:42:12,891 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 14:42:12,891 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:12,891 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144212.csv
2025-12-22 14:42:12,891 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_144212.csv...
--------------------------------------------------
2025-12-22 14:42:12,936 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_144212.csv
Saved to: data/output/converted/renamed
2025-12-22 14:42:12,936 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 14:42:12,936 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 14:42:12,936 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:12,936 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_144212.csv
2025-12-22 14:42:12,937 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_144212.csv by branches...
2025-12-22 14:42:12,937 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 14:42:12,937 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 14:42:12,951 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 14:42:12,957 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 14:42:12,962 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 14:42:12,967 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 14:42:12,973 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 14:42:12,978 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 14:42:12,978 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 14:42:15,978 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 14:42:18,160 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.18s (198 transfers)
2025-12-22 14:42:19,178 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_144212_asherin.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_144212_wardani.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_144212_akba.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_144212_shahid.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_144212_nujum.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_144212_admin.csv
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=1.92 writes=0.37 total=6.24
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 14:42:19,179 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 14:42:19,179 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 14:42:19,179 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 14:42:19,179 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144212_from_admin_to_akba.csv (9.2 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144212_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144212_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144212_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144212_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144212_from_akba_to_admin.csv (84.0 B)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144212_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144212_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144212_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144212_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 14:42:19,584 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144212_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144212_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144212_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144212_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144212_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144212_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144212_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144212_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144212_from_shahid_to_admin.csv (87.0 B)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144212_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144212_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144212_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144212_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144212_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144212_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144212_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144212_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 14:42:19,585 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 14:42:19,585 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:42:19,585 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:19,585 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 14:42:19,740 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 14:42:19,741 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 14:42:19,741 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:42:20,457 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 14:42:20,458 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 14:42:20,458 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 14:42:20,458 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:21,232 | ERROR    | src.app.pipeline.step_9.handler | Error generating remaining surplus files: generate_csv_files() got an unexpected keyword argument 'df'
Traceback (most recent call last):
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 49, in step_9_generate_remaining_surplus
    return _execute_surplus_generation(branches)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 175, in _execute_surplus_generation
    all_branch_files = _process_all_branches(branches)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 162, in _process_all_branches
    branch_files = _process_branch(branch)
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 154, in _process_branch
    return _generate_branch_files(result_dataframe, branch, has_date_header, first_line)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 136, in _generate_branch_files
    return _create_csv_and_log(result_dataframe, branch, CSV_OUTPUT_DIR, base_name,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/abdo/Public/python_project/distribution_of_goods/src/app/pipeline/step_9/handler.py", line 118, in _create_csv_and_log
    csv_files = generate_csv_files(
                ^^^^^^^^^^^^^^^^^^^
TypeError: generate_csv_files() got an unexpected keyword argument 'df'
2025-12-22 14:42:21,232 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 9 failed
2025-12-22 14:42:21,232 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 14:42:21,232 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:21,233 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 14:42:21,844 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 14:42:21,852 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 14:42:22,091 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 14:42:22,092 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 14:42:22,092 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 14:42:22,092 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 14:42:22,092 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:42:22,092 | ERROR    | src.app.pipeline.step_11.handler | Remaining surplus directory not found: data/output/remaining_surplus/csv
Please run Step 9 (Generate Remaining Surplus) first
2025-12-22 14:42:22,092 | ERROR    | src.app.cli.executors.step_executor | ✗ Step 11 failed
2025-12-22 14:42:22,092 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 9
  Failed: 2
  Success rate: 81.8%
==================================================
2025-12-22 14:43:46,236 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:43:46,236 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:43:46,236 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:43:46,236 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:43:46,236 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:43:46,237 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:43:48,400 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 14:43:49,630 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:43:49,630 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:43:49,631 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:43:50,804 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 14:43:50,804 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 14:43:50,804 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 14:43:50,804 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 14:43:50,804 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 14:43:51,612 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 14:43:51,612 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 14:43:51,612 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:51,612 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 14:43:51,613 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_144351/output
2025-12-22 14:43:51,614 | INFO     | src.shared.utils.archiver |   Found 345 files in 90 directories
2025-12-22 14:43:51,641 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 14:43:51,641 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_144351
2025-12-22 14:43:51,641 | INFO     | src.shared.utils.archiver |   - Archived 345 files in 90 directories
2025-12-22 14:43:51,641 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_144351.zip...
2025-12-22 14:43:51,848 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_144351.zip
2025-12-22 14:43:51,850 | INFO     | src.app.pipeline.step_1.handler | Archive created: 345 files, 90 dirs | Size: 10.05 MB
2025-12-22 14:43:51,850 | INFO     | src.app.pipeline.step_1.handler | ZIP: 2.82 MB (72.0% compression)
2025-12-22 14:43:51,850 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 14:43:51,851 | INFO     | src.shared.utils.archiver |   Found 345 files in 90 directories to delete
2025-12-22 14:43:51,856 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 345 files and 90 directories
2025-12-22 14:43:51,856 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 14:43:51,857 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:43:51,857 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 14:43:51,857 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:51,964 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 14:43:51,964 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_144351.csv...
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 14:43:52,411 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 14:43:52,411 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 14:43:52,411 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144351.csv
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_144351.csv...
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 14:43:52,411 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:43:52,412 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_144351.csv...
2025-12-22 14:43:52,457 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 14:43:52,457 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 14:43:52,457 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 14:43:52,457 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:52,457 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144351.csv
2025-12-22 14:43:52,457 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_144351.csv...
2025-12-22 14:43:52,457 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 14:43:52,466 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 14:43:52
File: problemm20251220_20251222_144351.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 14:43:52,466 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 14:43:52,466 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 14:43:52,466 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:52,467 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144351.csv
2025-12-22 14:43:52,467 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_144351.csv...
--------------------------------------------------
2025-12-22 14:43:52,510 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_144352.csv
Saved to: data/output/converted/renamed
2025-12-22 14:43:52,510 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 14:43:52,510 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 14:43:52,510 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:52,511 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_144352.csv
2025-12-22 14:43:52,511 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_144352.csv by branches...
2025-12-22 14:43:52,511 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 14:43:52,511 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 14:43:52,524 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 14:43:52,531 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 14:43:52,536 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 14:43:52,541 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 14:43:52,546 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 14:43:52,551 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 14:43:52,551 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 14:43:55,588 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 14:43:57,698 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.11s (198 transfers)
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_144352_asherin.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_144352_wardani.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_144352_akba.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_144352_shahid.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_144352_nujum.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_144352_admin.csv
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=1.96 writes=0.36 total=6.19
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 14:43:58,705 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 14:43:58,705 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 14:43:58,705 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 14:43:58,705 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144352_from_admin_to_akba.csv (9.2 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144352_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144352_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144352_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144352_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144352_from_akba_to_admin.csv (84.0 B)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144352_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144352_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144352_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144352_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144352_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144352_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 14:43:59,100 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144352_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144352_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144352_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144352_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144352_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144352_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144352_from_shahid_to_admin.csv (87.0 B)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144352_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144352_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144352_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144352_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144352_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144352_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144352_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144352_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 14:43:59,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 14:43:59,101 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:43:59,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:43:59,101 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 14:43:59,256 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 14:43:59,257 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 14:43:59,916 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 14:43:59,916 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:43:59,916 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:43:59,916 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:43:59,916 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:43:59,917 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:43:59,917 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:43:59,917 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 14:43:59,917 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 14:43:59,917 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 14:43:59,917 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:44:00,636 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 14:44:01,349 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 14:44:02,048 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 14:44:02,760 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 14:44:03,468 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 14:44:04,199 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 14:44:04,200 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 14:44:04,533 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 14:44:04,533 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 14:44:04,533 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 14:44:04,533 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 14:44:04,533 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 14:44:04,534 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 14:44:04,534 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 14:44:04,534 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:44:04,534 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 14:44:05,158 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 14:44:05,166 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 14:44:05,411 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 14:44:05,411 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 14:44:05,411 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 14:44:05,411 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:44:05,412 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 14:44:07,174 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 14:44:08,702 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 14:44:10,660 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 14:44:12,936 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 14:44:15,118 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 14:44:16,880 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 14:44:16,880 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 14:44:16,880 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:44:32,460 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:44:32,461 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | Running steps 1 through 1 (Total: 1 steps)
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | 
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | [1/1] Executing: Archive Previous Output
2025-12-22 14:44:32,461 | INFO     | src.app.cli.executors.step_executor | ----------------------------------------------------------------------
2025-12-22 14:44:32,461 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 14:44:32,461 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_144432/output
2025-12-22 14:44:32,463 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 14:44:32,496 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 14:44:32,496 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_144432
2025-12-22 14:44:32,496 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 14:44:32,496 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_144432.zip...
2025-12-22 14:44:32,787 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_144432.zip
2025-12-22 14:44:32,792 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 14:44:32,792 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 14:44:32,792 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 14:44:32,793 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 14:44:32,803 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 14:44:32,803 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 14:44:32,803 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:44:32,803 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed
2025-12-22 14:44:32,803 | INFO     | src.app.cli.executors.step_executor | 
2025-12-22 14:44:32,803 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-22 14:44:32,804 | INFO     | src.app.cli.executors.step_executor | ✓ SUCCESS: All 1 steps completed successfully!
2025-12-22 14:44:32,804 | INFO     | src.app.cli.executors.step_executor | ======================================================================
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:44:57,117 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:44:57,118 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:44:57,119 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:44:57,119 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:44:57,119 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:44:57,119 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:44:57,119 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:44:58,029 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 14:45:00,663 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:45:00,663 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:45:00,663 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:45:00,663 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:45:00,663 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:45:00,664 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:45:02,336 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 14:45:02,336 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 14:45:02,336 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 14:45:02,336 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 14:45:02,336 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 14:45:02,883 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 14:45:02,883 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 14:45:02,883 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:02,884 | INFO     | src.app.pipeline.step_1.handler | No previous output to archive. Starting fresh...
2025-12-22 14:45:02,884 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:45:02,884 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 14:45:02,884 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:03,004 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 14:45:03,004 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_144503.csv...
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 14:45:03,420 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 14:45:03,420 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 14:45:03,420 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144503.csv
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_144503.csv...
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 14:45:03,420 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:45:03,421 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_144503.csv...
2025-12-22 14:45:03,464 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 14:45:03,464 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 14:45:03,464 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 14:45:03,464 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:03,464 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144503.csv
2025-12-22 14:45:03,464 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_144503.csv...
2025-12-22 14:45:03,464 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 14:45:03,473 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 14:45:03
File: problemm20251220_20251222_144503.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 14:45:03,474 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 14:45:03,474 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 14:45:03,474 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:03,474 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144503.csv
2025-12-22 14:45:03,474 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_144503.csv...
--------------------------------------------------
2025-12-22 14:45:03,518 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_144503.csv
Saved to: data/output/converted/renamed
2025-12-22 14:45:03,518 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 14:45:03,518 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 14:45:03,518 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:03,518 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_144503.csv
2025-12-22 14:45:03,519 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_144503.csv by branches...
2025-12-22 14:45:03,519 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 14:45:03,519 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 14:45:03,532 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 14:45:03,538 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 14:45:03,544 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 14:45:03,549 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 14:45:03,554 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 14:45:03,559 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 14:45:03,559 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 14:45:06,555 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 14:45:08,613 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.06s (198 transfers)
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_144503_asherin.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_144503_wardani.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_144503_akba.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_144503_shahid.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_144503_nujum.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_144503_admin.csv
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=1.92 writes=0.36 total=6.11
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 14:45:09,626 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 14:45:09,626 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 14:45:09,626 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 14:45:09,626 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144503_from_admin_to_akba.csv (9.2 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144503_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144503_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144503_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144503_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144503_from_akba_to_admin.csv (84.0 B)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144503_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 14:45:10,025 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144503_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144503_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144503_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144503_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144503_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144503_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144503_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144503_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144503_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144503_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144503_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144503_from_shahid_to_admin.csv (87.0 B)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144503_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144503_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144503_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144503_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144503_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144503_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144503_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144503_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 14:45:10,026 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 14:45:10,026 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:45:10,026 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:10,026 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 14:45:10,179 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 14:45:10,179 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 14:45:10,180 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 14:45:10,836 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:45:10,837 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 14:45:10,837 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 14:45:10,837 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 14:45:10,837 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:11,599 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 14:45:12,341 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 14:45:13,067 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 14:45:13,793 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 14:45:14,503 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 14:45:15,225 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 14:45:15,225 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 14:45:15,552 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 14:45:15,552 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 14:45:15,552 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:15,552 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 14:45:16,210 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 14:45:16,219 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 14:45:16,444 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 14:45:16,444 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 14:45:16,444 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 14:45:16,444 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:45:16,445 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 14:45:18,226 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 14:45:19,753 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 14:45:21,884 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 14:45:24,170 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 14:45:26,279 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 14:45:28,036 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 14:45:28,036 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 14:45:28,036 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 14:48:28,987 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:48:28,987 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:48:28,988 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:48:28,988 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:48:28,988 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:48:28,988 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:48:28,989 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:48:28,989 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:48:28,989 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:48:28,989 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:48:28,989 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:48:28,990 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:48:28,990 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:48:28,990 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:48:28,990 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:48:28,990 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:48:28,991 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:48:28,992 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:48:28,992 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:48:28,992 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:48:28,992 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:48:30,840 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:48:32,047 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:48:32,048 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:48:33,278 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 14:48:33,279 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 14:48:33,279 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 14:48:33,279 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 14:48:33,280 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 14:48:33,983 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 14:48:33,983 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 14:48:33,983 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:33,984 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 14:48:33,985 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_144833/output
2025-12-22 14:48:33,998 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 14:48:34,041 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 14:48:34,041 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_144833
2025-12-22 14:48:34,041 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 14:48:34,041 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_144833.zip...
2025-12-22 14:48:34,333 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_144833.zip
2025-12-22 14:48:34,337 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 14:48:34,337 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 14:48:34,337 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 14:48:34,340 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 14:48:34,355 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 14:48:34,355 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 14:48:34,355 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:48:34,355 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 14:48:34,355 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:34,469 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 14:48:34,469 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_144834.csv...
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 14:48:34,921 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 14:48:34,921 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 14:48:34,921 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144834.csv
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_144834.csv...
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 14:48:34,921 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 14:48:34,922 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 14:48:34,922 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:48:34,922 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 14:48:34,922 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:48:34,922 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_144834.csv...
2025-12-22 14:48:34,965 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 14:48:34,965 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 14:48:34,965 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 14:48:34,965 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:34,965 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144834.csv
2025-12-22 14:48:34,966 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_144834.csv...
2025-12-22 14:48:34,966 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 14:48:34,975 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 14:48:34
File: problemm20251220_20251222_144834.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 14:48:34,975 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 14:48:34,975 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 14:48:34,975 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:34,975 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_144834.csv
2025-12-22 14:48:34,975 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_144834.csv...
--------------------------------------------------
2025-12-22 14:48:35,020 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_144834.csv
Saved to: data/output/converted/renamed
2025-12-22 14:48:35,020 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 14:48:35,020 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 14:48:35,020 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:35,020 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_144834.csv
2025-12-22 14:48:35,020 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_144834.csv by branches...
2025-12-22 14:48:35,020 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 14:48:35,020 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 14:48:35,037 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 14:48:35,045 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 14:48:35,053 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 14:48:35,059 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 14:48:35,067 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 14:48:35,073 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 14:48:35,073 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 14:48:38,104 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 14:48:40,134 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.03s (198 transfers)
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_144835_asherin.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_144835_wardani.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_144835_akba.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_144835_shahid.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_144835_nujum.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_144835_admin.csv
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=1.09 surplus=1.94 writes=0.36 total=6.12
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 14:48:41,138 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 14:48:41,138 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 14:48:41,138 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 14:48:41,138 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144835_from_admin_to_akba.csv (9.2 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144835_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144835_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144835_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144835_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144835_from_akba_to_admin.csv (84.0 B)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144835_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144835_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144835_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144835_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144835_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144835_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144835_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144835_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144835_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144835_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144835_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144835_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_144835_from_shahid_to_admin.csv (87.0 B)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144835_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144835_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144835_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_144835_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 14:48:41,532 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_144835_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 14:48:41,533 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_144835_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 14:48:41,533 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_144835_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 14:48:41,533 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_144835_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 14:48:41,533 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 14:48:41,533 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 14:48:41,533 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:48:41,533 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:41,533 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 14:48:41,685 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 14:48:41,686 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:48:42,333 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 14:48:42,333 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 14:48:42,333 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 14:48:42,333 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:43,042 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 14:48:43,796 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 14:48:44,593 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 14:48:45,389 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 14:48:46,180 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 14:48:46,952 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 14:48:46,952 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 14:48:47,303 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 14:48:47,303 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 14:48:47,303 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:47,303 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 14:48:47,935 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 14:48:47,943 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 14:48:48,186 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 14:48:48,186 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 14:48:48,186 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:48:48,186 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 14:48:49,937 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 14:48:51,448 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 14:48:53,409 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 14:48:55,663 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 14:48:57,713 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 14:48:59,379 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 14:48:59,380 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 14:48:59,380 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 14:54:27,149 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:54:27,149 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:54:27,149 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:54:27,149 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:54:27,149 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:54:27,150 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:54:27,151 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:54:27,152 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:54:27,152 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:54:27,152 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:54:27,152 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:54:27,152 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:54:28,259 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 14:54:30,239 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 14:54:30,239 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 14:54:30,239 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 14:54:30,239 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 14:54:30,239 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 14:54:30,240 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 14:54:31,522 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 14:54:31,523 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 14:54:31,523 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 14:54:31,523 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 14:54:31,523 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 14:54:32,331 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 14:54:32,332 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 14:54:32,332 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:32,333 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 14:54:32,333 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_145432/output
2025-12-22 14:54:32,343 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 14:54:32,386 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 14:54:32,386 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_145432
2025-12-22 14:54:32,387 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 14:54:32,387 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_145432.zip...
2025-12-22 14:54:32,684 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_145432.zip
2025-12-22 14:54:32,688 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 14:54:32,689 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 14:54:32,689 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 14:54:32,690 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 14:54:32,702 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 14:54:32,702 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 14:54:32,702 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 14:54:32,702 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 14:54:32,702 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:32,808 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 14:54:32,808 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_145432.csv...
2025-12-22 14:54:33,220 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 14:54:33,220 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 14:54:33,221 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 14:54:33,221 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_145432.csv
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_145432.csv...
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 14:54:33,221 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_145432.csv...
2025-12-22 14:54:33,264 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 14:54:33,264 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 14:54:33,264 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 14:54:33,265 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:33,265 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_145432.csv
2025-12-22 14:54:33,265 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_145432.csv...
2025-12-22 14:54:33,265 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 14:54:33,274 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 14:54:33
File: problemm20251220_20251222_145432.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 14:54:33,274 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 14:54:33,274 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 14:54:33,274 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:33,274 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_145432.csv
2025-12-22 14:54:33,274 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_145432.csv...
--------------------------------------------------
2025-12-22 14:54:33,321 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_145433.csv
Saved to: data/output/converted/renamed
2025-12-22 14:54:33,321 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 14:54:33,321 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 14:54:33,321 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:33,322 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_145433.csv
2025-12-22 14:54:33,322 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_145433.csv by branches...
2025-12-22 14:54:33,322 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 14:54:33,322 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 14:54:33,336 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 14:54:33,342 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 14:54:33,348 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 14:54:33,353 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 14:54:33,358 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 14:54:33,363 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 14:54:33,363 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 14:54:36,301 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 14:54:38,365 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.06s (198 transfers)
2025-12-22 14:54:39,347 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 14:54:39,347 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_145433_asherin.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_145433_wardani.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_145433_akba.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_145433_shahid.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_145433_nujum.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_145433_admin.csv
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.08 surplus=1.86 writes=0.35 total=6.03
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 14:54:39,348 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 14:54:39,348 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 14:54:39,348 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 14:54:39,348 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_145433_from_admin_to_akba.csv (9.2 KB)
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_145433_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_145433_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_145433_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_145433_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 14:54:39,741 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_145433_from_akba_to_admin.csv (84.0 B)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_145433_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_145433_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_145433_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_145433_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_145433_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_145433_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_145433_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_145433_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_145433_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_145433_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_145433_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_145433_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_145433_from_shahid_to_admin.csv (87.0 B)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_145433_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_145433_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_145433_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_145433_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_145433_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_145433_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_145433_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_145433_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 14:54:39,742 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 14:54:39,742 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 14:54:39,742 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 14:54:39,742 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:39,743 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 14:54:39,894 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 14:54:39,895 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 14:54:39,895 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 14:54:40,532 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 14:54:40,532 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 14:54:40,532 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 14:54:40,532 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:41,229 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 14:54:41,919 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 14:54:42,623 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 14:54:43,353 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 14:54:44,126 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 14:54:44,937 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 14:54:44,937 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 14:54:45,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 14:54:45,302 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 14:54:45,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:45,302 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 14:54:45,975 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 14:54:45,985 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 14:54:46,241 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 14:54:46,241 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 14:54:46,241 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 14:54:46,241 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 14:54:48,076 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 14:54:49,495 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 14:54:51,461 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 14:54:53,726 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 14:54:55,754 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 14:54:57,378 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 14:54:57,378 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 14:54:57,378 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 15:11:28,323 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:11:28,323 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:11:28,323 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:11:28,324 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:11:28,324 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:11:28,324 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:11:28,324 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:11:28,324 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:11:28,325 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:11:28,326 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:11:28,327 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:11:29,653 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 15:11:31,475 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:11:31,476 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:11:32,954 | ERROR    | src.app.cli.core.controller | Invalid choice! Please try again.
2025-12-22 15:11:42,146 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:11:42,147 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:11:42,148 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:11:42,149 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:11:42,150 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:11:42,150 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:11:43,733 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 15:11:43,734 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 15:11:43,734 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 15:11:43,734 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 15:11:43,734 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 15:11:44,853 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 15:11:44,853 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 15:11:44,853 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:44,853 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 15:11:44,854 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_151144/output
2025-12-22 15:11:44,855 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 15:11:44,891 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 15:11:44,891 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_151144
2025-12-22 15:11:44,891 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 15:11:44,891 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_151144.zip...
2025-12-22 15:11:45,201 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_151144.zip
2025-12-22 15:11:45,206 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 15:11:45,206 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 15:11:45,206 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 15:11:45,208 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 15:11:45,220 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 15:11:45,220 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 15:11:45,220 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 15:11:45,220 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 15:11:45,220 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:45,346 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 15:11:45,346 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_151145.csv...
2025-12-22 15:11:45,773 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 15:11:45,774 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 15:11:45,774 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 15:11:45,774 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151145.csv
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_151145.csv...
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:11:45,774 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_151145.csv...
2025-12-22 15:11:45,824 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 15:11:45,824 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 15:11:45,824 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 15:11:45,824 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:45,824 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151145.csv
2025-12-22 15:11:45,824 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_151145.csv...
2025-12-22 15:11:45,824 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 15:11:45,834 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 15:11:45
File: problemm20251220_20251222_151145.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 15:11:45,834 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 15:11:45,834 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 15:11:45,834 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:45,834 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151145.csv
2025-12-22 15:11:45,834 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_151145.csv...
--------------------------------------------------
2025-12-22 15:11:45,884 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_151145.csv
Saved to: data/output/converted/renamed
2025-12-22 15:11:45,884 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 15:11:45,884 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 15:11:45,884 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:45,884 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_151145.csv
2025-12-22 15:11:45,885 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_151145.csv by branches...
2025-12-22 15:11:45,885 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 15:11:45,885 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 15:11:45,901 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 15:11:45,909 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 15:11:45,914 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 15:11:45,919 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 15:11:45,925 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 15:11:45,930 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 15:11:45,930 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 15:11:49,179 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 15:11:51,264 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.09s (198 transfers)
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_151145_asherin.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_151145_wardani.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_151145_akba.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_151145_shahid.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_151145_nujum.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_151145_admin.csv
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=1.20 surplus=2.05 writes=0.35 total=6.34
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 15:11:52,223 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 15:11:52,223 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 15:11:52,223 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 15:11:52,223 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 15:11:52,615 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 15:11:52,615 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 15:11:52,615 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151145_from_admin_to_akba.csv (9.2 KB)
2025-12-22 15:11:52,615 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151145_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151145_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151145_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151145_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151145_from_akba_to_admin.csv (84.0 B)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151145_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151145_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151145_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151145_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151145_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151145_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151145_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151145_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151145_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151145_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151145_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151145_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151145_from_shahid_to_admin.csv (87.0 B)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151145_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151145_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151145_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151145_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151145_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151145_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151145_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151145_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 15:11:52,616 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 15:11:52,616 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:11:52,616 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:52,616 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 15:11:52,766 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 15:11:52,766 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:11:52,766 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 15:11:52,767 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:11:53,418 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 15:11:53,418 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 15:11:53,418 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 15:11:53,418 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:54,139 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 15:11:54,838 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 15:11:55,542 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 15:11:56,252 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 15:11:56,965 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 15:11:57,681 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 15:11:57,682 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 15:11:58,004 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 15:11:58,004 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 15:11:58,004 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:58,004 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 15:11:58,628 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 15:11:58,637 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 15:11:58,886 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 15:11:58,886 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 15:11:58,886 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:11:58,886 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 15:12:00,634 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 15:12:02,141 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 15:12:04,152 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 15:12:06,448 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 15:12:08,607 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 15:12:10,328 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 15:12:10,328 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 15:12:10,328 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:12:29,947 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:12:31,155 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:12:33,224 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:12:34,531 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 15:12:34,532 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 15:12:34,532 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 15:12:34,532 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 15:12:34,532 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 15:12:35,115 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 15:12:35,116 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 15:12:35,116 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:35,117 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 15:12:35,118 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_151235/output
2025-12-22 15:12:35,128 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 15:12:35,170 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 15:12:35,170 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_151235
2025-12-22 15:12:35,170 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 15:12:35,170 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_151235.zip...
2025-12-22 15:12:35,472 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_151235.zip
2025-12-22 15:12:35,477 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 15:12:35,477 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 15:12:35,477 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 15:12:35,478 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 15:12:35,490 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 15:12:35,490 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 15:12:35,490 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 15:12:35,490 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 15:12:35,490 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:35,596 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 15:12:35,596 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_151235.csv...
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 15:12:36,017 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 15:12:36,017 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 15:12:36,017 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151235.csv
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_151235.csv...
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 15:12:36,017 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 15:12:36,018 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:12:36,018 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 15:12:36,018 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:12:36,018 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_151235.csv...
2025-12-22 15:12:36,061 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 15:12:36,061 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 15:12:36,061 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 15:12:36,061 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:36,061 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151235.csv
2025-12-22 15:12:36,061 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_151235.csv...
2025-12-22 15:12:36,061 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 15:12:36,070 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 15:12:36
File: problemm20251220_20251222_151235.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 15:12:36,070 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 15:12:36,070 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 15:12:36,070 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:36,071 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151235.csv
2025-12-22 15:12:36,071 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_151235.csv...
--------------------------------------------------
2025-12-22 15:12:36,114 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_151236.csv
Saved to: data/output/converted/renamed
2025-12-22 15:12:36,114 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 15:12:36,114 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 15:12:36,114 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:36,115 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_151236.csv
2025-12-22 15:12:36,115 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_151236.csv by branches...
2025-12-22 15:12:36,115 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 15:12:36,115 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 15:12:36,129 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 15:12:36,135 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 15:12:36,141 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 15:12:36,146 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 15:12:36,152 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 15:12:36,157 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 15:12:36,157 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 15:12:39,287 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 15:12:41,368 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.08s (198 transfers)
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_151236_asherin.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_151236_wardani.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_151236_akba.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_151236_shahid.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_151236_nujum.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_151236_admin.csv
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.14 surplus=1.99 writes=0.36 total=6.25
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 15:12:42,361 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 15:12:42,361 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 15:12:42,361 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 15:12:42,361 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151236_from_admin_to_akba.csv (9.2 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151236_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151236_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151236_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151236_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151236_from_akba_to_admin.csv (84.0 B)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151236_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151236_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151236_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151236_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151236_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151236_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151236_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151236_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151236_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151236_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151236_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151236_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151236_from_shahid_to_admin.csv (87.0 B)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151236_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151236_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151236_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151236_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151236_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151236_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151236_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151236_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 15:12:42,787 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 15:12:42,787 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 15:12:42,787 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:12:42,787 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:42,788 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 15:12:42,956 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 15:12:42,957 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 15:12:42,957 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:12:43,688 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 15:12:43,688 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 15:12:43,688 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 15:12:43,688 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:44,542 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 15:12:45,375 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 15:12:46,125 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 15:12:46,917 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 15:12:47,744 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 15:12:48,481 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 15:12:48,481 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 15:12:48,811 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 15:12:48,811 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 15:12:48,811 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 15:12:48,811 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 15:12:48,811 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 15:12:48,811 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 15:12:48,811 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 15:12:48,811 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:48,812 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 15:12:49,462 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 15:12:49,471 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 15:12:49,716 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 15:12:49,717 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 15:12:49,717 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 15:12:49,717 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:12:49,717 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 15:12:51,575 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 15:12:53,115 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 15:12:55,154 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 15:12:57,457 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 15:12:59,529 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 15:13:01,271 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 15:13:01,271 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 15:13:01,271 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:17:43,324 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:17:43,325 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:17:43,325 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:17:44,515 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-22 15:17:46,424 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:17:46,424 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:17:46,424 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:17:46,424 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:17:46,424 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:17:46,425 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:17:47,668 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-22 15:17:47,668 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-22 15:17:47,668 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-22 15:17:47,668 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-22 15:17:47,668 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-22 15:17:48,211 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-22 15:17:48,211 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-22 15:17:48,211 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:48,212 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-22 15:17:48,212 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251222_151748/output
2025-12-22 15:17:48,213 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-22 15:17:48,248 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-22 15:17:48,248 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251222_151748
2025-12-22 15:17:48,248 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-22 15:17:48,248 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251222_151748.zip...
2025-12-22 15:17:48,541 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251222_151748.zip
2025-12-22 15:17:48,546 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-22 15:17:48,546 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-22 15:17:48,546 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-22 15:17:48,548 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-22 15:17:48,560 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-22 15:17:48,560 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-22 15:17:48,560 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-22 15:17:48,560 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-22 15:17:48,560 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:48,674 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-22 15:17:48,674 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251222_151748.csv...
2025-12-22 15:17:49,127 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-22 15:17:49,127 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-22 15:17:49,127 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-22 15:17:49,127 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151748.csv
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251222_151748.csv...
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-22 15:17:49,128 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:17:49,129 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-22 15:17:49,129 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-22 15:17:49,129 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251222_151748.csv...
2025-12-22 15:17:49,172 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-22 15:17:49,172 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-22 15:17:49,172 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-22 15:17:49,172 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:49,172 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151748.csv
2025-12-22 15:17:49,172 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251222_151748.csv...
2025-12-22 15:17:49,172 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-22 15:17:49,181 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-22 15:17:49
File: problemm20251220_20251222_151748.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-22 15:17:49,181 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-22 15:17:49,181 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-22 15:17:49,181 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:49,182 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251222_151748.csv
2025-12-22 15:17:49,182 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251222_151748.csv...
--------------------------------------------------
2025-12-22 15:17:49,225 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251222_151749.csv
Saved to: data/output/converted/renamed
2025-12-22 15:17:49,225 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-22 15:17:49,225 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-22 15:17:49,225 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:49,225 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251222_151749.csv
2025-12-22 15:17:49,226 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251222_151749.csv by branches...
2025-12-22 15:17:49,226 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-22 15:17:49,226 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-22 15:17:49,241 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-22 15:17:49,248 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-22 15:17:49,253 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-22 15:17:49,258 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-22 15:17:49,263 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-22 15:17:49,268 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-22 15:17:49,268 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-22 15:17:52,381 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-22 15:17:54,432 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.05s (198 transfers)
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251222_151749_asherin.csv
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251222_151749_wardani.csv
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251222_151749_akba.csv
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251222_151749_shahid.csv
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251222_151749_nujum.csv
2025-12-22 15:17:55,434 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251222_151749_admin.csv
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.13 surplus=1.99 writes=0.37 total=6.21
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-22 15:17:55,435 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-22 15:17:55,435 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-22 15:17:55,435 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-22 15:17:55,435 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151749_from_admin_to_akba.csv (9.2 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151749_from_admin_to_asherin.csv (8.5 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151749_from_admin_to_nujum.csv (14.4 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151749_from_admin_to_shahid.csv (11.0 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151749_from_admin_to_wardani.csv (7.5 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151749_from_akba_to_admin.csv (84.0 B)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151749_from_akba_to_asherin.csv (2.7 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151749_from_akba_to_nujum.csv (6.5 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151749_from_akba_to_shahid.csv (3.6 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151749_from_akba_to_wardani.csv (2.6 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151749_from_asherin_to_akba.csv (3.7 KB)
2025-12-22 15:17:55,841 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151749_from_asherin_to_nujum.csv (4.8 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151749_from_asherin_to_shahid.csv (3.8 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151749_from_asherin_to_wardani.csv (2.2 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151749_from_nujum_to_akba.csv (6.2 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151749_from_nujum_to_asherin.csv (4.6 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151749_from_nujum_to_shahid.csv (5.4 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151749_from_nujum_to_wardani.csv (3.6 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251222_151749_from_shahid_to_admin.csv (87.0 B)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151749_from_shahid_to_akba.csv (5.2 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151749_from_shahid_to_asherin.csv (4.4 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151749_from_shahid_to_nujum.csv (6.9 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251222_151749_from_shahid_to_wardani.csv (3.5 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251222_151749_from_wardani_to_akba.csv (2.8 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251222_151749_from_wardani_to_asherin.csv (2.1 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251222_151749_from_wardani_to_nujum.csv (3.0 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251222_151749_from_wardani_to_shahid.csv (2.9 KB)
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-22 15:17:55,842 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-22 15:17:55,842 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:17:55,842 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:55,842 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-22 15:17:56,000 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-22 15:17:56,001 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-22 15:17:56,001 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-22 15:17:56,697 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-22 15:17:56,698 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-22 15:17:56,698 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-22 15:17:56,698 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:17:57,424 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-22 15:17:58,145 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-22 15:17:58,865 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-22 15:17:59,612 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-22 15:18:00,329 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-22 15:18:01,030 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-22 15:18:01,030 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-22 15:18:01,357 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-22 15:18:01,357 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-22 15:18:01,357 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-22 15:18:01,357 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-22 15:18:01,357 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-22 15:18:01,358 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-22 15:18:01,358 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-22 15:18:01,358 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:18:01,358 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-22 15:18:02,024 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-22 15:18:02,032 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-22 15:18:02,254 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-22 15:18:02,254 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-22 15:18:02,254 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-22 15:18:02,254 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-22 15:18:02,255 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-22 15:18:03,952 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-22 15:18:05,429 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-22 15:18:07,392 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-22 15:18:09,586 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-22 15:18:11,649 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-22 15:18:13,288 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-22 15:18:13,288 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-22 15:18:13,288 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-22 15:40:20,629 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-22 15:40:20,630 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-22 15:40:20,633 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-22 15:40:20,633 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-22 15:40:20,633 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-22 15:40:20,634 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-22 15:40:20,634 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-22 15:40:20,634 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-22 15:40:20,634 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-22 15:40:20,634 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-22 15:40:20,635 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-22 15:40:20,636 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-22 15:40:20,637 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-22 15:40:20,637 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-22 15:40:20,637 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-22 15:40:20,637 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-22 15:40:22,694 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 08:41:38,507 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 08:41:38,508 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 08:41:42,683 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 08:41:42,684 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 08:41:42,684 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 08:41:42,684 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 08:41:42,684 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 08:41:43,813 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 08:41:43,813 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 08:41:43,813 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:43,814 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 08:41:43,814 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_084143/output
2025-12-23 08:41:43,816 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 08:41:43,852 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 08:41:43,853 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_084143
2025-12-23 08:41:43,853 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 08:41:43,853 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_084143.zip...
2025-12-23 08:41:44,170 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_084143.zip
2025-12-23 08:41:44,177 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 08:41:44,177 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 08:41:44,177 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 08:41:44,180 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 08:41:44,196 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 08:41:44,196 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 08:41:44,196 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 08:41:44,196 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 08:41:44,196 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:44,318 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 08:41:44,319 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_084144.csv...
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 08:41:44,743 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 08:41:44,743 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 08:41:44,743 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084144.csv
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_084144.csv...
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 08:41:44,743 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 08:41:44,744 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_084144.csv...
2025-12-23 08:41:44,793 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 08:41:44,793 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 08:41:44,793 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 08:41:44,793 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:44,794 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084144.csv
2025-12-23 08:41:44,794 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_084144.csv...
2025-12-23 08:41:44,794 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 08:41:44,805 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 08:41:44
File: problemm20251220_20251223_084144.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 08:41:44,805 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 08:41:44,805 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 08:41:44,805 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:44,805 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084144.csv
2025-12-23 08:41:44,805 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_084144.csv...
--------------------------------------------------
2025-12-23 08:41:44,857 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_084144.csv
Saved to: data/output/converted/renamed
2025-12-23 08:41:44,857 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 08:41:44,857 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 08:41:44,857 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:44,857 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_084144.csv
2025-12-23 08:41:44,858 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_084144.csv by branches...
2025-12-23 08:41:44,858 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 08:41:44,858 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 08:41:44,871 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 08:41:44,877 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 08:41:44,882 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 08:41:44,887 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 08:41:44,892 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 08:41:44,897 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 08:41:44,897 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 08:41:48,356 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-23 08:41:50,729 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.37s (198 transfers)
2025-12-23 08:41:51,707 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_084144_asherin.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_084144_wardani.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_084144_akba.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_084144_shahid.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_084144_nujum.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_084144_admin.csv
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.27 surplus=2.19 writes=0.36 total=6.85
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 08:41:51,708 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 08:41:51,708 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 08:41:51,708 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 08:41:51,708 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084144_from_admin_to_akba.csv (9.2 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084144_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084144_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084144_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084144_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_084144_from_akba_to_admin.csv (84.0 B)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084144_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084144_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084144_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 08:41:52,100 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084144_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084144_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084144_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084144_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084144_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084144_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084144_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084144_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084144_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_084144_from_shahid_to_admin.csv (87.0 B)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084144_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084144_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084144_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084144_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084144_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084144_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084144_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084144_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 08:41:52,101 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 08:41:52,101 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 08:41:52,101 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 08:41:52,101 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:52,102 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-23 08:41:52,252 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-23 08:41:52,253 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-23 08:41:52,253 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 08:41:52,914 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-23 08:41:52,914 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 08:41:52,914 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 08:41:52,915 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:53,660 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-23 08:41:54,388 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-23 08:41:55,102 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-23 08:41:55,814 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-23 08:41:56,523 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-23 08:41:57,240 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-23 08:41:57,241 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 08:41:57,575 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 08:41:57,575 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 08:41:57,575 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:57,575 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-23 08:41:58,205 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-23 08:41:58,213 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-23 08:41:58,495 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 08:41:58,496 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 08:41:58,496 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 08:41:58,496 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:41:58,496 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 08:42:00,375 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 08:42:01,840 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 08:42:03,744 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 08:42:05,934 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 08:42:07,985 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 08:42:09,598 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 08:42:09,598 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 08:42:09,598 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 08:43:46,039 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 08:43:46,040 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 08:43:47,527 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 08:43:48,805 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 08:43:50,087 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 08:43:50,087 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 08:43:50,087 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 08:43:50,087 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 08:43:50,087 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 08:43:51,199 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 08:43:51,199 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 08:43:51,199 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:51,200 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 08:43:51,200 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_084351/output
2025-12-23 08:43:51,201 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 08:43:51,236 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 08:43:51,236 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_084351
2025-12-23 08:43:51,236 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 08:43:51,236 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_084351.zip...
2025-12-23 08:43:51,533 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_084351.zip
2025-12-23 08:43:51,538 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 08:43:51,538 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 08:43:51,538 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 08:43:51,540 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 08:43:51,551 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 08:43:51,551 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 08:43:51,551 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 08:43:51,551 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 08:43:51,551 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:51,665 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 08:43:51,665 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_084351.csv...
2025-12-23 08:43:52,117 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 08:43:52,117 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 08:43:52,117 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 08:43:52,117 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:52,117 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084351.csv
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_084351.csv...
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 08:43:52,118 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_084351.csv...
2025-12-23 08:43:52,163 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 08:43:52,163 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 08:43:52,163 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 08:43:52,163 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:52,163 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084351.csv
2025-12-23 08:43:52,163 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_084351.csv...
2025-12-23 08:43:52,163 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 08:43:52,173 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 08:43:52
File: problemm20251220_20251223_084351.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 08:43:52,173 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 08:43:52,173 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 08:43:52,173 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:52,173 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_084351.csv
2025-12-23 08:43:52,173 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_084351.csv...
--------------------------------------------------
2025-12-23 08:43:52,221 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_084352.csv
Saved to: data/output/converted/renamed
2025-12-23 08:43:52,222 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 08:43:52,222 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 08:43:52,222 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:52,222 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_084352.csv
2025-12-23 08:43:52,222 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_084352.csv by branches...
2025-12-23 08:43:52,222 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 08:43:52,222 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 08:43:52,237 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 08:43:52,244 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 08:43:52,249 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 08:43:52,256 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 08:43:52,261 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 08:43:52,266 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 08:43:52,266 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 08:43:55,430 | INFO     | src.services.splitting.processors.surplus_redistributor | Starting second redistribution round for wasted surplus...
2025-12-23 08:43:57,448 | INFO     | src.services.splitting.processors.surplus_redistributor | Second redistribution round completed in 2.02s (198 transfers)
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_084352_asherin.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_084352_wardani.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_084352_akba.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_084352_shahid.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_084352_nujum.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_084352_admin.csv
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.14 surplus=2.02 writes=0.36 total=6.20
2025-12-23 08:43:58,422 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 08:43:58,422 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 08:43:58,422 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 08:43:58,422 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:58,423 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 08:43:58,423 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 08:43:58,423 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084352_from_admin_to_akba.csv (9.2 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084352_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084352_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084352_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084352_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_084352_from_akba_to_admin.csv (84.0 B)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084352_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084352_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084352_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084352_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084352_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084352_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 08:43:58,824 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084352_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084352_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084352_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084352_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084352_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084352_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_084352_from_shahid_to_admin.csv (87.0 B)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084352_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084352_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084352_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_084352_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_084352_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_084352_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_084352_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_084352_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 08:43:58,825 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 08:43:58,825 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 08:43:58,825 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:43:58,825 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 08:43:58,980 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-23 08:43:58,981 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-23 08:43:58,981 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-23 08:43:58,981 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-23 08:43:59,644 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-23 08:43:59,644 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 08:43:59,644 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 08:43:59,644 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 08:43:59,645 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 08:43:59,645 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 08:43:59,645 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 08:43:59,645 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-23 08:43:59,645 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 08:43:59,645 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 08:43:59,645 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:44:00,415 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-23 08:44:01,126 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-23 08:44:01,829 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-23 08:44:02,556 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-23 08:44:03,275 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-23 08:44:04,007 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-23 08:44:04,008 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-23 08:44:04,335 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-23 08:44:04,335 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-23 08:44:04,335 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-23 08:44:04,335 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 08:44:04,335 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 08:44:04,335 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 08:44:04,336 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 08:44:04,336 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:44:04,336 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-23 08:44:04,958 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-23 08:44:04,966 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-23 08:44:05,205 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 08:44:05,205 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 08:44:05,205 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 08:44:05,205 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 08:44:05,206 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 08:44:06,939 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 08:44:08,450 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 08:44:10,618 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 08:44:13,064 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 08:44:15,179 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 08:44:17,000 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 08:44:17,000 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 08:44:17,000 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:10:36,717 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:10:36,717 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:10:36,717 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:10:36,717 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:10:36,717 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:10:36,718 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:10:39,766 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:10:39,767 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:10:39,767 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:10:39,767 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:10:39,767 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:10:40,271 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:10:40,271 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:10:40,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:40,272 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:10:40,273 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_091040/output
2025-12-23 09:10:40,284 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 09:10:40,423 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 09:10:40,423 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_091040
2025-12-23 09:10:40,423 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 09:10:40,423 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_091040.zip...
2025-12-23 09:10:40,697 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_091040.zip
2025-12-23 09:10:40,701 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:10:40,701 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:10:40,701 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 09:10:40,703 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 09:10:40,713 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:10:40,713 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:10:40,713 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:10:40,713 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:10:40,713 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:40,822 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:10:40,822 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_091040.csv...
2025-12-23 09:10:41,226 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:10:41,226 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:10:41,226 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:10:41,226 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:41,226 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_091040.csv
2025-12-23 09:10:41,226 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_091040.csv...
2025-12-23 09:10:41,226 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:10:41,227 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_091040.csv...
2025-12-23 09:10:41,272 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:10:41,272 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:10:41,272 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:10:41,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:41,272 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_091040.csv
2025-12-23 09:10:41,272 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_091040.csv...
2025-12-23 09:10:41,272 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:10:41,281 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:10:41
File: problemm20251220_20251223_091040.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:10:41,282 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:10:41,282 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:10:41,282 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:41,282 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_091040.csv
2025-12-23 09:10:41,282 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_091040.csv...
--------------------------------------------------
2025-12-23 09:10:41,326 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_091041.csv
Saved to: data/output/converted/renamed
2025-12-23 09:10:41,326 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:10:41,326 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:10:41,326 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:41,326 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_091041.csv
2025-12-23 09:10:41,326 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_091041.csv by branches...
2025-12-23 09:10:41,326 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:10:41,327 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:10:41,341 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:10:41,346 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:10:41,352 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:10:41,357 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:10:41,362 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:10:41,367 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:10:41,367 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:10:44,269 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:10:46,310 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.04s (198 transfers)
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_091041_asherin.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_091041_wardani.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_091041_akba.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_091041_shahid.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_091041_nujum.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_091041_admin.csv
2025-12-23 09:10:47,271 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.03 surplus=1.87 writes=0.34 total=5.94
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:10:47,272 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:10:47,272 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:10:47,272 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:10:47,272 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_091041_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_091041_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_091041_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_091041_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_091041_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_091041_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_091041_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_091041_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_091041_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_091041_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_091041_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_091041_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_091041_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_091041_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_091041_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_091041_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_091041_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_091041_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_091041_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_091041_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_091041_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_091041_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_091041_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_091041_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_091041_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_091041_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_091041_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:10:47,654 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:10:47,654 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:10:47,654 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:10:47,654 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:47,655 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-23 09:10:47,801 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:10:47,802 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-23 09:10:47,802 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 09:10:48,453 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-23 09:10:48,453 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:10:48,453 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:10:48,453 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:49,137 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:10:49,843 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for wardani: 692 products in 6 categories
2025-12-23 09:10:50,556 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for akba: 1275 products in 6 categories
2025-12-23 09:10:51,272 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:10:51,960 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:10:52,652 | INFO     | src.app.pipeline.step_9.handler | Generated remaining surplus files for admin: 2227 products in 6 categories
2025-12-23 09:10:52,652 | INFO     | src.app.pipeline.step_9.handler | Converting remaining surplus files to Excel format...
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_9.handler | ==================================================
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus CSV files
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_9.handler | Generated 36 remaining surplus Excel files
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_9.handler | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_9.handler | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:10:52,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:10:52,970 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:10:52,970 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:52,970 | INFO     | src.app.pipeline.step_10.handler | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:10:53,574 | INFO     | src.app.pipeline.step_10.handler | Found 1396 products with shortage
2025-12-23 09:10:53,583 | INFO     | src.app.pipeline.step_10.handler | Converting to Excel format...
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler | ==================================================
Generated shortage files:
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - tablets_and_capsules: 681 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - injections: 89 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - syrups: 109 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - creams: 108 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - sachets: 35 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - other: 374 products
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_10.handler |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:10:53,821 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:10:53,821 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:10:53,821 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:10:53,821 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:10:55,539 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:10:57,015 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:10:58,902 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:11:01,064 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:11:03,036 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:11:04,626 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:11:04,626 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:11:04,626 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:16:04,145 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:16:04,145 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:16:04,149 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:16:04,150 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:16:04,151 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:16:04,152 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:16:04,152 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:16:05,387 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:23:08,654 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:23:10,252 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:23:10,253 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:23:10,253 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:23:10,253 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:23:10,253 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:23:11,109 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:23:11,109 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:23:11,109 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:11,110 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:23:11,111 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_092311/output
2025-12-23 09:23:11,122 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 09:23:11,161 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 09:23:11,161 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_092311
2025-12-23 09:23:11,161 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 09:23:11,161 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_092311.zip...
2025-12-23 09:23:11,436 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_092311.zip
2025-12-23 09:23:11,440 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:23:11,440 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:23:11,440 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 09:23:11,442 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 09:23:11,452 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:23:11,452 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:23:11,452 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:23:11,452 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:23:11,452 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:11,557 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:23:11,557 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_092311.csv...
2025-12-23 09:23:11,949 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:23:11,949 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:23:11,949 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:23:11,949 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:11,949 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_092311.csv
2025-12-23 09:23:11,949 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_092311.csv...
2025-12-23 09:23:11,949 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:23:11,950 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_092311.csv...
2025-12-23 09:23:11,994 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:23:11,994 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:23:11,994 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:23:11,994 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:11,994 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_092311.csv
2025-12-23 09:23:11,994 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_092311.csv...
2025-12-23 09:23:11,994 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:23:12,003 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:23:12
File: problemm20251220_20251223_092311.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:23:12,003 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:23:12,003 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:23:12,003 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:12,004 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_092311.csv
2025-12-23 09:23:12,004 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_092311.csv...
--------------------------------------------------
2025-12-23 09:23:12,047 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_092312.csv
Saved to: data/output/converted/renamed
2025-12-23 09:23:12,047 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:23:12,047 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:23:12,047 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:12,047 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_092312.csv
2025-12-23 09:23:12,047 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_092312.csv by branches...
2025-12-23 09:23:12,047 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:23:12,047 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:23:12,061 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:23:12,067 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:23:12,073 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:23:12,078 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:23:12,083 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:23:12,088 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:23:12,088 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:23:14,988 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:23:16,981 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 1.99s (198 transfers)
2025-12-23 09:23:17,933 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:23:17,933 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_092312_asherin.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_092312_wardani.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_092312_akba.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_092312_shahid.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_092312_nujum.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_092312_admin.csv
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.04 surplus=1.86 writes=0.34 total=5.89
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:23:17,934 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:23:17,934 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:23:17,934 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:23:17,934 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_092312_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_092312_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_092312_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_092312_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_092312_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_092312_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_092312_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_092312_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_092312_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_092312_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_092312_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_092312_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_092312_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_092312_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_092312_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_092312_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_092312_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_092312_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_092312_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_092312_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_092312_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_092312_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:23:18,314 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_092312_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_092312_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_092312_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_092312_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_092312_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:23:18,315 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:23:18,315 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:23:18,315 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:18,315 | INFO     | src.app.pipeline.step_8.handler | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:23:18,460 | INFO     | src.app.pipeline.step_8.handler | Generated 145 split files:
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler | Split files saved to: data/output/transfers/csv
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler | Converting split CSV files to Excel format...
2025-12-23 09:23:18,461 | INFO     | src.app.pipeline.step_8.handler | Found 145 split CSV files to convert
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler | Generated 145 Excel files:
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - tablets_and_capsules: 27 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - injections: 24 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - syrups: 25 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - creams: 25 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - sachets: 19 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler |   - other: 25 files
2025-12-23 09:23:19,104 | INFO     | src.app.pipeline.step_8.handler | Excel files saved to: data/output/transfers/excel
2025-12-23 09:23:19,104 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:23:19,104 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:23:19,105 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:19,772 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:23:20,463 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:23:21,135 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:23:21,795 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:23:22,470 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:23:23,144 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:23:23,144 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:23:23,477 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:23:23,477 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:23:23,477 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:23:23,477 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:23:23,477 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:23:23,478 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:23:23,478 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:23:23,478 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:23,478 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:23:24,069 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:23:24,076 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:23:24,290 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:23:24,291 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:23:24,291 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:23:24,291 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:23:24,291 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:23:25,959 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:23:27,359 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:23:29,231 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:23:31,341 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:23:33,513 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:23:35,191 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:23:35,191 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:23:35,191 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:26:51,803 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:26:51,804 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:26:51,805 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:26:51,806 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:26:53,618 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:32:16,343 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:32:16,344 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:32:17,619 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:32:17,620 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:32:17,620 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:32:17,620 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:32:17,620 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:32:18,209 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:32:18,209 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:32:18,209 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:18,213 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:32:18,214 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_093218/output
2025-12-23 09:32:18,224 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 09:32:18,268 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 09:32:18,268 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_093218
2025-12-23 09:32:18,268 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 09:32:18,268 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_093218.zip...
2025-12-23 09:32:18,549 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_093218.zip
2025-12-23 09:32:18,554 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:32:18,554 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:32:18,554 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 09:32:18,556 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 09:32:18,566 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:32:18,566 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:32:18,566 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:32:18,566 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:32:18,566 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:18,669 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:32:18,669 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_093218.csv...
2025-12-23 09:32:19,081 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:32:19,081 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:32:19,081 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:32:19,081 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:19,081 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093218.csv
2025-12-23 09:32:19,081 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_093218.csv...
2025-12-23 09:32:19,081 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:32:19,082 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_093218.csv...
2025-12-23 09:32:19,126 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:32:19,126 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:32:19,126 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:32:19,126 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:19,126 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093218.csv
2025-12-23 09:32:19,126 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_093218.csv...
2025-12-23 09:32:19,126 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:32:19,135 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:32:19
File: problemm20251220_20251223_093218.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:32:19,135 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:32:19,135 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:32:19,135 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:19,136 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093218.csv
2025-12-23 09:32:19,136 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_093218.csv...
--------------------------------------------------
2025-12-23 09:32:19,180 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_093219.csv
Saved to: data/output/converted/renamed
2025-12-23 09:32:19,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:32:19,180 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:32:19,180 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:19,180 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_093219.csv
2025-12-23 09:32:19,180 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_093219.csv by branches...
2025-12-23 09:32:19,180 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:32:19,180 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:32:19,193 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:32:19,199 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:32:19,204 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:32:19,209 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:32:19,214 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:32:19,219 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:32:19,219 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:32:22,272 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:32:24,330 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.06s (198 transfers)
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_093219_asherin.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_093219_wardani.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_093219_akba.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_093219_shahid.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_093219_nujum.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_093219_admin.csv
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.11 surplus=1.95 writes=0.36 total=6.14
2025-12-23 09:32:25,321 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:32:25,321 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:32:25,321 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:32:25,321 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:25,322 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:32:25,322 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:32:25,322 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093219_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093219_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093219_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093219_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093219_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:32:25,752 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093219_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093219_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093219_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093219_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093219_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093219_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093219_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093219_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093219_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093219_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093219_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093219_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093219_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093219_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093219_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093219_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093219_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093219_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093219_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093219_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093219_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093219_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:32:25,753 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:32:25,753 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:32:25,753 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:25,753 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:32:25,927 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:32:25,928 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:32:25,928 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:32:26,687 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:32:26,687 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:32:26,687 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:32:26,687 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:27,408 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:32:28,119 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:32:28,826 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:32:29,544 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:32:30,246 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:32:30,958 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:32:30,958 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:32:31,290 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:32:31,291 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:32:31,291 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:32:31,291 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:32:31,291 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:32:31,291 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:32:31,291 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:32:31,291 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:31,291 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:32:31,930 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:32:31,939 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:32:32,177 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:32:32,177 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:32:32,177 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:32:32,177 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:32:33,899 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:32:35,391 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:32:37,377 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:32:39,684 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:32:41,741 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:32:43,441 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:32:43,441 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:32:43,441 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:34:49,623 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:34:49,624 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:34:49,624 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:34:49,624 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:34:49,624 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:34:49,625 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:34:49,626 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:34:49,627 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:34:50,894 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:34:50,894 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:34:50,895 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:34:50,895 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:34:50,895 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:34:51,398 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:34:51,399 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:34:51,399 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:51,400 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:34:51,400 | INFO     | src.shared.utils.archiver | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_093451/output
2025-12-23 09:34:51,412 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories
2025-12-23 09:34:51,458 | INFO     | src.shared.utils.archiver | Archive created successfully!
2025-12-23 09:34:51,458 | INFO     | src.shared.utils.archiver |   - Archive location: data/archive/archive_20251223_093451
2025-12-23 09:34:51,458 | INFO     | src.shared.utils.archiver |   - Archived 833 files in 196 directories
2025-12-23 09:34:51,458 | INFO     | src.shared.utils.archiver | Creating ZIP archive: data/archive/archive_20251223_093451.zip...
2025-12-23 09:34:51,740 | INFO     | src.shared.utils.archiver | ZIP archive created successfully: data/archive/archive_20251223_093451.zip
2025-12-23 09:34:51,744 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:34:51,744 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:34:51,744 | INFO     | src.shared.utils.archiver | Clearing output directory: data/output...
2025-12-23 09:34:51,746 | INFO     | src.shared.utils.archiver |   Found 833 files in 196 directories to delete
2025-12-23 09:34:51,756 | INFO     | src.shared.utils.archiver |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:34:51,756 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:34:51,756 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:34:51,756 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:34:51,756 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:51,756 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:34:51,756 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_093451.csv...
2025-12-23 09:34:52,176 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:34:52,176 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:34:52,176 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:34:52,176 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093451.csv
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_093451.csv...
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:34:52,177 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_093451.csv...
2025-12-23 09:34:52,219 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:34:52,219 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:34:52,219 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:34:52,219 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:52,219 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093451.csv
2025-12-23 09:34:52,219 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_093451.csv...
2025-12-23 09:34:52,219 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:34:52,228 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:34:52
File: problemm20251220_20251223_093451.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:34:52,228 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:34:52,228 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:34:52,228 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:52,228 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093451.csv
2025-12-23 09:34:52,228 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_093451.csv...
--------------------------------------------------
2025-12-23 09:34:52,270 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_093452.csv
Saved to: data/output/converted/renamed
2025-12-23 09:34:52,270 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:34:52,270 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:34:52,270 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:52,270 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_093452.csv
2025-12-23 09:34:52,271 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_093452.csv by branches...
2025-12-23 09:34:52,271 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:34:52,271 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:34:52,284 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:34:52,289 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:34:52,294 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:34:52,299 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:34:52,304 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:34:52,309 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:34:52,309 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:34:55,355 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:34:57,565 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.21s (198 transfers)
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_093452_asherin.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_093452_wardani.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_093452_akba.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_093452_shahid.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_093452_nujum.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_093452_admin.csv
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.11 surplus=1.93 writes=0.36 total=6.31
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:34:58,584 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:34:58,584 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:34:58,584 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:34:58,584 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093452_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093452_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093452_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093452_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093452_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093452_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093452_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093452_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093452_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093452_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093452_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093452_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093452_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093452_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093452_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093452_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093452_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093452_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093452_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093452_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093452_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093452_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093452_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093452_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093452_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093452_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093452_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:34:58,980 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:34:58,980 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:34:58,980 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:34:58,980 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:34:58,981 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:34:59,134 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:34:59,135 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:34:59,135 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:34:59,761 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:34:59,761 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:34:59,761 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:34:59,761 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:00,478 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:35:01,210 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:35:01,948 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:35:02,684 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:35:03,391 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:35:04,105 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:35:04,105 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:35:04,425 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:35:04,425 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:35:04,425 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:04,425 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:35:05,052 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:35:05,061 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:35:05,304 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:35:05,304 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:35:05,304 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:35:05,304 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:05,305 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:35:07,033 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:35:08,518 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:35:10,502 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:35:12,830 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:35:14,854 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:35:16,485 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:35:16,485 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:35:16,485 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:35:19,329 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:35:19,329 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:35:19,330 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:35:19,330 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:35:19,330 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:35:19,330 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:35:19,330 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:35:19,331 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:35:19,332 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:35:22,160 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:35:23,958 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:35:23,958 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:35:23,958 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:35:23,958 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:35:23,959 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:35:25,152 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:35:25,153 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:35:25,153 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:35:25,153 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:35:25,153 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:35:25,515 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:35:25,515 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:35:25,516 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:25,516 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:35:25,517 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_093525/output
2025-12-23 09:35:25,519 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:35:25,555 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:35:25,555 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_093525
2025-12-23 09:35:25,555 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:35:25,555 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_093525.zip...
2025-12-23 09:35:25,834 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_093525.zip
2025-12-23 09:35:25,839 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:35:25,839 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:35:25,839 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:35:25,840 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:35:25,850 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:35:25,850 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:35:25,850 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:35:25,850 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:35:25,850 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:25,952 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:35:25,953 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_093525.csv...
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:35:26,359 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:35:26,359 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:35:26,359 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093525.csv
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_093525.csv...
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:35:26,359 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:35:26,360 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_093525.csv...
2025-12-23 09:35:26,403 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:35:26,403 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:35:26,403 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:35:26,403 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:26,403 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093525.csv
2025-12-23 09:35:26,403 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_093525.csv...
2025-12-23 09:35:26,403 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:35:26,412 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:35:26
File: problemm20251220_20251223_093525.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:35:26,412 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:35:26,412 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:35:26,412 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:26,412 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093525.csv
2025-12-23 09:35:26,412 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_093525.csv...
--------------------------------------------------
2025-12-23 09:35:26,456 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_093526.csv
Saved to: data/output/converted/renamed
2025-12-23 09:35:26,456 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:35:26,456 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:35:26,456 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:26,456 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_093526.csv
2025-12-23 09:35:26,457 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_093526.csv by branches...
2025-12-23 09:35:26,457 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:35:26,457 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:35:26,470 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:35:26,476 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:35:26,481 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:35:26,486 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:35:26,491 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:35:26,496 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:35:26,496 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:35:29,548 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:35:31,722 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.17s (198 transfers)
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_093526_asherin.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_093526_wardani.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_093526_akba.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_093526_shahid.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_093526_nujum.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_093526_admin.csv
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.09 surplus=1.97 writes=0.35 total=6.24
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:35:32,701 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:35:32,701 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:35:32,701 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:35:32,701 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093526_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093526_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093526_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093526_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093526_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093526_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093526_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093526_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093526_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093526_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093526_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093526_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:35:33,101 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093526_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093526_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093526_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093526_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093526_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093526_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093526_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093526_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093526_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093526_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093526_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093526_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093526_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093526_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093526_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:35:33,102 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:35:33,102 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:35:33,102 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:33,102 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:35:33,257 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:35:33,893 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:35:33,893 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:35:33,893 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:35:33,893 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:34,600 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:35:35,306 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:35:36,012 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:35:36,723 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:35:37,433 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:35:38,150 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:35:38,150 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:35:38,484 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:35:38,484 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:35:38,484 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:35:38,484 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:35:38,484 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:35:38,485 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:35:38,485 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:35:38,485 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:38,485 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:35:39,107 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:35:39,116 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:35:39,361 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:35:39,361 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:35:39,361 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:35:39,361 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:35:41,105 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:35:42,572 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:35:44,558 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:35:46,796 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:35:48,824 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:35:50,487 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:35:50,487 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:35:50,487 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:37:59,402 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:37:59,403 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:37:59,404 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:37:59,405 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:37:59,406 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:37:59,406 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:38:01,079 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:38:02,506 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:38:02,506 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:38:02,506 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:38:02,507 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:38:03,547 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:38:03,547 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:38:03,547 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:38:03,547 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:38:03,547 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:38:04,728 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:38:04,728 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:38:04,728 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:04,728 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:38:04,728 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_093804/output
2025-12-23 09:38:04,730 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:38:04,768 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:38:04,768 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_093804
2025-12-23 09:38:04,768 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:38:04,768 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_093804.zip...
2025-12-23 09:38:05,050 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_093804.zip
2025-12-23 09:38:05,054 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:38:05,054 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:38:05,054 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:38:05,056 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:38:05,066 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:38:05,066 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:38:05,066 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:38:05,066 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:38:05,066 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:05,177 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:38:05,177 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_093805.csv...
2025-12-23 09:38:05,596 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:38:05,596 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:38:05,596 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:38:05,596 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:05,596 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093805.csv
2025-12-23 09:38:05,596 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_093805.csv...
2025-12-23 09:38:05,596 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:38:05,597 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_093805.csv...
2025-12-23 09:38:05,655 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:38:05,655 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:38:05,655 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:38:05,655 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:05,656 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093805.csv
2025-12-23 09:38:05,656 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_093805.csv...
2025-12-23 09:38:05,656 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:38:05,670 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:38:05
File: problemm20251220_20251223_093805.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:38:05,670 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:38:05,670 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:38:05,670 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:05,671 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_093805.csv
2025-12-23 09:38:05,671 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_093805.csv...
--------------------------------------------------
2025-12-23 09:38:05,721 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_093805.csv
Saved to: data/output/converted/renamed
2025-12-23 09:38:05,721 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:38:05,721 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:38:05,721 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:05,721 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_093805.csv
2025-12-23 09:38:05,722 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_093805.csv by branches...
2025-12-23 09:38:05,722 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:38:05,722 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:38:05,735 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:38:05,741 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:38:05,748 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:38:05,754 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:38:05,759 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:38:05,764 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:38:05,764 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:38:08,843 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:38:10,934 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.09s (198 transfers)
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_093805_asherin.csv
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_093805_wardani.csv
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_093805_akba.csv
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_093805_shahid.csv
2025-12-23 09:38:11,932 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_093805_nujum.csv
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_093805_admin.csv
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.14 surplus=1.93 writes=0.36 total=6.21
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:38:11,933 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:38:11,933 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:38:11,933 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_7.handler | Generating transfer files...
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_7.handler | --------------------------------------------------
2025-12-23 09:38:11,933 | INFO     | src.app.pipeline.step_7.handler | Using latest analytics files for each target branch...
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler | Generated 27 transfer files:
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler | 
  From admin (5 files):
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093805_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093805_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093805_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093805_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093805_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler | 
  From akba (5 files):
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093805_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093805_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093805_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093805_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093805_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler | 
  From asherin (4 files):
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093805_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093805_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093805_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093805_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler | 
  From nujum (4 files):
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093805_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:38:12,336 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093805_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093805_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093805_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler | 
  From shahid (5 files):
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → admin: problemm20251220_20251223_093805_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093805_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093805_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093805_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → wardani: problemm20251220_20251223_093805_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler | 
  From wardani (4 files):
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → akba: problemm20251220_20251223_093805_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → asherin: problemm20251220_20251223_093805_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → nujum: problemm20251220_20251223_093805_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler |     → shahid: problemm20251220_20251223_093805_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_7.handler | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:38:12,337 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:38:12,337 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:38:12,337 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:12,337 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:38:12,498 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:38:12,499 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:38:12,499 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:38:13,171 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:38:13,171 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:38:13,171 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:38:13,171 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:13,878 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:38:14,578 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:38:15,284 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:38:15,987 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:38:16,709 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:38:17,409 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:38:17,409 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:38:17,732 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:38:17,732 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:38:17,732 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:17,732 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:38:18,333 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:38:18,342 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:38:18,587 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:38:18,588 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:38:18,588 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:38:18,588 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:38:18,588 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:38:20,359 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:38:21,839 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:38:23,763 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:38:26,014 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:38:28,027 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:38:29,657 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:38:29,658 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:38:29,658 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:43:03,818 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:43:03,819 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:43:03,820 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:43:03,821 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:43:03,822 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:43:05,116 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:43:06,654 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:43:06,655 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:43:07,824 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:43:07,824 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:43:07,825 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:43:07,825 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:43:07,825 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:43:08,954 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:43:08,954 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:43:08,954 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:08,955 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:43:08,956 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_094308/output
2025-12-23 09:43:08,962 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:43:09,007 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:43:09,007 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_094308
2025-12-23 09:43:09,007 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:43:09,007 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_094308.zip...
2025-12-23 09:43:09,294 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_094308.zip
2025-12-23 09:43:09,298 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:43:09,298 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.57 MB (58.9% compression)
2025-12-23 09:43:09,299 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:43:09,300 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:43:09,310 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:43:09,310 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:43:09,310 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:43:09,310 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:43:09,310 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:09,415 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:43:09,415 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_094309.csv...
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:43:09,828 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:43:09,828 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:43:09,828 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094309.csv
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_094309.csv...
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:43:09,828 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_094309.csv...
2025-12-23 09:43:09,872 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:43:09,872 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:43:09,872 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:43:09,872 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:09,872 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094309.csv
2025-12-23 09:43:09,872 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_094309.csv...
2025-12-23 09:43:09,872 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:43:09,882 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:43:09
File: problemm20251220_20251223_094309.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:43:09,882 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:43:09,882 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:43:09,882 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:09,882 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094309.csv
2025-12-23 09:43:09,882 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_094309.csv...
--------------------------------------------------
2025-12-23 09:43:09,927 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_094309.csv
Saved to: data/output/converted/renamed
2025-12-23 09:43:09,927 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:43:09,927 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:43:09,927 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:09,927 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_094309.csv
2025-12-23 09:43:09,928 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_094309.csv by branches...
2025-12-23 09:43:09,928 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:43:09,928 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:43:09,941 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:43:09,947 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:43:09,952 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:43:09,957 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:43:09,962 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:43:09,967 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:43:09,967 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:43:13,003 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:43:15,059 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.06s (198 transfers)
2025-12-23 09:43:16,057 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:43:16,057 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_094309_asherin.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_094309_wardani.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_094309_akba.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_094309_shahid.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_094309_nujum.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_094309_admin.csv
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.10 surplus=1.94 writes=0.36 total=6.13
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:43:16,058 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:43:16,058 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:43:16,058 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 09:43:16,058 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 09:43:16,461 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 09:43:16,461 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 09:43:16,461 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094309_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:43:16,461 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094309_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094309_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094309_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094309_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_094309_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094309_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094309_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094309_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094309_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094309_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094309_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094309_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094309_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094309_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094309_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094309_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094309_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_094309_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094309_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094309_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094309_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094309_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094309_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094309_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094309_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094309_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:43:16,462 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:43:16,462 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:43:16,462 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:43:16,463 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:16,463 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:43:16,615 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:43:16,615 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:43:16,615 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:43:16,616 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:43:17,283 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:43:17,283 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:43:17,283 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:43:17,283 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:18,005 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:43:18,716 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:43:19,426 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:43:20,145 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:43:20,854 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:43:21,572 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:43:21,573 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:43:21,892 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:43:21,892 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:43:21,892 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:21,892 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:43:22,531 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:43:22,540 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:43:22,781 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:43:22,781 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:43:22,781 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:43:22,781 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:43:24,537 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:43:26,027 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:43:27,966 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:43:30,195 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:43:32,204 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:43:33,831 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:43:33,831 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:43:33,832 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:46:55,778 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:46:55,778 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:46:55,779 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:46:55,779 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:46:55,779 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:46:55,779 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:46:55,779 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:46:55,780 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:46:55,781 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:46:55,782 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:46:56,488 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:46:57,943 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:46:58,896 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:46:58,897 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:46:58,897 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:46:58,897 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:46:58,897 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:46:59,511 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:46:59,512 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:46:59,512 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:46:59,513 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:46:59,514 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_094659/output
2025-12-23 09:46:59,524 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:46:59,566 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:46:59,566 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_094659
2025-12-23 09:46:59,566 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:46:59,566 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_094659.zip...
2025-12-23 09:46:59,846 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_094659.zip
2025-12-23 09:46:59,850 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:46:59,851 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:46:59,851 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:46:59,853 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:46:59,864 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:46:59,864 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:46:59,864 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:46:59,864 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:46:59,864 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:46:59,963 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:46:59,963 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_094659.csv...
2025-12-23 09:47:00,398 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:47:00,398 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:47:00,398 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:47:00,398 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:00,398 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094659.csv
2025-12-23 09:47:00,398 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_094659.csv...
2025-12-23 09:47:00,398 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:47:00,399 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_094659.csv...
2025-12-23 09:47:00,443 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:47:00,443 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:47:00,443 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:47:00,443 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:00,443 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094659.csv
2025-12-23 09:47:00,443 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_094659.csv...
2025-12-23 09:47:00,443 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:47:00,452 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:47:00
File: problemm20251220_20251223_094659.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:47:00,452 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:47:00,452 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:47:00,452 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:00,452 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_094659.csv
2025-12-23 09:47:00,452 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_094659.csv...
--------------------------------------------------
2025-12-23 09:47:00,498 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_094700.csv
Saved to: data/output/converted/renamed
2025-12-23 09:47:00,498 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:47:00,498 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:47:00,498 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:00,498 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_094700.csv
2025-12-23 09:47:00,499 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_094700.csv by branches...
2025-12-23 09:47:00,499 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:47:00,499 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:47:00,512 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:47:00,518 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:47:00,524 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:47:00,532 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:47:00,537 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:47:00,542 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:47:00,542 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:47:03,575 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:47:05,602 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.03s (198 transfers)
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_094700_asherin.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_094700_wardani.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_094700_akba.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_094700_shahid.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_094700_nujum.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_094700_admin.csv
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.10 surplus=1.94 writes=0.36 total=6.09
2025-12-23 09:47:06,592 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:47:06,592 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:47:06,592 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:47:06,592 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:06,593 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 09:47:06,593 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 09:47:06,593 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094700_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094700_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094700_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094700_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094700_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_094700_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094700_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094700_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094700_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094700_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094700_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094700_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094700_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094700_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094700_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094700_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094700_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094700_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_094700_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094700_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094700_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094700_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_094700_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_094700_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_094700_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_094700_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_094700_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:47:06,999 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:47:06,999 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:47:06,999 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:47:06,999 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:07,000 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:47:07,168 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:47:07,169 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:47:07,837 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:47:07,838 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:47:07,838 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:47:07,838 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:08,622 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:47:09,336 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:47:10,041 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:47:10,749 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:47:11,468 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:47:12,185 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:47:12,185 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:47:12,509 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:47:12,509 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:47:12,510 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:47:12,510 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:47:12,510 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:47:12,510 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:47:12,510 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:47:12,510 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:12,510 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:47:13,144 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:47:13,153 | INFO     | src.app.pipeline.step_10.shortage.writers | Converting to Excel format...
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers | ==================================================
Generated shortage files:
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - tablets_and_capsules: 681 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - injections: 89 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - syrups: 109 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - creams: 108 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - sachets: 35 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - other: 374 products
2025-12-23 09:47:13,373 | INFO     | src.app.pipeline.step_10.shortage.writers |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:47:13,373 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:47:13,373 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:47:13,373 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:47:13,374 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:47:15,093 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:47:16,565 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:47:18,537 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:47:20,746 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:47:22,885 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:47:24,519 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:47:24,519 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:47:24,519 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:55:47,287 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:55:47,288 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:55:47,289 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:55:47,290 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:55:47,291 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:55:47,811 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:55:49,639 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:55:50,758 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:55:50,758 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:55:50,759 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:55:50,759 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:55:50,759 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:55:51,213 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:55:51,213 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:55:51,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:51,213 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:55:51,213 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_095551/output
2025-12-23 09:55:51,215 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:55:51,249 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:55:51,249 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_095551
2025-12-23 09:55:51,249 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:55:51,249 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_095551.zip...
2025-12-23 09:55:51,535 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_095551.zip
2025-12-23 09:55:51,539 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:55:51,539 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 09:55:51,539 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:55:51,541 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:55:51,551 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:55:51,551 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:55:51,551 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:55:51,551 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:55:51,551 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:51,660 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:55:51,660 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_095551.csv...
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:55:52,120 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:55:52,120 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:55:52,120 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095551.csv
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_095551.csv...
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:55:52,120 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:55:52,121 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:55:52,121 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:55:52,121 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_095551.csv...
2025-12-23 09:55:52,166 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:55:52,166 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:55:52,166 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:55:52,166 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:52,166 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095551.csv
2025-12-23 09:55:52,166 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_095551.csv...
2025-12-23 09:55:52,166 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:55:52,175 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:55:52
File: problemm20251220_20251223_095551.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:55:52,175 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:55:52,175 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:55:52,175 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:52,175 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095551.csv
2025-12-23 09:55:52,175 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_095551.csv...
--------------------------------------------------
2025-12-23 09:55:52,221 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_095552.csv
Saved to: data/output/converted/renamed
2025-12-23 09:55:52,221 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:55:52,221 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:55:52,221 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:52,221 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_095552.csv
2025-12-23 09:55:52,222 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_095552.csv by branches...
2025-12-23 09:55:52,222 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:55:52,222 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:55:52,235 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:55:52,241 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:55:52,246 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:55:52,251 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:55:52,257 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:55:52,262 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:55:52,262 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:55:55,362 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:55:57,463 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.10s (198 transfers)
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_095552_asherin.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_095552_wardani.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_095552_akba.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_095552_shahid.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_095552_nujum.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_095552_admin.csv
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.12 surplus=1.98 writes=0.37 total=6.23
2025-12-23 09:55:58,454 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:55:58,454 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:55:58,455 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:55:58,455 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:58,455 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 09:55:58,455 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 09:55:58,455 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095552_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095552_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095552_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095552_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095552_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_095552_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095552_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095552_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095552_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095552_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095552_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095552_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095552_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095552_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:55:58,852 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095552_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095552_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095552_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095552_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_095552_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095552_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095552_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095552_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095552_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095552_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095552_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095552_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095552_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:55:58,853 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:55:58,853 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:55:58,853 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:55:58,853 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:55:59,008 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:55:59,009 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:55:59,009 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:55:59,656 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:55:59,656 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:55:59,656 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:55:59,656 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:55:59,657 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:55:59,657 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:55:59,657 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:55:59,657 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:55:59,657 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:55:59,657 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:55:59,657 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:56:00,412 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:56:01,124 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:56:01,843 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:56:02,559 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:56:03,272 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:56:03,978 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:56:03,978 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:56:04,302 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:56:04,302 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:56:04,302 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:56:04,302 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:56:04,944 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:56:04,953 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 09:56:05,179 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 09:56:05,179 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 09:56:05,179 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 09:56:05,179 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 09:56:05,179 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 09:56:05,180 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 09:56:05,180 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 09:56:05,180 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:56:05,180 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:56:05,180 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:56:05,180 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:56:05,180 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:56:07,004 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:56:08,670 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:56:10,699 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:56:12,949 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:56:15,030 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:56:16,686 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:56:16,686 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:56:16,686 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:56:16,686 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:58:57,100 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 09:58:58,437 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 09:58:58,438 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 09:59:01,274 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 09:59:01,274 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 09:59:01,275 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 09:59:01,275 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 09:59:01,275 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 09:59:01,752 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 09:59:01,752 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 09:59:01,752 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:01,753 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 09:59:01,754 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_095901/output
2025-12-23 09:59:01,766 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 09:59:01,811 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 09:59:01,811 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_095901
2025-12-23 09:59:01,811 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 09:59:01,811 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_095901.zip...
2025-12-23 09:59:02,092 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_095901.zip
2025-12-23 09:59:02,097 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 09:59:02,097 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.57 MB (58.9% compression)
2025-12-23 09:59:02,097 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 09:59:02,098 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 09:59:02,109 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 09:59:02,109 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 09:59:02,109 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 09:59:02,109 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 09:59:02,109 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:02,209 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 09:59:02,209 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_095902.csv...
2025-12-23 09:59:02,619 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 09:59:02,619 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 09:59:02,619 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 09:59:02,619 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:02,619 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095902.csv
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_095902.csv...
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 09:59:02,620 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_095902.csv...
2025-12-23 09:59:02,664 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 09:59:02,664 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 09:59:02,664 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 09:59:02,665 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:02,665 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095902.csv
2025-12-23 09:59:02,665 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_095902.csv...
2025-12-23 09:59:02,665 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 09:59:02,674 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 09:59:02
File: problemm20251220_20251223_095902.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 09:59:02,674 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 09:59:02,674 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 09:59:02,674 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:02,674 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_095902.csv
2025-12-23 09:59:02,674 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_095902.csv...
--------------------------------------------------
2025-12-23 09:59:02,718 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_095902.csv
Saved to: data/output/converted/renamed
2025-12-23 09:59:02,718 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 09:59:02,718 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 09:59:02,718 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:02,718 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_095902.csv
2025-12-23 09:59:02,718 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_095902.csv by branches...
2025-12-23 09:59:02,718 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 09:59:02,719 | WARNING  | src.services.splitting.processors.data_preparer | ⚠️ No date information found. Using default: 90 days
2025-12-23 09:59:02,731 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 09:59:02,737 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 09:59:02,743 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 09:59:02,748 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 09:59:02,753 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 09:59:02,758 | INFO     | src.services.splitting.processors.data_preparer | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 09:59:02,758 | INFO     | src.services.splitting.processors.data_preparer | Prepared data for 6 branches, 4685 products
2025-12-23 09:59:05,854 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 09:59:07,918 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.06s (198 transfers)
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_095902_asherin.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_095902_wardani.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_095902_akba.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_095902_shahid.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_095902_nujum.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_095902_admin.csv
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.13 surplus=1.97 writes=0.36 total=6.19
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 09:59:08,910 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 09:59:08,910 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 09:59:08,910 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 09:59:08,910 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095902_from_admin_to_akba.csv (9.2 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095902_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095902_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095902_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095902_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_095902_from_akba_to_admin.csv (84.0 B)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095902_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095902_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095902_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095902_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 09:59:09,311 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095902_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095902_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095902_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095902_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095902_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095902_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095902_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095902_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_095902_from_shahid_to_admin.csv (87.0 B)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095902_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095902_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095902_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_095902_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_095902_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_095902_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_095902_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_095902_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 09:59:09,312 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 09:59:09,312 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 09:59:09,312 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:09,312 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 09:59:09,466 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 09:59:09,467 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 09:59:09,467 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 09:59:10,115 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 09:59:10,115 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 09:59:10,115 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 09:59:10,115 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:10,828 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 09:59:11,535 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 09:59:12,244 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 09:59:12,960 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 09:59:13,675 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 09:59:14,404 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 09:59:14,405 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 09:59:14,727 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 09:59:14,727 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 09:59:14,727 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 09:59:14,727 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 09:59:14,727 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 09:59:14,728 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 09:59:14,728 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 09:59:14,728 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:14,728 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 09:59:15,409 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 09:59:15,417 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 09:59:15,641 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 09:59:15,641 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 09:59:15,641 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 09:59:15,641 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 09:59:15,642 | INFO     | src.app.pipeline.step_11.handler | Processing branch: asherin
2025-12-23 09:59:17,399 | INFO     | src.app.pipeline.step_11.handler | Processing branch: wardani
2025-12-23 09:59:18,909 | INFO     | src.app.pipeline.step_11.handler | Processing branch: akba
2025-12-23 09:59:20,914 | INFO     | src.app.pipeline.step_11.handler | Processing branch: shahid
2025-12-23 09:59:23,120 | INFO     | src.app.pipeline.step_11.handler | Processing branch: nujum
2025-12-23 09:59:25,209 | INFO     | src.app.pipeline.step_11.handler | Processing branch: admin
2025-12-23 09:59:26,970 | INFO     | src.app.pipeline.step_11.handler | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 09:59:26,970 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 09:59:26,970 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 10:05:41,682 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:05:41,682 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:05:41,682 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:05:41,682 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:05:41,683 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:05:41,684 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:05:41,685 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:05:41,685 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:05:41,685 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:05:43,007 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 10:05:44,553 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:05:44,554 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:05:45,820 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 10:05:45,820 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 10:05:45,820 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 10:05:45,820 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 10:05:45,820 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 10:05:46,415 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 10:05:46,415 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 10:05:46,415 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:46,416 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 10:05:46,416 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_100546/output
2025-12-23 10:05:46,421 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 10:05:46,466 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 10:05:46,466 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_100546
2025-12-23 10:05:46,466 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 10:05:46,466 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_100546.zip...
2025-12-23 10:05:46,770 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_100546.zip
2025-12-23 10:05:46,774 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 10:05:46,774 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 10:05:46,774 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 10:05:46,776 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 10:05:46,786 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 10:05:46,786 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 10:05:46,786 | INFO     | src.app.cli.executors.step_executor | ✓ Step 1 completed successfully
2025-12-23 10:05:46,786 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 10:05:46,786 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:46,886 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 10:05:46,886 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_100546.csv...
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 10:05:47,307 | INFO     | src.app.cli.executors.step_executor | ✓ Step 2 completed successfully
2025-12-23 10:05:47,307 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 10:05:47,307 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_100546.csv
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_3.handler | Validating problemm20251220_20251223_100546.csv...
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_3.handler | --------------------------------------------------
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_3.handler | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_3.handler |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 10:05:47,307 | INFO     | src.app.pipeline.step_3.handler |     ✓ Date range is >= 3 months
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler |     ✓ All column headers match expected order
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler | ✓ Overall validation: SUCCESSFUL
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler | ==================================================
2025-12-23 10:05:47,308 | INFO     | src.app.pipeline.step_3.handler | Removing first row (header with date range) from problemm20251220_20251223_100546.csv...
2025-12-23 10:05:47,351 | INFO     | src.app.pipeline.step_3.handler | ✓ First row removed successfully
2025-12-23 10:05:47,351 | INFO     | src.app.cli.executors.step_executor | ✓ Step 3 completed successfully
2025-12-23 10:05:47,351 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 10:05:47,351 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:47,351 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_100546.csv
2025-12-23 10:05:47,351 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_100546.csv...
2025-12-23 10:05:47,352 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 10:05:47,361 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 10:05:47
File: problemm20251220_20251223_100546.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 10:05:47,361 | INFO     | src.app.cli.executors.step_executor | ✓ Step 4 completed successfully
2025-12-23 10:05:47,361 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 10:05:47,361 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:47,361 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_100546.csv
2025-12-23 10:05:47,361 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_100546.csv...
--------------------------------------------------
2025-12-23 10:05:47,406 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_100547.csv
Saved to: data/output/converted/renamed
2025-12-23 10:05:47,406 | INFO     | src.app.cli.executors.step_executor | ✓ Step 5 completed successfully
2025-12-23 10:05:47,406 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 10:05:47,406 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:47,406 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_100547.csv
2025-12-23 10:05:47,407 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_100547.csv by branches...
2025-12-23 10:05:47,407 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 10:05:47,407 | WARNING  | src.services.splitting.processors.data_preparer.dates | ⚠️ No date information found. Using default: 90 days
2025-12-23 10:05:47,422 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 10:05:47,429 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 10:05:47,435 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 10:05:47,442 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 10:05:47,448 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 10:05:47,454 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 10:05:47,454 | INFO     | src.services.splitting.processors.data_preparer.processing | Prepared data for 6 branches, 4685 products
2025-12-23 10:05:50,578 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 10:05:52,713 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.13s (198 transfers)
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_100547_asherin.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_100547_wardani.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_100547_akba.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_100547_shahid.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_100547_nujum.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_100547_admin.csv
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.05 allocation=1.15 surplus=1.98 writes=0.37 total=6.37
2025-12-23 10:05:53,776 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 10:05:53,776 | INFO     | src.app.cli.executors.step_executor | ✓ Step 6 completed successfully
2025-12-23 10:05:53,776 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 10:05:53,777 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:53,777 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 10:05:53,777 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 10:05:53,777 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_100547_from_admin_to_akba.csv (9.2 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_100547_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_100547_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_100547_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_100547_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_100547_from_akba_to_admin.csv (84.0 B)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_100547_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_100547_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_100547_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_100547_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_100547_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_100547_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_100547_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_100547_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_100547_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 10:05:54,183 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_100547_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_100547_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_100547_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_100547_from_shahid_to_admin.csv (87.0 B)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_100547_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_100547_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_100547_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_100547_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_100547_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_100547_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_100547_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_100547_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 10:05:54,184 | INFO     | src.app.cli.executors.step_executor | ✓ Step 7 completed successfully
2025-12-23 10:05:54,184 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:05:54,184 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:54,184 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 10:05:54,338 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 10:05:54,999 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 10:05:54,999 | INFO     | src.app.cli.executors.step_executor | ✓ Step 8 completed successfully
2025-12-23 10:05:54,999 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 10:05:54,999 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:55,719 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 10:05:56,436 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 10:05:57,150 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 10:05:57,873 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 10:05:58,607 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 10:05:59,419 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 10:05:59,419 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 10:05:59,743 | INFO     | src.app.cli.executors.step_executor | ✓ Step 9 completed successfully
2025-12-23 10:05:59,743 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 10:05:59,743 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:05:59,743 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 10:06:00,383 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 10:06:00,392 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 10:06:00,617 | INFO     | src.app.cli.executors.step_executor | ✓ Step 10 completed successfully
2025-12-23 10:06:00,617 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 10:06:00,617 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:06:00,617 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: asherin
2025-12-23 10:06:02,387 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: wardani
2025-12-23 10:06:03,900 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: akba
2025-12-23 10:06:05,893 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: shahid
2025-12-23 10:06:08,309 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: nujum
2025-12-23 10:06:10,407 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: admin
2025-12-23 10:06:12,053 | INFO     | src.app.pipeline.step_11.runner.orchestrator | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 10:06:12,053 | INFO     | src.app.cli.executors.step_executor | ✓ Step 11 completed successfully
2025-12-23 10:06:12,053 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 10:20:15,185 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:20:15,186 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:20:15,186 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:20:15,186 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:20:15,186 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:20:15,186 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:20:15,187 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:20:15,188 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:20:15,189 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:20:15,189 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:20:15,189 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:20:15,189 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:20:15,189 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:20:34,068 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:23:58,562 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:24:12,147 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:24:23,754 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:24:23,755 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:24:25,790 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 10:24:25,790 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 10:24:25,790 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 10:24:25,790 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 10:24:25,790 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 10:24:26,314 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 10:24:26,314 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 10:24:26,315 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:26,316 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 10:24:26,316 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_102426/output
2025-12-23 10:24:26,327 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 10:24:26,367 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 10:24:26,367 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_102426
2025-12-23 10:24:26,367 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 10:24:26,367 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_102426.zip...
2025-12-23 10:24:26,640 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_102426.zip
2025-12-23 10:24:26,644 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 10:24:26,644 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 10:24:26,644 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 10:24:26,646 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 10:24:26,656 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 10:24:26,656 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 10:24:26,656 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 1 completed successfully
2025-12-23 10:24:26,656 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 10:24:26,656 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:26,756 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220.xlsx
2025-12-23 10:24:26,756 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_102426.csv...
2025-12-23 10:24:27,168 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 10:24:27,169 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 2 completed successfully
2025-12-23 10:24:27,169 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 10:24:27,169 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_102426.csv
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.selection | Validating problemm20251220_20251223_102426.csv...
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.selection | --------------------------------------------------
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ Date range is >= 3 months
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ All column headers match expected order
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging | ✓ Overall validation: SUCCESSFUL
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:24:27,169 | INFO     | src.app.pipeline.step_3.validator.modification | Removing first row (header with date range) from problemm20251220_20251223_102426.csv...
2025-12-23 10:24:27,213 | INFO     | src.app.pipeline.step_3.validator.modification | ✓ First row removed successfully
2025-12-23 10:24:27,213 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 3 completed successfully
2025-12-23 10:24:27,213 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 10:24:27,213 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:27,213 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_102426.csv
2025-12-23 10:24:27,213 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_102426.csv...
2025-12-23 10:24:27,213 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 10:24:27,222 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 10:24:27
File: problemm20251220_20251223_102426.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 10:24:27,222 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 4 completed successfully
2025-12-23 10:24:27,222 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 10:24:27,222 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:27,222 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_20251223_102426.csv
2025-12-23 10:24:27,223 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_102426.csv...
--------------------------------------------------
2025-12-23 10:24:27,267 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_102427.csv
Saved to: data/output/converted/renamed
2025-12-23 10:24:27,267 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 5 completed successfully
2025-12-23 10:24:27,267 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 10:24:27,267 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:27,267 | INFO     | src.app.pipeline.utils.file_selector | Using latest file: problemm20251220_renamed_20251223_102427.csv
2025-12-23 10:24:27,267 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_102427.csv by branches...
2025-12-23 10:24:27,267 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 10:24:27,267 | WARNING  | src.services.splitting.processors.data_preparer.dates | ⚠️ No date information found. Using default: 90 days
2025-12-23 10:24:27,280 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 10:24:27,286 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 10:24:27,291 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 10:24:27,296 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 10:24:27,301 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 10:24:27,306 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 10:24:27,306 | INFO     | src.services.splitting.processors.data_preparer.processing | Prepared data for 6 branches, 4685 products
2025-12-23 10:24:30,239 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 10:24:32,320 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.08s (198 transfers)
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_102427_asherin.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_102427_wardani.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_102427_akba.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_102427_shahid.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_102427_nujum.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_102427_admin.csv
2025-12-23 10:24:33,264 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=1.87 writes=0.35 total=6.00
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 10:24:33,265 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 6 completed successfully
2025-12-23 10:24:33,265 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 10:24:33,265 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 10:24:33,265 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_102427_from_admin_to_akba.csv (9.2 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_102427_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_102427_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_102427_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_102427_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_102427_from_akba_to_admin.csv (84.0 B)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_102427_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_102427_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_102427_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_102427_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_102427_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_102427_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_102427_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_102427_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_102427_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_102427_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_102427_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_102427_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_102427_from_shahid_to_admin.csv (87.0 B)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_102427_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_102427_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_102427_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_102427_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_102427_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_102427_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_102427_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_102427_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 10:24:33,655 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 10:24:33,655 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 7 completed successfully
2025-12-23 10:24:33,655 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:24:33,655 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:33,656 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 10:24:33,819 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 10:24:33,820 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 10:24:34,476 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 10:24:34,476 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 8 completed successfully
2025-12-23 10:24:34,476 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 10:24:34,476 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:35,168 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 10:24:35,866 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 10:24:36,554 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 10:24:37,245 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 10:24:37,934 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 10:24:38,710 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 10:24:38,710 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 10:24:39,118 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 9 completed successfully
2025-12-23 10:24:39,118 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 10:24:39,118 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:39,118 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 10:24:39,761 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 10:24:39,770 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 10:24:39,993 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 10:24:39,994 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 10 completed successfully
2025-12-23 10:24:39,994 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 10:24:39,994 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:24:39,994 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: asherin
2025-12-23 10:24:41,700 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: wardani
2025-12-23 10:24:43,138 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: akba
2025-12-23 10:24:45,388 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: shahid
2025-12-23 10:24:47,788 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: nujum
2025-12-23 10:24:49,821 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: admin
2025-12-23 10:24:51,502 | INFO     | src.app.pipeline.step_11.runner.orchestrator | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 10:24:51,502 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 11 completed successfully
2025-12-23 10:24:51,502 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:27:37,400 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:27:37,401 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:27:39,248 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:35:40,726 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:35:42,052 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 10:35:42,052 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 10:35:42,052 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 10:35:42,053 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 10:35:42,053 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 10:35:42,781 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 10:35:42,781 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 10:35:42,781 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:42,782 | INFO     | src.app.pipeline.step_1.handler | Archiving previous output files...
2025-12-23 10:35:42,783 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_103542/output
2025-12-23 10:35:42,794 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 10:35:42,840 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 10:35:42,840 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_103542
2025-12-23 10:35:42,840 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 10:35:42,840 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_103542.zip...
2025-12-23 10:35:43,113 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_103542.zip
2025-12-23 10:35:43,117 | INFO     | src.app.pipeline.step_1.handler | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 10:35:43,117 | INFO     | src.app.pipeline.step_1.handler | ZIP: 5.56 MB (58.9% compression)
2025-12-23 10:35:43,117 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 10:35:43,119 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 10:35:43,129 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 10:35:43,129 | INFO     | src.app.pipeline.step_1.handler | ✓ Output directory cleared successfully
2025-12-23 10:35:43,129 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 1 completed successfully
2025-12-23 10:35:43,129 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 10:35:43,129 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:43,232 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220.xlsx
2025-12-23 10:35:43,233 | INFO     | src.app.pipeline.step_2.handler | Converting problemm20251220.xlsx to problemm20251220_20251223_103543.csv...
2025-12-23 10:35:43,654 | INFO     | src.app.pipeline.step_2.handler | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 10:35:43,654 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 2 completed successfully
2025-12-23 10:35:43,654 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 10:35:43,654 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:43,654 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_103543.csv
2025-12-23 10:35:43,654 | INFO     | src.app.pipeline.step_3.validator.selection | Validating problemm20251220_20251223_103543.csv...
2025-12-23 10:35:43,654 | INFO     | src.app.pipeline.step_3.validator.selection | --------------------------------------------------
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ Date range is >= 3 months
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ All column headers match expected order
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging | ✓ Overall validation: SUCCESSFUL
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:35:43,655 | INFO     | src.app.pipeline.step_3.validator.modification | Removing first row (header with date range) from problemm20251220_20251223_103543.csv...
2025-12-23 10:35:43,698 | INFO     | src.app.pipeline.step_3.validator.modification | ✓ First row removed successfully
2025-12-23 10:35:43,698 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 3 completed successfully
2025-12-23 10:35:43,698 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 10:35:43,698 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:43,699 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_103543.csv
2025-12-23 10:35:43,699 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_103543.csv...
2025-12-23 10:35:43,699 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 10:35:43,708 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 10:35:43
File: problemm20251220_20251223_103543.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 10:35:43,708 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 4 completed successfully
2025-12-23 10:35:43,708 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 10:35:43,708 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:43,708 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_103543.csv
2025-12-23 10:35:43,708 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_103543.csv...
--------------------------------------------------
2025-12-23 10:35:43,752 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_103543.csv
Saved to: data/output/converted/renamed
2025-12-23 10:35:43,752 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 5 completed successfully
2025-12-23 10:35:43,752 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 10:35:43,752 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:43,752 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_renamed_20251223_103543.csv
2025-12-23 10:35:43,752 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_103543.csv by branches...
2025-12-23 10:35:43,752 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 10:35:43,753 | WARNING  | src.services.splitting.processors.data_preparer.dates | ⚠️ No date information found. Using default: 90 days
2025-12-23 10:35:43,766 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 10:35:43,772 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 10:35:43,777 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 10:35:43,783 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 10:35:43,788 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 10:35:43,794 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 10:35:43,794 | INFO     | src.services.splitting.processors.data_preparer.processing | Prepared data for 6 branches, 4685 products
2025-12-23 10:35:46,762 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 10:35:48,778 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.02s (198 transfers)
2025-12-23 10:35:49,755 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_103543_asherin.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_103543_wardani.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_103543_akba.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_103543_shahid.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_103543_nujum.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_103543_admin.csv
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.11 surplus=1.86 writes=0.35 total=6.00
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 10:35:49,756 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 6 completed successfully
2025-12-23 10:35:49,756 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 10:35:49,756 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_7.transfers.generators | Generating transfer files...
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_7.transfers.generators | --------------------------------------------------
2025-12-23 10:35:49,756 | INFO     | src.app.pipeline.step_7.transfers.generators | Using latest analytics files for each target branch...
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators | Generated 27 transfer files:
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From admin (5 files):
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_103543_from_admin_to_akba.csv (9.2 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_103543_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_103543_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_103543_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_103543_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From akba (5 files):
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_103543_from_akba_to_admin.csv (84.0 B)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_103543_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 10:35:50,148 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_103543_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_103543_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_103543_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From asherin (4 files):
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_103543_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_103543_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_103543_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_103543_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From nujum (4 files):
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_103543_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_103543_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_103543_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_103543_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From shahid (5 files):
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → admin: problemm20251220_20251223_103543_from_shahid_to_admin.csv (87.0 B)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_103543_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_103543_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_103543_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → wardani: problemm20251220_20251223_103543_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators | 
  From wardani (4 files):
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → akba: problemm20251220_20251223_103543_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → asherin: problemm20251220_20251223_103543_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → nujum: problemm20251220_20251223_103543_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators |     → shahid: problemm20251220_20251223_103543_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_7.transfers.generators | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 10:35:50,149 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 7 completed successfully
2025-12-23 10:35:50,149 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:35:50,149 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:50,149 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 10:35:50,303 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 10:35:50,304 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 10:35:50,304 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 10:35:50,947 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 10:35:50,947 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 8 completed successfully
2025-12-23 10:35:50,947 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 10:35:50,947 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:51,653 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 10:35:52,344 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 10:35:53,024 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 10:35:53,697 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 10:35:54,378 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 10:35:55,063 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 10:35:55,064 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 10:35:55,394 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 9 completed successfully
2025-12-23 10:35:55,394 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 10:35:55,394 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:55,394 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 10:35:56,007 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 10:35:56,016 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 10:35:56,235 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 10 completed successfully
2025-12-23 10:35:56,235 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 10:35:56,235 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:35:56,235 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: asherin
2025-12-23 10:35:57,910 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: wardani
2025-12-23 10:35:59,321 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: akba
2025-12-23 10:36:01,217 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: shahid
2025-12-23 10:36:03,335 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: nujum
2025-12-23 10:36:05,332 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: admin
2025-12-23 10:36:06,927 | INFO     | src.app.pipeline.step_11.runner.orchestrator | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 10:36:06,927 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 11 completed successfully
2025-12-23 10:36:06,927 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 10:56:25,059 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:56:25,059 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:56:25,059 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:56:25,059 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:56:25,059 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:56:25,060 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:56:25,061 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:56:25,062 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:56:25,062 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:56:25,062 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:56:25,925 | INFO     | src.app.cli.core.controller | Thank you for using the program!
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:56:27,326 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:56:27,327 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:56:28,901 | INFO     | src.app.cli.executors.batch_executor | Executing all steps...
2025-12-23 10:56:28,902 | INFO     | src.app.cli.executors.batch_executor | ==================================================
2025-12-23 10:56:28,902 | INFO     | src.app.cli.handlers.input_handler | Select file option for all steps:
2025-12-23 10:56:28,902 | INFO     | src.app.cli.handlers.input_handler |   1. Select specific file (will ask for each step)
2025-12-23 10:56:28,902 | INFO     | src.app.cli.handlers.input_handler |   2. Use latest file (applies to all steps)
2025-12-23 10:56:29,443 | INFO     | src.app.cli.executors.batch_executor | Using latest file for all steps...
2025-12-23 10:56:29,443 | INFO     | src.app.cli.executors.batch_executor | [1/11] 1 - Archive Previous Output
2025-12-23 10:56:29,444 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:29,444 | INFO     | src.app.pipeline.step_1.cleaner.orchestrator | Archiving previous output files...
2025-12-23 10:56:29,445 | INFO     | src.shared.utils.archiver.manager | Archiving complete contents of data/output...
  Source: data/output
  Destination: data/archive/archive_20251223_105629/output
2025-12-23 10:56:29,455 | INFO     | src.shared.utils.archiver.directory_ops |   Found 833 files in 196 directories
2025-12-23 10:56:29,499 | INFO     | src.shared.utils.archiver.manager | Archive created successfully!
2025-12-23 10:56:29,499 | INFO     | src.shared.utils.archiver.manager |   - Archive location: data/archive/archive_20251223_105629
2025-12-23 10:56:29,499 | INFO     | src.shared.utils.archiver.manager |   - Archived 833 files in 196 directories
2025-12-23 10:56:29,499 | INFO     | src.shared.utils.archiver.zip_ops | Creating ZIP archive: data/archive/archive_20251223_105629.zip...
2025-12-23 10:56:29,775 | INFO     | src.shared.utils.archiver.zip_ops | ZIP archive created successfully: data/archive/archive_20251223_105629.zip
2025-12-23 10:56:29,779 | INFO     | src.app.pipeline.step_1.cleaner.reporting | Archive created: 833 files, 196 dirs | Size: 13.54 MB
2025-12-23 10:56:29,779 | INFO     | src.app.pipeline.step_1.cleaner.reporting | ZIP: 5.56 MB (58.9% compression)
2025-12-23 10:56:29,779 | INFO     | src.shared.utils.archiver.cleanup | Clearing output directory: data/output...
2025-12-23 10:56:29,781 | INFO     | src.shared.utils.archiver.cleanup |   Found 833 files in 196 directories to delete
2025-12-23 10:56:29,791 | INFO     | src.shared.utils.archiver.cleanup |   ✓ Output directory cleared successfully!
  ✓ Deleted 833 files and 196 directories
2025-12-23 10:56:29,791 | INFO     | src.app.pipeline.step_1.cleaner.orchestrator | ✓ Output directory cleared successfully
2025-12-23 10:56:29,791 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 1 completed successfully
2025-12-23 10:56:29,791 | INFO     | src.app.cli.executors.batch_executor | [2/11] 2 - Convert Excel to CSV
2025-12-23 10:56:29,791 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:29,890 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220.xlsx
2025-12-23 10:56:29,890 | INFO     | src.app.pipeline.step_2.converter.core | Converting problemm20251220.xlsx to problemm20251220_20251223_105629.csv...
2025-12-23 10:56:30,298 | INFO     | src.app.pipeline.step_2.converter.core | Conversion successful! File saved to: data/output/converted/csv
2025-12-23 10:56:30,298 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 2 completed successfully
2025-12-23 10:56:30,298 | INFO     | src.app.cli.executors.batch_executor | [3/11] 3 - Validate Data
2025-12-23 10:56:30,298 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:30,298 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_105629.csv
2025-12-23 10:56:30,298 | INFO     | src.app.pipeline.step_3.validator.selection | Validating problemm20251220_20251223_105629.csv...
2025-12-23 10:56:30,298 | INFO     | src.app.pipeline.step_3.validator.selection | --------------------------------------------------
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging | [1] Date Range Validation: Date range valid: 20/09/2025 00:00 to 20/12/2025 06:22 (>= 3 months)
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging |     Start: 20/09/2025 00:00, End: 20/12/2025 06:22
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ Date range is >= 3 months
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging | [2] Column Headers Validation: ✅ Column headers validation successful: All 17 required columns present
⚠️ 1 warning(s): Optional columns detected (will be recalculated): 8 columns
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging |     ✓ All column headers match expected order
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging | ✓ Overall validation: SUCCESSFUL
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.logging | ==================================================
2025-12-23 10:56:30,299 | INFO     | src.app.pipeline.step_3.validator.modification | Removing first row (header with date range) from problemm20251220_20251223_105629.csv...
2025-12-23 10:56:30,344 | INFO     | src.app.pipeline.step_3.validator.modification | ✓ First row removed successfully
2025-12-23 10:56:30,344 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 3 completed successfully
2025-12-23 10:56:30,344 | INFO     | src.app.cli.executors.batch_executor | [4/11] 4 - Sales Analysis
2025-12-23 10:56:30,344 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:30,344 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_105629.csv
2025-12-23 10:56:30,344 | INFO     | src.app.pipeline.step_4.handler | Analyzing problemm20251220_20251223_105629.csv...
2025-12-23 10:56:30,344 | INFO     | src.app.pipeline.step_4.handler | --------------------------------------------------
2025-12-23 10:56:30,353 | INFO     | src.app.pipeline.step_4.handler | 
============================================================
SALES DATA ANALYSIS REPORT
============================================================

Generated: 2025-12-23 10:56:30
File: problemm20251220_20251223_105629.csv

------------------------------------------------------------
STATISTICS
------------------------------------------------------------
Total Rows (Data): 4,685
Total Columns: 25
Total Cells: 117,125
Filled Cells: 117,125
Empty Cells: 0
Empty Cells Percentage: 0.0%

------------------------------------------------------------
IMPROVEMENT SUGGESTIONS
------------------------------------------------------------
1. Ensure consistent data format across all columns.
2. Regular data audits to maintain data quality.

============================================================
2025-12-23 10:56:30,353 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 4 completed successfully
2025-12-23 10:56:30,353 | INFO     | src.app.cli.executors.batch_executor | [5/11] 5 - Rename Columns
2025-12-23 10:56:30,353 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:30,353 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_20251223_105629.csv
2025-12-23 10:56:30,353 | INFO     | src.app.pipeline.step_5.handler | Renaming columns in problemm20251220_20251223_105629.csv...
--------------------------------------------------
2025-12-23 10:56:30,397 | INFO     | src.app.pipeline.step_5.handler | Columns renamed successfully!
Output file: problemm20251220_renamed_20251223_105630.csv
Saved to: data/output/converted/renamed
2025-12-23 10:56:30,397 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 5 completed successfully
2025-12-23 10:56:30,397 | INFO     | src.app.cli.executors.batch_executor | [6/11] 6 - Split by Branches
2025-12-23 10:56:30,398 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:30,398 | INFO     | src.app.pipeline.utils.file_selector.finder | Using latest file: problemm20251220_renamed_20251223_105630.csv
2025-12-23 10:56:30,398 | INFO     | src.app.pipeline.step_6.handler | Splitting problemm20251220_renamed_20251223_105630.csv by branches...
2025-12-23 10:56:30,398 | INFO     | src.app.pipeline.step_6.handler | --------------------------------------------------
2025-12-23 10:56:30,398 | WARNING  | src.services.splitting.processors.data_preparer.dates | ⚠️ No date information found. Using default: 90 days
2025-12-23 10:56:30,411 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for asherin: sales / 90 days
2025-12-23 10:56:30,417 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for wardani: sales / 90 days
2025-12-23 10:56:30,422 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for akba: sales / 90 days
2025-12-23 10:56:30,427 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for shahid: sales / 90 days
2025-12-23 10:56:30,433 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for nujum: sales / 90 days
2025-12-23 10:56:30,438 | INFO     | src.services.splitting.processors.data_preparer.processing | ✅ Calculated avg_sales for admin: sales / 90 days
2025-12-23 10:56:30,438 | INFO     | src.services.splitting.processors.data_preparer.processing | Prepared data for 6 branches, 4685 products
2025-12-23 10:56:33,344 | INFO     | src.services.splitting.surplus.orchestrator | Starting second redistribution round for wasted surplus...
2025-12-23 10:56:35,353 | INFO     | src.services.splitting.surplus.orchestrator | Second redistribution round completed in 2.01s (198 transfers)
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler | File split successfully into 6 branch files:
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - asherin: problemm20251220_20251223_105630_asherin.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - wardani: problemm20251220_20251223_105630_wardani.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - akba: problemm20251220_20251223_105630_akba.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - shahid: problemm20251220_20251223_105630_shahid.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - nujum: problemm20251220_20251223_105630_nujum.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler |   - admin: problemm20251220_20251223_105630_admin.csv
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler | Branch files saved to: data/output/branches/files
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler | Analytics files saved to: data/output/branches/analytics
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler | Step 6 timing (seconds): prep=0.04 allocation=1.06 surplus=1.85 writes=0.34 total=5.90
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_6.handler | Step 6 workload: products=4685 branches=6
2025-12-23 10:56:36,295 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 6 completed successfully
2025-12-23 10:56:36,295 | INFO     | src.app.cli.executors.batch_executor | [7/11] 7 - Generate Transfer Files
2025-12-23 10:56:36,295 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_7.transfers.generators.execution | Generating transfer files...
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_7.transfers.generators.execution | --------------------------------------------------
2025-12-23 10:56:36,295 | INFO     | src.app.pipeline.step_7.transfers.generators.execution | Using latest analytics files for each target branch...
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | Generated 27 transfer files:
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From admin (5 files):
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → akba: problemm20251220_20251223_105630_from_admin_to_akba.csv (9.2 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → asherin: problemm20251220_20251223_105630_from_admin_to_asherin.csv (8.5 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → nujum: problemm20251220_20251223_105630_from_admin_to_nujum.csv (14.4 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → shahid: problemm20251220_20251223_105630_from_admin_to_shahid.csv (11.0 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → wardani: problemm20251220_20251223_105630_from_admin_to_wardani.csv (7.5 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From akba (5 files):
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → admin: problemm20251220_20251223_105630_from_akba_to_admin.csv (84.0 B)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → asherin: problemm20251220_20251223_105630_from_akba_to_asherin.csv (2.7 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → nujum: problemm20251220_20251223_105630_from_akba_to_nujum.csv (6.5 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → shahid: problemm20251220_20251223_105630_from_akba_to_shahid.csv (3.6 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → wardani: problemm20251220_20251223_105630_from_akba_to_wardani.csv (2.6 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From asherin (4 files):
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → akba: problemm20251220_20251223_105630_from_asherin_to_akba.csv (3.7 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → nujum: problemm20251220_20251223_105630_from_asherin_to_nujum.csv (4.8 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → shahid: problemm20251220_20251223_105630_from_asherin_to_shahid.csv (3.8 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → wardani: problemm20251220_20251223_105630_from_asherin_to_wardani.csv (2.2 KB)
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From nujum (4 files):
2025-12-23 10:56:36,676 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → akba: problemm20251220_20251223_105630_from_nujum_to_akba.csv (6.2 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → asherin: problemm20251220_20251223_105630_from_nujum_to_asherin.csv (4.6 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → shahid: problemm20251220_20251223_105630_from_nujum_to_shahid.csv (5.4 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → wardani: problemm20251220_20251223_105630_from_nujum_to_wardani.csv (3.6 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From shahid (5 files):
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → admin: problemm20251220_20251223_105630_from_shahid_to_admin.csv (87.0 B)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → akba: problemm20251220_20251223_105630_from_shahid_to_akba.csv (5.2 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → asherin: problemm20251220_20251223_105630_from_shahid_to_asherin.csv (4.4 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → nujum: problemm20251220_20251223_105630_from_shahid_to_nujum.csv (6.9 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → wardani: problemm20251220_20251223_105630_from_shahid_to_wardani.csv (3.5 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
  From wardani (4 files):
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → akba: problemm20251220_20251223_105630_from_wardani_to_akba.csv (2.8 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → asherin: problemm20251220_20251223_105630_from_wardani_to_asherin.csv (2.1 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → nujum: problemm20251220_20251223_105630_from_wardani_to_nujum.csv (3.0 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging |     → shahid: problemm20251220_20251223_105630_from_wardani_to_shahid.csv (2.9 KB)
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_7.transfers.generators.logging | 
Transfer files saved to: data/output/transfers/csv
2025-12-23 10:56:36,677 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 7 completed successfully
2025-12-23 10:56:36,677 | INFO     | src.app.cli.executors.batch_executor | [8/11] 8 - Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:56:36,677 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:36,677 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | Splitting transfer files by product type...
--------------------------------------------------
Found 27 transfer files to split
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Generated 145 split files:
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - tablets_and_capsules: 27 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - injections: 24 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - syrups: 25 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - creams: 25 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - sachets: 19 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors |   - other: 25 files
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.processors | Split files saved to: data/output/transfers/csv
2025-12-23 10:56:36,829 | INFO     | src.app.pipeline.step_8.transfer_splitter.orchestrator | --------------------------------------------------
Starting Excel conversion...
2025-12-23 10:56:36,830 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Converting split CSV files to Excel format...
2025-12-23 10:56:36,830 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Found 145 split CSV files to convert
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Generated 145 Excel files:
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - tablets_and_capsules: 27 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - injections: 24 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - syrups: 25 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - creams: 25 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - sachets: 19 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters |   - other: 25 files
2025-12-23 10:56:37,469 | INFO     | src.app.pipeline.step_8.transfer_splitter.converters | Excel files saved to: data/output/transfers/excel
2025-12-23 10:56:37,469 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 8 completed successfully
2025-12-23 10:56:37,469 | INFO     | src.app.cli.executors.batch_executor | [9/11] 9 - Generate Remaining Surplus Files
2025-12-23 10:56:37,469 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:38,159 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for asherin: 1051 products in 6 categories
2025-12-23 10:56:38,850 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for wardani: 692 products in 6 categories
2025-12-23 10:56:39,538 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for akba: 1275 products in 6 categories
2025-12-23 10:56:40,221 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for shahid: 1521 products in 6 categories
2025-12-23 10:56:40,905 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for nujum: 1389 products in 6 categories
2025-12-23 10:56:41,601 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated surplus files for admin: 2227 products in 6 categories
2025-12-23 10:56:41,602 | INFO     | src.app.pipeline.step_9.surplus.writers | Converting remaining surplus files to Excel format...
2025-12-23 10:56:41,913 | INFO     | src.app.pipeline.step_9.surplus.writers | ==================================================
2025-12-23 10:56:41,913 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus CSV files
2025-12-23 10:56:41,913 | INFO     | src.app.pipeline.step_9.surplus.writers | Generated 36 remaining surplus Excel files
2025-12-23 10:56:41,913 | INFO     | src.app.pipeline.step_9.surplus.writers | CSV files saved to: data/output/remaining_surplus/csv (organized by branch)
2025-12-23 10:56:41,913 | INFO     | src.app.pipeline.step_9.surplus.writers | Excel files saved to: data/output/remaining_surplus/excel (organized by branch)
2025-12-23 10:56:41,914 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 9 completed successfully
2025-12-23 10:56:41,914 | INFO     | src.app.cli.executors.batch_executor | [10/11] 10 - Generate Shortage Files
2025-12-23 10:56:41,914 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:41,914 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Calculating shortage products...
--------------------------------------------------
2025-12-23 10:56:42,535 | INFO     | src.app.pipeline.step_10.shortage.orchestrator | Found 1396 products with shortage
2025-12-23 10:56:42,544 | INFO     | src.app.pipeline.step_10.shortage.writers.excel_writer | Converting to Excel format...
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging | ==================================================
Generated shortage files:
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - tablets_and_capsules: 681 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - injections: 89 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - syrups: 109 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - creams: 108 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - sachets: 35 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - other: 374 products
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_10.shortage.writers.logging |   - all (combined): 1396 products

Total shortage quantity: 7223 units

CSV files saved to: data/output/shortage/csv
Excel files saved to: data/output/shortage/excel
2025-12-23 10:56:42,759 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 10 completed successfully
2025-12-23 10:56:42,759 | INFO     | src.app.cli.executors.batch_executor | [11/11] 11 - Generate Combined Transfer Files
2025-12-23 10:56:42,759 | INFO     | src.app.cli.executors.batch_executor | --------------------------------------------------
2025-12-23 10:56:42,759 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: asherin
2025-12-23 10:56:44,437 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: wardani
2025-12-23 10:56:45,843 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: akba
2025-12-23 10:56:47,705 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: shahid
2025-12-23 10:56:49,834 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: nujum
2025-12-23 10:56:51,874 | INFO     | src.app.pipeline.step_11.runner.processing | Processing branch: admin
2025-12-23 10:56:53,520 | INFO     | src.app.pipeline.step_11.runner.orchestrator | ==================================================
Generated 36 merged files (CSV + Excel)
Generated 172 separate files (CSV + Excel)
Merged output: data/output/combined_transfers/merged/excel
Separate output: data/output/combined_transfers/separate/excel
2025-12-23 10:56:53,520 | INFO     | src.app.cli.executors.step_executor.execution | ✓ Step 11 completed successfully
2025-12-23 10:56:53,520 | INFO     | src.app.cli.executors.batch_executor | ==================================================
Execution Summary:
  Total steps: 11
  Successful: 11
  Failed: 0
  Success rate: 100.0%
==================================================
2025-12-23 10:57:10,246 | INFO     | src.app.cli.ui.display | 
==================================================
2025-12-23 10:57:10,246 | INFO     | src.app.cli.ui.display | Project Menu - Distribution of Goods
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display | ==================================================
Available steps:
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |   1. Archive Previous Output
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |      Archive previous output files before starting new process (skips if no files exist)
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |   2. Convert Excel to CSV
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |      Convert selected Excel file from input folder to CSV
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |   3. Validate Data
2025-12-23 10:57:10,247 | INFO     | src.app.cli.ui.display |      Validate CSV data, check date range (>= 3 months) and Column Headers Validation
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |   4. Sales Analysis
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |      Generate comprehensive sales analysis report with statistics and improvement suggestions
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |   5. Rename Columns
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |      Rename CSV columns from Arabic to English
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |   6. Split by Branches
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |      Split CSV file into 6 separate files, one for each branch
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |   7. Generate Transfer Files
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |      Generate transfer CSV files for each branch to all other branches
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |   8. Split Transfer Files by Product Type & Convert to Excel
2025-12-23 10:57:10,248 | INFO     | src.app.cli.ui.display |      Split transfer files into 6 categories and convert them to Excel format
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |   9. Generate Remaining Surplus Files
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |      Generate files for products with remaining surplus after distribution (CSV and Excel)
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |   10. Generate Shortage Files
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |      Generate files for products where total needed exceeds total surplus (unfulfilled demand)
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |   11. Generate Combined Transfer Files
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display |      Combine transfers with remaining surplus (to admin) in merged/separate formats with balance coloring
2025-12-23 10:57:10,249 | INFO     | src.app.cli.ui.display | 
  12. Execute all steps
  0. Exit
==================================================
2025-12-23 10:57:10,677 | INFO     | src.app.cli.core.controller | Thank you for using the program!
